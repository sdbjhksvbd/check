"use strict";(self["webpackJsonp-desktop-app"]=self["webpackJsonp-desktop-app"]||[]).push([[6135],{VrJP:(i,t,e)=>{e.d(t,{A:()=>a});var n=e("plsW"),o=e("iBnc"),s=e("CVnK"),r=e("DHl7"),__awaiter=function(i,t,e,n){return new(e||(e=Promise))((function(o,s){function fulfilled(i){try{step(n.next(i))}catch(i){s(i)}}function rejected(i){try{step(n.throw(i))}catch(i){s(i)}}function step(i){i.done?o(i.value):function adopt(i){return i instanceof e?i:new e((function(t){t(i)}))}(i.value).then(fulfilled,rejected)}step((n=n.apply(i,t||[])).next())}))};const a=new class SubscriptionController{constructor(){this.refreshSubscriptionClicked=!1,this.refreshSubscriptionClickedStateChanged=!1,(0,s.Gn)(this,{handleSubscriptionAction:s.XI,refreshProvisioningStatus:s.XI})}getRefreshSubscriptionClicked(){return this.refreshSubscriptionClicked}setRefreshSubscriptionClicked(i){this.refreshSubscriptionClicked=i}getRefreshSubscriptionClickedStateChanged(){return this.refreshSubscriptionClickedStateChanged}setRefreshSubscriptionClickedStateChanged(i){this.refreshSubscriptionClickedStateChanged=i}handleSubscriptionAction(i,t){this.triggerKWUpsell(i||o.R.CHAT,t||o.Q.CHAT_BANNER)}refreshProvisioningStatus(){return __awaiter(this,void 0,void 0,(function*(){this.refreshSubscriptionClicked=!0,this.refreshSubscriptionClickedStateChanged=!0,yield r.A.updateProvisioningStatus(!0)}))}triggerKWUpsell(i,t){return __awaiter(this,void 0,void 0,(function*(){if(!n.providers["native-api"])return;console.log("triggerKWUpsell",t);const e=yield n.providers["native-api"]();(yield e.kwcAPI()).redirectToPurchaseOption(i,t)}))}}},iBnc:(i,t,e)=>{var n,o;e.d(t,{Q:()=>n,R:()=>o}),function(i){i.CHAT_BANNER="ChatBanner",i.AGENT_BANNER="AgentBanner",i.ADD_SOURCE_BANNER="AddSourceBanner",i.NEW_PROJECTS_MENU="NewProjectsMenu",i.CREATE_YOUR_OWN_MENU="CreateYourOwnMenu",i.CREATE_POP_UP="CreatePopUp"}(n||(n={})),function(i){i.CHAT="Chat",i.ADD_SOURCE="AddSource",i.CREATE_NEW_PROJECTS="CreateNewProjects",i.CREATE_YOUR_OWN="CreateYourOwn",i.ADVISOR="Advisor",i.CREATE_POP_UP="CreatePopUp"}(o||(o={}))},v52D:(i,t,e)=>{var n;function getKWMonetPhaseName(i){return n[i]}e.d(t,{q:()=>getKWMonetPhaseName,v:()=>n}),function(i){i[i.PHASE1=0]="PHASE1",i[i.PHASE2=1]="PHASE2",i[i.PHASE3=2]="PHASE3",i[i.PHASENone=3]="PHASENone"}(n||(n={}))},ohpP:(i,t,e)=>{var n,o;e.d(t,{s:()=>n,w:()=>o}),function(i){i.Home="home"}(n||(n={})),function(i){i.RefreshWorkspace="refreshData"}(o||(o={}))},DHl7:(i,t,e)=>{e.d(t,{A:()=>p});var n=e("y4dE"),o=e("jpy3"),s=e("yXqW");class GetKWProvisioningInfoCommand extends s.VM{constructor(i,t){super(s.Bm.GET_KW_PROVISIONING_INFO),this.typeOfRequest=i,this.acceptJson=t}}var r=e("bTOH"),a=e("sVfd"),l=e("XiVx"),u=e("v52D"),d=e("plsW"),c=e("oYND"),h=e("U5BB"),v=e("bV+/"),__awaiter=function(i,t,e,n){return new(e||(e=Promise))((function(o,s){function fulfilled(i){try{step(n.next(i))}catch(i){s(i)}}function rejected(i){try{step(n.throw(i))}catch(i){s(i)}}function step(i){i.done?o(i.value):function adopt(i){return i instanceof e?i:new e((function(t){t(i)}))}(i.value).then(fulfilled,rejected)}step((n=n.apply(i,t||[])).next())}))};const p=new class ProvisioningStatusController{constructor(){this.sessionChangeCallback=(i,t)=>__awaiter(this,void 0,void 0,(function*(){yield this.updateProvisioningStatus()})),this.provisioningStatusCallback=i=>__awaiter(this,void 0,void 0,(function*(){this.setProvisioningInfoFromNative(i.detail.params)})),this.monetizationPhasesCallback=i=>__awaiter(this,void 0,void 0,(function*(){this.setMonetPhasesFlagFromNative(i.detail.params)})),this.init().catch((i=>{console.error("Failed to initialize ProvisioningStatusController:",i)}))}init(){return __awaiter(this,void 0,void 0,(function*(){const i=yield d.providers["native-api"]();(yield i.SessionAPI()).AddSessionChangeListener(this.sessionChangeCallback.bind(this)),h.A.listenForCustomEvent(c.A.USER_PROVISIONING_STATUS_UPDATE,this.provisioningStatusCallback.bind(this)),h.A.listenForCustomEvent(c.A.KW_MONETIZATION_PHASES_UPDATE,this.monetizationPhasesCallback.bind(this))}))}updateProvisioningStatus(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return __awaiter(this,void 0,void 0,(function*(){try{l.A.setStatus(l.m.InProgress);const t="status",e=yield(0,r.WM)(t),s=new GetKWProvisioningInfoCommand(t,e),a=yield n.A.ExecuteKWCommand(s);let u;if(d.providers["native-api"]){const i=yield d.providers["native-api"]();u=yield i.kwcAPI()}if(Array.isArray(a)){const[t,e]=a;t.ERR_CODE===o.dE.NO_ERROR?l.A.setProvisioningInfo(t,i):l.A.setError("Failed to get provisioning info");const n=yield e;yield u.updateProvisioningDataToNative(n),l.A.setProvisioningInfo(n,i)}else a.ERR_CODE===o.dE.NO_ERROR?(l.A.setProvisioningInfo(a,i),yield u.updateProvisioningDataToNative(a)):l.A.setError("Failed to get provisioning info")}catch(i){(0,a.tz)(`Error updating provisioning status: ${i}`),l.A.setError("Failed to update provisioning status")}}))}shouldShowUpsell(){const i=l.A.info;if(l.A.status!==l.m.Updated||!i)return!1;const{provisioningInfo:t,subscriptionLevel:e}=i;return!("PAID"===e||!t)&&(void 0!==t.kwConsumptionQuantityAvailable&&void 0!==t.isKWConsumptionAvailable&&("FREE"===e&&0===t.kwConsumptionQuantityAvailable&&!t.isKWConsumptionAvailable))}resetProvisioningStatus(){l.A.reset()}setMonetPhasesFlagFromNative(i){if(!i||0===Object.keys(i).length)return;const t={KWMonetCreationPhaseVal:i.KWMonetCreationPhaseFlag,KWMonetConsumptionPhaseVal:i.KWMonetConsumptionPhaseFlag};l.A.setMonetizationPhases(t)}setProvisioningInfoFromNative(i){if(!i||0===Object.keys(i).length)return;const t={ERR_CODE:0,provisioningInfo:{isKWCreationAvailable:i.CreationAvailable,isKWCreationLimited:i.CreationLimited,isKWConsumptionAvailable:i.CreditsAvailable,isKWConsumptionLimited:i.CreditsLimited,kwCreationQuantityAvailable:i.CreationCredits,kwConsumptionQuantityAvailable:i.ConsumptionCredits},userInfo:{accountType:i.UserType,customerType:i.CustomerType,licenseType:i.LicenseType},subscriptionLevel:i.SubscriptionLevel,isProvisioned:"PROVISIONED"===i.Status};l.A.setProvisioningInfo(t)}isKWConsumptionAvailable(){var i,t;const e=l.A.info;return null!==(t=null===(i=null==e?void 0:e.provisioningInfo)||void 0===i?void 0:i.isKWConsumptionAvailable)&&void 0!==t&&t}isGuestUser(){var i;const t=l.A.info;return"guest"===(null===(i=null==t?void 0:t.userInfo)||void 0===i?void 0:i.accountType)}handleSignIn(){return __awaiter(this,void 0,void 0,(function*(){const i=yield d.providers["native-api"](),t=yield i.SessionAPI();yield t.signIn()}))}isSignInRequired(){return l.A.status!==l.m.NotInitialized&&l.A.status!==l.m.InProgress&&l.A.status!==l.m.Error&&(this.isGuestUser()&&!this.isKWConsumptionAvailable())}updateKWCreationMonetizationPhase(){var i;return __awaiter(this,void 0,void 0,(function*(){try{const t=yield(0,v.i8)("KWC::GetKWMonetisationCreationPhase"),e=l.A.monetPhases,n={KWMonetCreationPhaseVal:t.data,KWMonetConsumptionPhaseVal:null!==(i=null==e?void 0:e.KWMonetConsumptionPhaseVal)&&void 0!==i?i:u.v.PHASENone};l.A.setMonetizationPhases(n)}catch(i){console.error("Error updating KW Creation Monetization Phase:",i)}}))}}},XiVx:(i,t,e)=>{e.d(t,{A:()=>a,m:()=>n});var n,o=e("CVnK"),s=e("v52D"),r=e("bTOH");!function(i){i.NotInitialized="NotInitialized",i.InProgress="InProgress",i.Updated="Updated",i.Error="Error"}(n||(n={}));const a=new class ProvisioningStatusStore{constructor(){this.provisioningStatus=n.NotInitialized,this.isUnlimitedAllowed=!1,this.provisioningInfo=null,this.errorMessage=null,this.monetizationPhases=null,(0,o.Gn)(this,{provisioningInfo:o.sH,provisioningStatus:o.sH,monetizationPhases:o.sH,monetPhases:o.EW,status:o.EW,info:o.EW,error:o.EW,unlimitedAllowed:o.EW,setMonetizationPhases:o.XI,setStatus:o.XI,setProvisioningInfo:o.XI,setError:o.XI,reset:o.XI})}get monetPhases(){var i;return null!==(i=this.monetizationPhases)&&void 0!==i?i:{KWMonetCreationPhaseVal:s.v.PHASENone,KWMonetConsumptionPhaseVal:s.v.PHASENone}}setMonetizationPhases(i){this.monetizationPhases=i}get status(){return this.provisioningStatus}get unlimitedAllowed(){return this.isUnlimitedAllowed}set unlimitedAllowed(i){this.isUnlimitedAllowed=i}get info(){return this.provisioningInfo}get error(){return this.errorMessage}setStatus(i){this.provisioningStatus=i,i!==n.Error&&(this.errorMessage=null)}setProvisioningInfo(i){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=!t&&(0,r.db)(this.provisioningInfo,i);!t&&e||(this.provisioningInfo=i,this.setStatus(n.Updated))}setError(i){this.errorMessage=i,this.setStatus(n.Error)}reset(){this.provisioningStatus=n.NotInitialized,this.provisioningInfo=null,this.errorMessage=null}}}}]);