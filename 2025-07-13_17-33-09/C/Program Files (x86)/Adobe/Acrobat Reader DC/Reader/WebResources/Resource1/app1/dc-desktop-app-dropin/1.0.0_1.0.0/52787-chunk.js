(self["webpackJsonp-desktop-app"]=self["webpackJsonp-desktop-app"]||[]).push([[52787],{PIIu:(e,t,o)=>{"use strict";o.d(t,{A:()=>kwhome_ErrorView});var s=o("YWiy"),i=o("EVtp"),n=o("I/yI"),r=o("0rPo"),a=o("Ntb/"),d=o("SsyB");const l={[d.b.NETWORK]:{heading:"error.network.heading",description:"error.network.text",buttonText:"error.try_again"},[d.b.FETCHOPERATIONFAILED]:{heading:"error.fetchoperationfailed.heading",description:"error.fetchoperationfailed.text",buttonText:"error.try_again"},[d.b.APPLICATION_UPDATE_REQUIRED]:{heading:"",description:"error.applicationupdaterequired.text",buttonText:""},[d.b.NONE]:{heading:"",description:"",buttonText:""}};var c=o("tTxi"),u=o.n(c),h=o("Zm2D"),A=o("2OSL"),m=o.n(A),p=o("hTvL"),g=o.n(p),C=o("YTmI"),v=o.n(C);const kwhome_ErrorView=e=>{let{errorType:t=d.b.NETWORK,onAction:o}=e;const{heading:c,description:A,buttonText:p}=l[t],C=(e=>({[d.b.NETWORK]:s.createElement(u(),null),[d.b.FETCHOPERATIONFAILED]:s.createElement(g(),null),[d.b.APPLICATION_UPDATE_REQUIRED]:s.createElement(v(),null),[d.b.NONE]:s.createElement(s.Fragment,null)}[e]))(t);return s.createElement(n.Flex,{direction:"column",height:"100%",alignItems:"center",gap:"size-200"},s.createElement(a.Icon,{height:"size-1200",width:"size-1200",marginTop:"size-1250"},C),s.createElement(r.Text,{UNSAFE_className:m().networkHeading},c?s.createElement(h.FormattedMessage,{id:c}):null),s.createElement(r.Text,{UNSAFE_className:m().networkText},A?s.createElement(h.FormattedMessage,{id:A}):null),o&&p&&s.createElement(i.Button,{variant:"cta",onPress:o},s.createElement(r.Text,null,s.createElement(h.FormattedMessage,{id:p}))))}},AoXH:(e,t,o)=>{"use strict";o.d(t,{R2:()=>s,Ur:()=>n,lx:()=>i});const s={kEventWorkflowWorkspacesHome_Curated:"KWCollection_WorkspacesHome_Curated",kEventWorkflowWorkspacesHome:"KWCollection_WorkspacesHome_Open",kEventWorkflowWorkspacesPopupCreate:"KWCollection_WorkspacesPopup_Create"},i={kWorkspacesHomeWorkspaceOpened:"WorkspacesHome_WorkspaceOpened",kWorkspacesHome:"WorkspacesHome",kRecentCollection:"RecentCollection",kCreateBtn:"CreateBtn",kCloseBtn:"CloseBtn",kViewMoreLessBtn:"ViewMoreLessBtn",kCuratedCollectionCard:"CuratedCollectionCard"},n={kSuccess:"Success",kError:"Error",kWorkspaceSelected:"Workspace_Selected",kCreateWorkspaceBtnClicked:"CreateWorkspaceBtn_Clicked",kErrorNetworkFailure:"Error_NetworkFailure",kClicked:"Clicked",kAddBtnClicked:"AddBtnClicked",kKWSignInInvoked:"KWSignInInvoked",kKWSignInSuccess:"KWSignInSuccess"}},"F/HU":(e,t,o)=>{"use strict";var s,i;o.d(t,{A:()=>n,e:()=>i}),function(e){e.OPEN_WORKSPACE="openWorkspace",e.CREATE_COLLECTION="createCollection",e.GET_CURATED_COLLECTION="getCuratedCollection",e.INITIATE_KW_SIGN_IN="initiateKWSignIn",e.SHOW_APPLICATION_UPDATE_REQUIRED_ERROR="showApplicationUpdateRequiredError"}(s||(s={})),function(e){e.getCuratedCollection="custom:getCuratedCollection"}(i||(i={}));const n=s},"Nz+8":(e,t,o)=>{"use strict";o.d(t,{A:()=>i});var s=o("plsW"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const i=class KWHomeNativeAPI{static get Instance(){return this.instance||(this.instance=new this),this.instance}getKWHomeNativeAPI(){return __awaiter(this,void 0,void 0,(function*(){if(!this.kwHomeAPI&&s.providers["native-api"]){const e=yield s.providers["native-api"](),t=yield null==e?void 0:e.HomeAPI();this.kwHomeAPI=yield null==t?void 0:t.kwHomeAPI()}return this.kwHomeAPI}))}getKWHomeAPIObject(){return __awaiter(this,void 0,void 0,(function*(){if(!this.kwHomeApiObj){const e=yield this.getKWHomeNativeAPI();this.kwHomeApiObj=null==e?void 0:e.getKWHomeAPIObject()}return this.kwHomeApiObj}))}listenForCustomEvent(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getKWHomeNativeAPI();null==o||o.addEventCallback(e,t)}))}unListenForCustomEvent(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getKWHomeNativeAPI();null==o||o.removeEventCallback(e,t)}))}}.Instance},"479N":(e,t,o)=>{"use strict";o.d(t,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__,X$:()=>CreateCollection,fm:()=>GetCuratedCollection});var s=o("F/HU"),i=o("Nz+8"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const executeKWNativeEvent=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return __awaiter(void 0,void 0,void 0,(function*(){const o=yield i.A.getKWHomeAPIObject();let s=null;if(o)try{s=yield o.invoke(e,[t])}catch(e){console.log("Error in Native call",e)}return s}))},__WEBPACK_DEFAULT_EXPORT__=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return __awaiter(void 0,void 0,void 0,(function*(){return executeKWNativeEvent(s.A.OPEN_WORKSPACE,{projectId:e,projectName:t,isShared:o,isCurated:i,isCopied:n,subcategory:r})}))},CreateCollection=e=>__awaiter(void 0,void 0,void 0,(function*(){return executeKWNativeEvent(s.A.CREATE_COLLECTION,{touchpoint:e})})),GetCuratedCollection=()=>__awaiter(void 0,void 0,void 0,(function*(){return executeKWNativeEvent(s.A.GET_CURATED_COLLECTION)}))},NmyI:(e,t,o)=>{"use strict";o.d(t,{$E:()=>T,CR:()=>_,D4:()=>U,D7:()=>r,EZ:()=>y,FQ:()=>v,H:()=>x,H0:()=>A,H6:()=>w,In:()=>i,Ir:()=>P,LE:()=>K,Lo:()=>V,Mx:()=>n,ND:()=>S,Q0:()=>G,QF:()=>I,SC:()=>M,Su:()=>O,V3:()=>d,Vn:()=>E,WQ:()=>R,Xm:()=>F,YZ:()=>L,ZW:()=>k,_7:()=>W,a:()=>N,bO:()=>Q,c0:()=>a,ei:()=>H,kM:()=>h,lP:()=>u,n4:()=>b,nk:()=>D,o0:()=>l,oJ:()=>B,p_:()=>s,r6:()=>f,uZ:()=>m,uj:()=>C,v0:()=>p,y3:()=>g,zI:()=>c});const s="Notes",i="NotesOverflowMenu",n="NoteDeleteFailed",r="NoteDeleteSuccessful",a="NoteAddLP_PerfTime_Success",d="NoteAddLP_PerfTime_Failure",l="NoteAddQnA_PerfTime_Success",c="NoteAddQnA_PerfTime_Failure",u="KWNoteAddEmpty_PerfTime_Success",h="KWNoteAddEmpty_PerfTime_Failure",A="NoteAddDuplicate_PerfTime_Success",m="NoteAddDuplicate_PerfTime_Failure",p="NoteAddPDF_PerfTime_Success",g="NoteSaveAsPDF_Clicked",C="NoteAddPDF_PerfTime_Failure",v="DuplicateClicked",f="DeleteClicked",E="EditBtnClicked",S="ExpandBtnClicked",I="CollapseBtnClicked",y="OverflowMenuClicked",N="DeleteConsentConfirmed",R="DeleteConsentDenied",_="RenameSuccessful",k="RenameFailed",L="AddNote_QnASuccessful",O="AddNote_LPCardSuccessful",P="AddNote_PDFSuccessful",D="AddNote_EmptySuccessful",T="AddNote_DuplicateSuccessful",b="NoteUpdateSuccessful",w="AddNote_QnAFailed",U="AddNote_LPCardFailed",F="AddNote_PDFFailed",H="AddNote_EmptyFailed",M="AddNote_DuplicateFailed",B="NoteUpdateFailed",W="NoteClicked_Expand",x="Notes_Download_",K="Notes_Refreshed_",Q="UpdateNoteClicked",G="NoteChevronExpandClicked",V="NoteChevronCollapseClicked"},eOjs:(e,t,o)=>{"use strict";o.d(t,{$Q:()=>m,$o:()=>A,A_:()=>N,CH:()=>r,Cb:()=>C,Ct:()=>s,Gk:()=>E,JY:()=>O,Ko:()=>L,Kz:()=>c,O0:()=>y,P5:()=>S,QO:()=>l,Qq:()=>v,U_:()=>f,Xp:()=>i,Yt:()=>k,cu:()=>h,fP:()=>p,ft:()=>a,i5:()=>_,sC:()=>d,uB:()=>g,uy:()=>u,xj:()=>I,xu:()=>n,yl:()=>R});const s="KWLandingPage_QnA",i="KWLandingPage_QnA_Response",n="KWLandingPage_QnA_TopBarMenu",r="KWLandingPage_QnA_InlineChatMenu",a="KWLandingPage_QnA_SaveCopyPromptBar",d="KWLandingPage_QnA_AttributionMenuOpen",l="GoalClicked",c="QuestionAsked",u="QuestionBarClicked",h="ChatHistoryRestored",A="Shown",m="Clicked",p="Canceled",g="CopyChatClicked",C="ClearChatClicked",v="ClearChatDenied",f="ClearChatConfirmed",E="ShowSourcesClicked",S="HideSourcesClicked",I="SaveToNoteClicked",y="CopyClicked",N="LikeClicked",R="DislikeClicked",_="AttributionBtnClicked",k="AttributionClicked",L="GoToChatClicked",O="GoToInsightsClicked"},"6bER":(e,t,o)=>{"use strict";o.d(t,{A:()=>c});var s=o("xYLj"),i=o("2Wlf"),n=o("uy9O"),r=o("mVLN"),a=o("QLQe"),d=o("+7jM"),l=o("icFW");const c=class AssetListController{constructor(){this.init()}init(){}sendAddAssetUpdate(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const[s,r,a,l,c,u,h]=t,A={[n.t.kAssetID]:s};void 0!==r&&(A[n.t.kNameKey]=r),void 0!==a&&(A[n.t.kStatusKey]=a),void 0!==u&&(A[n.t.kOpenStatusKey]=u),void 0!==l&&(A[n.t.kTypeKey]=l),void 0!==c&&(A[n.t.kSharedKey]=c),void 0!==h&&(A[n.t.kLinksJsonStringKey]=h),d.A.addUpdates(i.Ay.sessionID,n.t.kUpdated,A)}getErrorMessageIdForIngestionService(e){switch(e){case s.O4.PROTECTED_PDF.code:return"error.file_disqualified.encrypted_doc_multidoc";case s.O4.BAD_PDF.code:case s.O4.BAD_PDF_FILE_TYPE.code:case s.O4.BAD_PDF_DAMAGED.code:case s.O4.BAD_PDF_COMPLEX_TABLE.code:case s.O4.BAD_PDF_COMPLEX_INPUT.code:case s.O4.BAD_PDF_UNSUPPORTED_FONT.code:case s.O4.BAD_PDF_LARGE_FILE.code:case s.O4.DISQUALIFIED_COMPLEX_FILE.code:return"error.file_disqualified.generic_multidoc";case s.O4.DISQUALIFIED_XFA.code:return"error.pdf.disqualified_xfa_form";case s.O4.DISQUALIFIED_ACRO.code:return"error.pdf.disqualified_acro_form";case s.O4.DISQUALIFIED_INADEQUATE_CONTENT.code:return"error.insufficient_content_multidoc";case s.O4.DISQUALIFIED_PAGE_LIMIT.code:return"error.file_disqualified.page_limit_exceeded_multidoc";case s.O4.DISQUALIFIED_LANGUAGE.code:return"error.pdf.disqualified_language";case s.O4.DISQUALIFIED_SCAN_PAGE_LIMIT.code:return"error.file_disqualified.scanned_doc_multidoc";case s.O4.LLM_MODERATED.code:return"error.content_moderation_multidoc";case s.O4.UNSUPPORTED_GEO.code:return"error.geo_location";case s.O4.FEATURE_UNAVAILABLE.code:return"error.feature_unavailable";case s.O4.SESSION_NOT_FOUND.code:case s.O4.TIMEOUT.code:case s.O4.ERROR.code:case s.O4.S3_UPLOAD_FAILURE.code:case s.O4.BAD_INPUT.code:case s.O4.BAD_INPUT_PARAMS.code:default:return"error.services_failure_multidoc"}}getErrorMessageId(e){var t;switch(e.errorStatus){case r.by.kBlockUploadFilePathUnavailable:case r.by.kBlockUploadDiscoveryUnavailable:case r.by.kBlockUploadError:case r.by.kSamFilePathUnavailable:case r.by.kKWImportError:case r.by.kKWSAMFileUploadError:return(0,a.mB)(l.CY,l.ky),"lhp.sources.error.uploadfailed";case r.by.kLargeFileSizeError:return"error.file_disqualified.size_limit_exceeded_multidoc";case r.by.kKWSamFileDownloadError:return(0,a.mB)(l.CY,l.Nf),"lhp.sources.error.downloadfailed";case r.by.kKWDeleteError:return(0,a.mB)(l.CY,l.sr),"lhp.sources.error.deletefailed";case r.by.kIngestionFailed:return(0,a.mB)(l.CY,l.tO),this.getErrorMessageIdForIngestionService(null!==(t=e.ingestionStatus.errorCode)&&void 0!==t?t:"UNKNOWN_ERROR");case r.by.kDesktopWebURLConversionError:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.desktopweburlconversionerror";case r.by.kKWImportErrorGeneric:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorGeneric";case r.by.kKWImportErrorUnauthorized:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorUnauthorized";case r.by.kKWImportErrorForbidden:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorForbidden";case r.by.kKWImportErrorObjNotFound:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorObjNotFound";case r.by.kKWImportErrorNotAcceptable:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorNotAcceptable";case r.by.kKWImportErrorUnsupportedMediaType:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorUnsupportedMediaType";case r.by.kKWImportErrorMaxFileSize:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorMaxFileSize";case r.by.kKWImportErrorTooManyRequests:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorTooManyRequests";case r.by.kKWImportErrorInternalServerErr:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorInternalServerErr";case r.by.kKWImportErrorServiceUnavailable:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorServiceUnavailable";case r.by.kKWImportErrorSourceIsEncrypted:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorSourceIsEncrypted";case r.by.kKWImportErrorTimeOut:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorTimeOut";case r.by.kKWImportErrorQuotaExceeded:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorQuotaExceeded";case r.by.kKWImportErrorSourceIsEmpty:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorSourceIsEmpty";case r.by.kKWImportErrorSourceTooLarge:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorSourceTooLarge";case r.by.kKWImportErrorUnsupportedMimeType:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorUnsupportedMimeType";case r.by.kKWImportErrorDocumentCorrupted:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorDocumentCorrupted";case r.by.kKWImportErrorGone:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWImportErrorGone";case r.by.kKWODBusinessSharedLinksNotSupported:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWODBusinessSharedLinksNotSupported";case r.by.kKWODPersonalLegacyTokenDeprecated:return(0,a.mB)(l.CY,l.Ol),"lhp.sources.error.kKWODPersonalLegacyTokenDeprecated";default:return(0,a.mB)(l.CY,l.ky),"lhp.sources.error.default"}}}},mk2T:(e,t,o)=>{"use strict";o.d(t,{ji:()=>createLongNoteInServer,Iy:()=>deleteNote,e5:()=>downloadContent,VE:()=>downloadNoteAsPdf,we:()=>getNotesConfig,OS:()=>refreshNote,Fx:()=>renameNote,EW:()=>shareNoteAsPdf,FO:()=>updateNoteContent,d$:()=>updateNoteMetadataStatus,qz:()=>updateNoteStatus});var s=o("plsW"),i=o("NmyI"),n=o("2Wlf"),r=o("bV+/"),a=o("XRhC"),d=o("uy9O"),l=o("mVLN"),c=o("KAmO"),u=o("QLQe"),h=o("y4dE"),A=o("yXqW");class DeleteNoteCommand extends A.VM{constructor(e,t){super(A.Bm.DELETE_NOTE),this.parameters={kwId:e,noteId:t}}}class GetNoteConfigCommand extends A.VM{constructor(){super(A.Bm.GET_NOTE_CONFIG)}}class UpdateNoteCommand extends A.VM{constructor(e,t,o,s){super(A.Bm.UPDATE_NOTE),this.parameters={kwId:e,noteId:t},this.content=o,this.eTag=s}}class UpdateNoteMetadataCommand extends A.VM{constructor(e,t,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"auto_rename";super(A.Bm.UPDATE_NOTE_METADATA),this.kwId=e,this.noteId=t,this.parameters={name:o,on_dup_name:s}}}var m=o("jpy3"),p=o("+7jM"),g=o("oFBY"),C=o("vJCg"),v=o("rjgr"),f=o("GTxN"),E=o("vRtn"),S=o("0VNB"),I=o("ltzk"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const updateNoteStatus=(e,t)=>{t!==e.status&&(n.c.updateNoteStatus(e,t),p.A.addUpdates(n.Ay.sessionID,d.t.kUpdated,{[d.t.kAssetID]:e.id,[d.t.kStatusKey]:t}))},updateNoteMetadataStatus=(e,t,o)=>{e.isCreatedInServer&&(e.metadataIsModified=t,o!==e.metadataStatus&&(e.metadataStatus=o,p.A.addUpdates(n.Ay.sessionID,d.t.kUpdated,{[d.t.kAssetID]:e.id,[d.t.kAssetMetadataStatusKey]:o})))},updateNoteContent=e=>__awaiter(void 0,void 0,void 0,(function*(){if(!e.isCreatedInServer||!e.isModified||e.status===l.fd.kUploading)return;e.isModified=!1,updateNoteStatus(e,l.fd.kUploading);const t=JSON.stringify(e.content);if(!n.Ay.workspaceUpdateLongNote&&n.c.noteConfigs.directUploadSizeLimit>t.length){const o=new UpdateNoteCommand(n.Ay.sessionID,e.id,t,e.eTag);try{e.showAttributions=!1,n.c.updateContentSource(e,"");const t=yield h.A.ExecuteKWCommand(o);t.ERR_CODE===m.dE.NO_ERROR?(n.c.updateNoteFromSaveNoteResponse(e.id,t),e.lastSavedTime=Date.now(),(0,v.HY)(C.A.kCollectionUpdated),(0,u.mB)(i.n4,e.id),(0,c.HS)(c.$b.INFO,"Success updating note, Success: ",t.responseCode)):((0,c.zq)(a.D4.UPDATE_ERROR,e.id),(0,u.mB)(i.oJ,e.id),(0,c.HS)(c.$b.ERROR,"Error updating note, ",t),e.isModified=!0)}catch(t){(0,c.HS)(c.$b.ERROR,"Exception updating note, ",JSON.stringify(t)),e.isModified=!0}finally{updateNoteStatus(e,l.fd.kUploaded)}}else((e,t)=>{__awaiter(void 0,void 0,void 0,(function*(){if(!s.providers["native-api"])return;const o=yield s.providers["native-api"](),i=yield o.largeDataAPI(),r={kwcId:n.Ay.sessionID,noteId:e.id,eTag:e.eTag,noteName:e.name,accessLevel:e.accessLevel};i.sendDataToNative(t,"KWC::UpdateLongNote",JSON.stringify(r))}))})(e,t)})),renameNote=(e,t,o)=>__awaiter(void 0,void 0,void 0,(function*(){const s=new UpdateNoteMetadataCommand(n.Ay.sessionID,e.id,t);(0,c.HS)(c.$b.INFO,"renameNote ",e.id,t),e.metadataIsModified=!1,e.metadataStatus=l.qu.kUpdating,p.A.addUpdates(n.Ay.sessionID,d.t.kUpdated,{[d.t.kAssetID]:e.id,[d.t.kAssetMetadataStatusKey]:l.qu.kUpdating});try{const r=yield h.A.ExecuteKWCommand(s);r.ERR_CODE===m.dE.NO_ERROR?(n.c.updateNoteTitle(e.id,t),(0,u.mB)(i.p_,i.CR),(0,v.HY)(C.A.kCollectionUpdated),(0,c.HS)(c.$b.INFO,"Success renaming note, Success: ",r.responseCode)):(e.metadataIsModified=!0,(0,u.mB)(i.p_,i.ZW),(0,c.zq)(a.D4.UPDATE_ERROR,e.id),(0,c.HS)(c.$b.ERROR,"Error renaming note, Error: ",r.responseCode)),o&&o(e.name)}catch(t){e.metadataIsModified=!0,(0,c.HS)(c.$b.ERROR,"Error renaming note, Error: ",t)}finally{e.metadataStatus=l.qu.kUpdated,p.A.addUpdates(n.Ay.sessionID,d.t.kUpdated,{[d.t.kAssetID]:e.id,[d.t.kNameKey]:t,[d.t.kAssetMetadataStatusKey]:l.qu.kUpdated})}})),deleteNote=e=>__awaiter(void 0,void 0,void 0,(function*(){const t=yield(0,r.$W)(n.Ay.sessionID,e.id);if((0,u.mB)(i.p_,t.data?i.a:i.WQ),t.data){const t=n.c.getNoteIndex(e.id);n.c.deleteNote(e.id),(0,r.ab)(!1),0===n.c.notesCount&&g.A.getLhpViewState()===l.vU.EXPANDED&&g.A.setLhpViewState(l.vU.NORMAL);const o=new DeleteNoteCommand(n.Ay.sessionID,e.id);try{const s=yield h.A.ExecuteKWCommand(o);if(s.ERR_CODE===m.dE.NO_ERROR)return(0,c.zq)(a.D4.DELETE_SUCCESS,e.id,e.name),p.A.addUpdates(n.Ay.sessionID,d.t.kRemoved,{[d.t.kAssetID]:e.id}),(0,u.mB)(i.D7,e.id),(0,v.HY)(C.A.kCollectionUpdated),!0;n.c.restoreNote(e,t),(0,u.mB)(i.Mx,e.id),(0,c.zq)(a.D4.DELETE_ERROR,e.id),(0,c.HS)(c.$b.ERROR,"Error deleting note, Response Code: ",s.responseCode)}catch(o){n.c.restoreNote(e,t),(0,c.HS)(c.$b.ERROR,"Error deleting note, Error: ",JSON.stringify(o))}return!1}return!1})),createLongNoteInServer=e=>__awaiter(void 0,void 0,void 0,(function*(){const t=JSON.stringify(e.content);n.c.updateNoteStatus(e,l.fd.kUploading),__awaiter(void 0,void 0,void 0,(function*(){if(!s.providers["native-api"])return;const o=yield s.providers["native-api"](),i=yield o.largeDataAPI(),r={kwcId:n.Ay.sessionID,noteId:e.id,noteName:e.name,accessLevel:e.accessLevel,content_source:(0,c.nR)(e.creationMethod)};i.sendDataToNative(t,"KWC::CreateLongNote",JSON.stringify(r))}))})),downloadContent=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return __awaiter(void 0,void 0,void 0,(function*(){const o=n.c.getNoteFromId(e);if(!o)return(0,c.HS)(c.$b.ERROR,"[Recipient] Note not found for id:",e),!1;const s=yield f.A.downloadNote(o);return s.ERR_CODE===m.dE.NO_ERROR?(n.c.updateNoteFromDownloadNoteResponse(o,s),p.A.addUpdates(n.Ay.sessionID,d.t.kUpdated,{[d.t.kAssetID]:o.id,[d.t.kStatusKey]:l.fd.kDownloaded}),t&&n.c.setSelectedNoteId(o.id),!0):((0,c.HS)(c.$b.ERROR,"[Recipient] Error downloading note for note id:",o.id,s.responseCode),!1)}))},refreshNote=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return __awaiter(void 0,void 0,void 0,(function*(){var o,s;const i=n.c.getNoteFromId(e);if(!i)return(0,c.HS)(c.$b.ERROR,"[Recipient] Note not found for id:",e),!1;const r=new E.A(n.Ay.sessionID,i.id),a=yield h.A.ExecuteKWCommand(r);if(a.ERR_CODE===m.dE.NO_ERROR){if(i.created=a.created,i.name=a.name,i.accessLevel=a.access_level,i.createdBy=a.created_by,i.size=a.size,i.updateLinks(a.acpc_links),i.modified=a.modified,i.eTag!==a.etag){yield downloadContent(i.id);try{null===(s=null===(o=i.jotEditorRef)||void 0===o?void 0:o.current)||void 0===s||s.replaceNoteContents(i.content.contents)}catch(e){(0,c.HS)(c.$b.ERROR,"Error replacing note contents using jot editor ref",e),i.renderId=(0,S.v4)()}}return t&&n.c.setSelectedNoteId(i.id),!0}return(0,c.HS)(c.$b.ERROR,"[Recipient] Error updating metadata note for note id:",i.id,a.responseCode),!1}))},getNotesConfig=()=>__awaiter(void 0,void 0,void 0,(function*(){const e=new GetNoteConfigCommand,t=yield h.A.ExecuteKWCommand(e);return(0,c.HS)(c.$b.INFO,"Getting notes config",t),t.ERR_CODE===m.dE.NO_ERROR&&(t.auto_save_frequency>n.c.noteConfigs.autoSaveFrequency&&(n.c.noteConfigs.autoSaveFrequency=t.auto_save_frequency),n.c.noteConfigs.directDownloadLimit=t.direct_download_size_limit,n.c.noteConfigs.directUploadSizeLimit=t.direct_upload_size_limit,(0,c.HS)(c.$b.INFO,t),!0)})),shareNoteAsPdf=e=>__awaiter(void 0,void 0,void 0,(function*(){if(e)try{yield(0,r.SH)(n.Ay.sessionID,e.id,e.name,!0)}catch(e){(0,c.HS)(c.$b.ERROR,"Error in sharing note, Error: ",e)}}));function downloadNoteAsPdf(e){var t,o;return __awaiter(this,void 0,void 0,(function*(){I.A.showDownloadPdfProgressBar=!0;try{const i=null===(o=null===(t=null==e?void 0:e.jotEditorRef)||void 0===t?void 0:t.current)||void 0===o?void 0:o.getCompleteHtml({customizeEditorElement:e=>{!function hideCiteElements(e){e.querySelectorAll("*").forEach((e=>{"CITE"===e.tagName&&(e.style.display="none")}))}(e)}});if(!i)return void(I.A.showDownloadPdfProgressBar=!1);const r=yield s.providers["native-api"](),a=yield r.largeDataAPI(),d={kwcId:n.Ay.sessionID,noteId:e.id,noteName:e.name};a.sendDataToNative(i,"KWC::UploadNoteAsHTML",JSON.stringify(d))}catch(e){console.error("Error downloading note as PDF:",e)}}))}},stSR:(e,t,o)=>{"use strict";o.d(t,{A:()=>H});var s=o("6d15"),i=o("2Wlf"),n=o("y4dE"),r=o("yXqW");class CreateNoteCommand extends r.VM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{name:t,on_dup_name:o="auto_rename",access_level:s="shared",content_source:i=""}=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super(r.Bm.CREATE_NOTE),this.id=e,this.parameters={name:t,on_dup_name:o,access_level:s,content_source:i},this.file=n}}var a=o("jpy3"),d=o("oFBY"),l=o("mVLN"),c=o("YWiy"),u=o("ltzk"),h=o("GTxN"),A=o("KAmO"),m=o("bV+/"),p=o("XRhC"),g=o("yRtr"),C=o("+7jM"),v=o("uy9O"),f=o("6bER"),E=o("U5BB"),S=o("oYND"),I=o("mk2T"),y=o("QLQe"),N=o("NmyI"),R=o("plsW"),_=o("CVnK"),k=o("rjgr"),L=o("vJCg"),O=o("JvqQ"),P=o("h9J0"),D=o("vRtn"),T=o("EvqT"),b=o("iEHP"),w=o("Zs79"),U=o("HB7v"),F=o("1UH8"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};class NoteListController extends f.A{constructor(){super(),this.disposeReaction=null,this.processingAssetIds=new Set,this.eventQueues=new Map,this.isAddingNewNote=!1,this.setActiveNoteAttributions=e=>{i.c.setActiveNoteAttributions(e)},this.setNoteIdForActiveNoteAttributions=e=>{i.c.setNoteIdForActiveNoteAttributions(e)},this.noteAnalyticsEvent=function(e,t,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";e===p.XD.LPCard||e===p.XD.LPPartial?((0,y.mB)(t?N.Su:N.D4,s),(0,y.mB)(t?N.c0:N.V3,o)):e===p.XD.SOURCE?((0,y.mB)(t?N.Ir:N.Xm,s),(0,y.mB)(t?N.v0:N.uj,o)):e===p.XD.NEW?((0,y.mB)(t?N.nk:N.ei,s),(0,y.mB)(t?N.lP:N.kM,o)):e===p.XD.QnA||e===p.XD.QnAPartial?((0,y.mB)(t?N.YZ:N.H6,s),(0,y.mB)(t?N.o0:N.zI,o)):e!==p.XD.DUPLICATE&&e!==p.XD.DUPLICATE_ATTRIBUTION||((0,y.mB)(t?N.$E:N.SC,s),(0,y.mB)(t?N.H0:N.uZ,o))},this.notesTabScrollRef=c.createRef(),E.A.listenForCustomEvent(S.A.CREATE_SOURCE_NOTE,this.createNoteFromSource.bind(this)),E.A.listenForCustomEvent(S.A.PERFORM_UNDO_IN_NOTE,this.performUndoInNote.bind(this)),E.A.listenForCustomEvent(S.A.PERFORM_REDO_IN_NOTE,this.performRedoInNote.bind(this)),E.A.listenForCustomEvent(S.A.CREATE_NOTE_FROM_COMPLETE_CHAT,this.createNoteFromCompleteChat.bind(this)),E.A.listenForCustomEvent(S.A.CREATE_EMPTY_FEEDBACK_NOTE,this.createEmptyFeedbackNote.bind(this)),E.A.listenForCustomEvent(S.A.SHOW_NOTE_CUSTOM_EVENT,this.showNote.bind(this)),E.A.listenForCustomEvent(S.A.SAVE_UNSAVED_NOTES,this.saveUnsavedNotes.bind(this)),E.A.listenForCustomEvent(S.A.KW_UPLOAD_NOTE_STR,this.initiateUploadAndShareNotes.bind(this)),E.A.listenForCustomEvent(S.A.ONS_UPDATE,this.onsNotificationReceived.bind(this)),E.A.listenForCustomEvent(S.A.CREATE_NOTE_FROM_FEAT,this.createNoteFromFeat.bind(this)),this.disposeReaction=(0,_.mJ)((()=>({lhpViewState:u.A.lhpViewState,selectedTab:d.A.currentSelectedTab})),(e=>{let{lhpViewState:t,selectedTab:o}=e;o===l.js.Notes&&t===l.vU.EXPANDED||this.updateActiveNote(""),o!==l.js.Notes&&(t===l.vU.EXPANDED?this.setMakeNotesEndless(!0):t==l.vU.NORMAL&&this.setMakeNotesEndless(!1)),t===l.vU.EXPANDED&&o===l.js.Notes||this.processNotificationQueue()}))}cleanup(){this.disposeReaction&&(this.disposeReaction(),this.disposeReaction=null)}get noteListError(){return i.c.noteListError}setNoteListError(e){i.c.setNoteListError(e)}get activeNoteAttributions(){return i.c.activeNoteAttributions}updateShowBottomBar(e){i.c.updateShowBottomBar(e)}processNotificationQueue(){return __awaiter(this,void 0,void 0,(function*(){this.updateShowBottomBar(!1),this.eventQueues.forEach(((e,t)=>{!this.processingAssetIds.has(t)&&e.length>0&&(this.processingAssetIds.add(t),this.processEventAndQueue(t,e[0]))}))}))}onsNotificationReceived(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var o,s,n,r,a,c;return __awaiter(this,void 0,void 0,(function*(){if((0,A.HS)(A.$b.INFO,"onsNotificationReceived",null===(o=null==e?void 0:e.detail)||void 0===o?void 0:o.params,"Recipient - ",!(0,O.nu)()," isFromQueue : ",t),!(0,O.nu)()&&(null===(s=null==e?void 0:e.detail)||void 0===s?void 0:s.params.asset_id)&&"Notes"===(null===(n=null==e?void 0:e.detail)||void 0===n?void 0:n.params.parentFolder)){const o=e.detail.params.asset_id;if(!t&&d.A.getLhpViewState()===l.vU.EXPANDED&&d.A.currentSelectedTab===l.js.Notes)return(null===(r=this.eventQueues.get(o))||void 0===r?void 0:r.some((t=>t.detail.params.changeOP===e.detail.params.changeOP&&(t.detail.params.changeOP===p.cI.ADDED||t.detail.params.changeOP===p.cI.UPDATED))))?void(0,A.HS)(A.$b.INFO,"Duplicate event found in queue",e.detail.params):(this.eventQueues.has(o)||this.eventQueues.set(o,[]),null===(a=this.eventQueues.get(o))||void 0===a||a.push(e),void i.c.updateShowBottomBar(!0));if(this.processingAssetIds.has(o))return this.eventQueues.has(o)||this.eventQueues.set(o,[]),void(null===(c=this.eventQueues.get(o))||void 0===c||c.push(e));this.processingAssetIds.add(o),yield this.processEventAndQueue(o,e)}}))}processEventAndQueue(e,t){return __awaiter(this,void 0,void 0,(function*(){try{yield this.processNotification(t);let o=this.eventQueues.get(e)||[];for(;o.length>0;){const t=o.shift();t&&(yield this.processNotification(t)),o=this.eventQueues.get(e)||[]}}catch(t){console.error(`Error processing notification for asset ${e}:`,t)}finally{this.eventQueues.delete(e),this.processingAssetIds.delete(e)}}))}processNotification(e){var t;return __awaiter(this,void 0,void 0,(function*(){if(!(null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.params))return;const o=e.detail.params.asset_id,s=`${N.LE+e.detail.params.changeOP}_${o}`;switch((0,y.mB)(N.p_,s),e.detail.params.changeOP){case p.cI.RENAMED:yield(0,I.OS)(o);break;case p.cI.ADDED:yield this.syncServerNoteToNotes(o);break;case p.cI.UPDATED:yield(0,I.OS)(o);break;case p.cI.DELETED:i.c.deleteNote(o),0===i.c.notesCount&&d.A.setLhpViewState(l.vU.NORMAL)}}))}createNoteFromSource(e){var t,o;return __awaiter(this,void 0,void 0,(function*(){(0,A.HS)(A.$b.INFO,"Create Note from Source",null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.params);const s=null===(o=null==e?void 0:e.detail)||void 0===o?void 0:o.params;if(null==s?void 0:s.data.length)try{const t=yield this.addNote(p.Uq.HTML,p.XD.SOURCE,e.detail.params.data,null==s?void 0:s.noteTitle);(null==s?void 0:s.openNotesTab)?d.A.updateLhpTab(l.js.Notes):(0,A.zq)(p.D4.CREATE_NOTE_FROM_SOURCE_SUCCESS,t)}catch(e){(0,A.HS)(A.$b.ERROR,"Error creating note from source, Error: ",e)}}))}createNoteFromCompleteChat(e){return __awaiter(this,void 0,void 0,(function*(){(0,A.HS)(A.$b.INFO,"Create Note from complete chat");try{const{htmlString:e}=(0,U.I0)();e&&(yield this.addNote(p.Uq.HTML,p.XD.COMPLETE_CHAT,e,"AI Chat Feedback"))}catch(e){(0,A.HS)(A.$b.ERROR,"Error creating note from source, Error: ",e)}}))}createEmptyFeedbackNote(e){return __awaiter(this,void 0,void 0,(function*(){(0,A.HS)(A.$b.INFO,"Create Empty Feedback Note");try{const e=yield this.addNote(p.Uq.HTML,p.XD.DUPLICATE,"","Project feedback"),t=i.c.getNoteFromId(e);t&&(this.updateNoteIsInEditMode(t,!0),setTimeout((()=>{(0,F.k)()}),100))}catch(e){(0,A.HS)(A.$b.ERROR,"Error creating empty feedback note, Error: ",e)}}))}createNoteFromFeat(e){var t,o;return __awaiter(this,void 0,void 0,(function*(){(0,A.HS)(A.$b.INFO,"Create Note from FEAT API");try{const s=null===(o=null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.params)||void 0===o?void 0:o.noteTitle,i=yield this.addNote(p.Uq.NOTEJSON,p.XD.NEW,"",s);i&&(0,A.HS)(A.$b.INFO,"Note created successfully From FEAT API",i)}catch(e){(0,A.HS)(A.$b.ERROR,"Error creating note from FEAT API, Error: ",e)}}))}get makeNotesEndless(){return i.c.makeNotesEndless}setMakeNotesEndless(e){i.c.setMakeNotesEndless(e)}get selectedNoteId(){return i.c.selectedNoteId}getNoteFromId(e){return i.c.getNoteFromId(e)}performUndoInNote(){var e,t;if(i.c.selectedNoteId){const o=i.c.getNoteFromId(i.c.selectedNoteId);o&&o.jotEditorRef&&(null===(t=null===(e=o.jotEditorRef)||void 0===e?void 0:e.current)||void 0===t||t.undo())}}performRedoInNote(){var e,t;if(i.c.selectedNoteId){const o=i.c.getNoteFromId(i.c.selectedNoteId);o&&o.jotEditorRef&&(null===(t=null===(e=o.jotEditorRef)||void 0===e?void 0:e.current)||void 0===t||t.redo())}}saveUnsavedNotes(){if(i.c.selectedNoteId){const e=i.c.getNoteFromId(i.c.selectedNoteId);e&&this.saveNote(e,!0)}}fetchNotes(){return __awaiter(this,void 0,void 0,(function*(){i.c.removeAllNotes();const e=yield(0,I.we)();if(i.c.setNoteListError(!1),i.Ay.isNewCollection)return i.c.setAddNoteInProgress(!1),void u.A.setIsNotesListAvailable(!0);i.c.setAddNoteInProgress(!0),u.A.setIsNotesListAvailable(!1);try{let t;const o=yield(0,b.zP)(i.Ay.sessionID);if(t=e?Array.isArray(o)?yield o[1]:o:Array.isArray(o)?o[0]:o,t.ERR_CODE===a.dE.NO_ERROR){t.children.forEach((e=>{const t=new s.A(p.XD.OTHER,e,!0);t.status=l.fd.kDownloading,t.openStatus=l.rZ.kCanOpen,t.readonly=!(0,O.nu)(),i.c.addNote(t),this.sendAddAssetUpdate(t.id,t.name,t.status,t.type,t.shared,t.openStatus,t.linksJsonString)})),u.A.setIsNotesListAvailable(!0),(0,m.QK)();const e=N.H+this.notesCount;(0,y.mB)(N.p_,e);const o=i.c.notes.map((e=>__awaiter(this,void 0,void 0,(function*(){const t=yield h.A.downloadNote(e,"user_note",T.d.READ_CACHE);t.ERR_CODE===a.dE.NO_ERROR?(i.c.updateNoteFromDownloadNoteResponse(e,t),C.A.addUpdates(i.Ay.sessionID,v.t.kUpdated,{[v.t.kAssetID]:e.id,[v.t.kStatusKey]:l.fd.kDownloaded})):(0,A.HS)(A.$b.ERROR,"Error downloading note for note id:",e.id,e.name,t.responseCode)}))));yield Promise.all(o)}else i.c.setNoteListError(!0),u.A.setIsNotesListAvailable(!0),(0,A.HS)(A.$b.ERROR,"Error getting note list:",t.responseCode)}catch(e){(0,A.HS)(A.$b.ERROR,"Exception getting note list:",e)}i.c.setAddNoteInProgress(!1)}))}syncServerNoteToNotes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return __awaiter(this,void 0,void 0,(function*(){if(i.c.getNoteFromId(e))return(0,A.HS)(A.$b.ERROR,"[Recipient] Note already exists",e),!1;const o=new D.A(i.Ay.sessionID,e),r=yield n.A.ExecuteKWCommand(o);if(r.ERR_CODE===a.dE.NO_ERROR){const e=new s.A(p.XD.OTHER,r,!0);e.status=l.fd.kDownloading,e.openStatus=l.rZ.kCanOpen,e.readonly=!(0,O.nu)(),i.c.addNote(e,!0),this.sendAddAssetUpdate(e.id,e.name,e.status,e.type,e.shared,e.openStatus,e.linksJsonString);return yield(0,I.e5)(e.id,t)}return(0,A.HS)(A.$b.ERROR,"[Recipient] Error fetching note id:",e,r.responseCode),!1}))}fetchNotesOffline(){}setAddNoteInProgress(e){i.c.setAddNoteInProgress(e)}setActiveNoteId(e){i.c.selectedNoteId!==e&&i.c.setSelectedNoteId(e)}get isNotesListAvailable(){return u.A.isNotesListAvailable}createNoteInServer(e){return __awaiter(this,void 0,void 0,(function*(){const t=JSON.stringify(e.content);if(i.Ay.workspaceCreateLongNote||t&&!(i.c.noteConfigs.directUploadSizeLimit>t.length))return(0,I.ji)(e),(0,A.HS)(A.$b.INFO,"Creating long Note",t.length),!0;{const o=new CreateNoteCommand(i.Ay.sessionID,{name:e.name,on_dup_name:"auto_rename",access_level:"shared",content_source:(0,A.nR)(e.creationMethod)},t),s=Date.now();try{const t=yield n.A.ExecuteKWCommand(o);return t.ERR_CODE===a.dE.NO_ERROR?(C.A.addUpdates(i.Ay.sessionID,v.t.kUpdated,{[v.t.kAssetID]:e.id,[v.t.kUpdatedAssetID]:t.id,[v.t.kStatusKey]:l.fd.kUploaded,[v.t.kNameKey]:t.name}),i.c.updateNoteFromCreateNoteResponse(e,t),this.noteAnalyticsEvent(e.creationMethod,!0,(0,P.A)(Date.now()-s),e.id),(0,k.HY)(L.A.kCollectionUpdated),!0):(this.noteAnalyticsEvent(e.creationMethod,!1,(0,P.A)(Date.now()-s)),(0,A.HS)(A.$b.ERROR,"Error creating note, Response Code",t.responseCode),!1)}catch(e){return(0,A.HS)(A.$b.ERROR,`Error creating note, Error: ${JSON.stringify(e)}`),!1}}}))}initiateUploadAndShareNotes(e){var t,o,s,n,r,a,d,l,c,u,h,A,m,p;return __awaiter(this,void 0,void 0,(function*(){const g=null===(s=null===(o=null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.params)||void 0===o?void 0:o.params)||void 0===s?void 0:s.noteId,C=null===(a=null===(r=null===(n=null==e?void 0:e.detail)||void 0===n?void 0:n.params)||void 0===r?void 0:r.params)||void 0===a?void 0:a.collaborators,v=null===(c=null===(l=null===(d=null==e?void 0:e.detail)||void 0===d?void 0:d.params)||void 0===l?void 0:l.params)||void 0===c?void 0:c.emailSubject,f=null===(A=null===(h=null===(u=null==e?void 0:e.detail)||void 0===u?void 0:u.params)||void 0===h?void 0:h.params)||void 0===A?void 0:A.customMessage,E=i.c.getNoteFromId(g),S=null===(p=null===(m=null==E?void 0:E.jotEditorRef)||void 0===m?void 0:m.current)||void 0===p?void 0:p.getCompleteHtml();E&&S&&(()=>{__awaiter(this,void 0,void 0,(function*(){if(!R.providers["native-api"])return;const e=yield R.providers["native-api"](),t=yield e.largeDataAPI(),o={kwcId:i.Ay.sessionID,noteId:E.id,noteName:E.name,accessLevel:E.accessLevel,collaborators:C,email_subject:v,custom_message:f,generate_instant_link:"false"};t.sendDataToNative(S,"KWC::UploadAndShareNoteHtmlStr",JSON.stringify(o))}))})()}))}addNote(e,t,o,n,r){var a,c,u;return __awaiter(this,void 0,void 0,(function*(){(0,A.HS)(A.$b.INFO,"addNote",e,t,o),this.isAddingNewNote=!0;const h=yield(0,g.ew)(e,o),m=new s.A(t);if(m.content=h,m.name=n||i.c.getAvailableNoteName(),m.isCreatedInServer=!1,m.creationMethod=t,m.contentSource=(0,A.nR)(t),t!==p.XD.LPCard&&t!==p.XD.QnA||(m.showAttributions=!0),d.A.getLhpViewState()!==l.vU.CLOSED&&t!==p.XD.SOURCE&&(d.A.updateLhpTab(l.js.Notes),m.showEmptyTitle=m.creationMethod!==p.XD.DUPLICATE,m.isInEditMode=(0,A.Te)(t)),t!==p.XD.COMPLETE_CHAT&&this.updateActiveNote(m.id),(t===p.XD.DUPLICATE||t===p.XD.DUPLICATE_ATTRIBUTION)&&r){const e=i.c.getNoteFromId(r);e&&(m.contentSource=e.contentSource,t===p.XD.DUPLICATE&&(m.showAttributions=e.showAttributions,m.isInEditMode=""===m.contentSource))}i.c.addNote(m),this.sendAddAssetUpdate(m.id,m.name,m.status,m.type,m.shared,m.openStatus,m.linksJsonString),null===(u=null===(c=null===(a=this.notesTabScrollRef)||void 0===a?void 0:a.current)||void 0===c?void 0:c.UNSAFE_getDOMNode())||void 0===u||u.scrollTo({top:0,behavior:"smooth"});try{const e=m.id;let o=!1;return(0,I.qz)(m,l.fd.kUploading),o=t!==p.XD.DUPLICATE&&t!==p.XD.DUPLICATE_ATTRIBUTION||!r?yield this.createNoteInServer(m):yield this.copyNote(r,m),o?(e===i.c.selectedNoteId&&i.c.setSelectedNoteId(m.id),i.c.setContentLoaded(m,!0),this.isAddingNewNote=!1,m.id):((0,A.zq)(p.D4.CREATE_ERROR),C.A.addUpdates(i.Ay.sessionID,v.t.kRemoved,{[v.t.kAssetID]:m.id}),i.c.deleteNote(m.id),"")}catch(e){return(0,A.HS)(A.$b.ERROR,"Error creating note, Error: ",e),C.A.addUpdates(i.Ay.sessionID,v.t.kRemoved,{[v.t.kAssetID]:m.id}),i.c.deleteNote(m.id),this.isAddingNewNote=!1,""}}))}saveNote(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return __awaiter(this,void 0,void 0,(function*(){try{if(e.isModified&&C.A.addUpdates(i.Ay.sessionID,v.t.kUpdated,{[v.t.kAssetID]:e.id,[v.t.kStatusKey]:l.fd.kToUpload}),!e.isCreatedInServer||!e.isModified)return;if(t){if(e.saveTimerId&&(clearTimeout(e.saveTimerId),e.saveTimerId=null),e.status===l.fd.kUploading){const t=(0,_.z7)((()=>e.status===l.fd.kUploaded),(()=>__awaiter(this,void 0,void 0,(function*(){try{yield(0,I.FO)(e)}catch(e){(0,A.HS)(A.$b.ERROR,"Error updating note content:",e)}t()}))))}else yield(0,I.FO)(e);return}if(e.status!==l.fd.kUploading&&!e.saveTimerId){const t=Date.now()-e.lastSavedTime,o=Math.max(i.c.noteConfigs.autoSaveFrequency-t,0);e.saveTimerId=setTimeout((()=>__awaiter(this,void 0,void 0,(function*(){try{yield(0,I.FO)(e)}catch(e){(0,A.HS)(A.$b.ERROR,"Error updating note content:",e)}finally{e.saveTimerId&&(clearTimeout(e.saveTimerId),e.saveTimerId=null)}}))),o)}}catch(e){(0,A.HS)(A.$b.ERROR,"Error in saveNote:",e)}}))}showNote(e){var t,o,s,n,r,a,c;return __awaiter(this,void 0,void 0,(function*(){if(null===(o=null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.params)||void 0===o?void 0:o.length){(0,A.HS)(A.$b.INFO,"Show Note",null===(s=null==e?void 0:e.detail)||void 0===s?void 0:s.params);const t=i.c.getNoteFromId(null===(n=null==e?void 0:e.detail)||void 0===n?void 0:n.params);t&&(d.A.updateLhpTab(l.js.Notes),this.updateActiveNote(t.id),null===(c=null===(a=null===(r=this.notesTabScrollRef)||void 0===r?void 0:r.current)||void 0===a?void 0:a.UNSAFE_getDOMNode())||void 0===c||c.scrollTo({top:0,behavior:"smooth"}),d.A.setLhpViewState(l.vU.EXPANDED),i.c.setSelectedNoteId(t.id))}}))}duplicateNote(e){return __awaiter(this,void 0,void 0,(function*(){const t=i.c.getNoteFromId(e);if(t)try{yield this.addNote(p.Uq.NOTEJSON,p.XD.DUPLICATE,t.content,`${t.name} copy`,t.id)}catch(e){(0,A.HS)(A.$b.ERROR,"Error duplicating note, Error: ",e)}}))}getNoteListFromStore(){return i.c.notes}get notesCount(){return i.c.notesCount}updateNoteTitle(e,t){return i.c.updateNoteTitle(e,t)}updateNoteAccessLevel(e,t){return i.c.updateNoteAccessLevel(e,t)}updateNoteShowAttributions(e,t){return i.c.updateNoteShowAttributions(e,t)}updateNoteChecked(e,t){return i.c.updateNoteChecked(e,t)}updateNoteIsHovered(e,t){return i.c.updateNoteIsHovered(e,t)}updateNoteContentSource(e,t){return i.c.updateContentSource(e,t)}updateActiveNote(e){if(e!==i.c.selectedNoteId){(0,m.ab)(!1);const e=i.c.selectedNoteId?i.c.getNoteFromId(i.c.selectedNoteId):null;e&&(this.saveNote(e,!0),this.updateNoteIsInEditMode(e,!1))}this.setActiveNoteId(e),""!==e&&d.A.getLhpViewState()===l.vU.NORMAL&&((0,y.mB)(N.p_,N._7),d.A.setLhpViewState(l.vU.EXPANDED))}updateNoteCollapseState(e,t){var o;if(null===(o=e.editorDivRef)||void 0===o?void 0:o.current){const t=e.editorDivRef.current.scrollHeight,o=e.editorDivRef.current;e.isCollapsed?(o.style.maxHeight=`${t}px`,o.style.opacity="1"):(o.style.maxHeight="0px",o.style.opacity="0")}return i.c.updateNoteCollapseState(e.id,t)}onUndoStateChangeHandler(e){i.c.selectedNoteId&&(0,m.tJ)(e)}onRedoStateChangeHandler(e){i.c.selectedNoteId&&(0,m.tE)(e)}copyNote(e,t){var o,s,r,d,c,u,h,m;return __awaiter(this,void 0,void 0,(function*(){const p={kwcollection_id:i.Ay.sessionID,notes:[{id:e}]},g={kwcollection_id:i.Ay.sessionID},f=new w.A(p,g),E=Date.now();try{const p=yield n.A.ExecuteKWCommand(f);if("DONE"!==p.status)return(0,A.HS)(A.$b.ERROR,"Error copying note, Error: ",p),this.noteAnalyticsEvent(t.creationMethod,!1,(0,P.A)(Date.now()-E)),!1;if((0,A.HS)(A.$b.INFO,"Original Note id: ",e,"Response: ",p),null===(s=null===(o=null==p?void 0:p.notes)||void 0===o?void 0:o[0])||void 0===s?void 0:s.target_id){const e=new D.A(i.Ay.sessionID,null===(d=null===(r=null==p?void 0:p.notes)||void 0===r?void 0:r[0])||void 0===d?void 0:d.target_id),o=yield n.A.ExecuteKWCommand(e);return o.ERR_CODE===a.dE.NO_ERROR?(C.A.addUpdates(i.Ay.sessionID,v.t.kUpdated,{[v.t.kAssetID]:t.id,[v.t.kUpdatedAssetID]:null===(u=null===(c=null==p?void 0:p.notes)||void 0===c?void 0:c[0])||void 0===u?void 0:u.target_id,[v.t.kStatusKey]:l.fd.kUploaded,[v.t.kNameKey]:o.name}),t.id=null===(m=null===(h=null==p?void 0:p.notes)||void 0===h?void 0:h[0])||void 0===m?void 0:m.target_id,t.created=o.created,t.name=o.name,t.accessLevel=o.access_level,t.createdBy=o.created_by,t.size=o.size,t.updateLinks(o.acpc_links),t.modified=o.modified,t.showAttributions=o.show_attributions,t.eTag=o.etag,t.isCreatedInServer=!0,(0,I.qz)(t,l.fd.kUploaded),this.noteAnalyticsEvent(t.creationMethod,!0,(0,P.A)(Date.now()-E),t.id),!0):(this.noteAnalyticsEvent(t.creationMethod,!1,(0,P.A)(Date.now()-E)),(0,A.HS)(A.$b.ERROR,"Error copying note, Error: ",o),!1)}}catch(e){return(0,A.HS)(A.$b.ERROR,"Error copying note, Error: ",e),!1}return!1}))}updateNoteIsInEditMode(e,t){var o,s,n,r,a,d,l,c;return __awaiter(this,void 0,void 0,(function*(){let u=!0;if(t){if(e.isCollapsed&&this.updateNoteCollapseState(e,!1),e.showAttributions&&(null===(s=null===(o=e.jotEditorRef)||void 0===o?void 0:o.current)||void 0===s?void 0:s.hasAttributions())){const t=yield(0,m.zq)();if(!t.data.confirmed)return;t.data.checkbox&&(u=!1,this.addNote(p.Uq.NOTEJSON,p.XD.DUPLICATE_ATTRIBUTION,e.content,`${e.name} copy`,e.id))}}else u=!1,null===(r=null===(n=e.jotEditorRef)||void 0===n?void 0:n.current)||void 0===r||r.switchMode("read"),(0,m.ab)(!1);i.c.updateNoteIsInEditMode(e,t),u&&(null===(d=null===(a=e.jotEditorRef)||void 0===a?void 0:a.current)||void 0===d||d.switchMode("edit"),null===(c=null===(l=e.jotEditorRef)||void 0===l?void 0:l.current)||void 0===c||c.focus())}))}}const H=new NoteListController},eJZf:(e,t,o)=>{"use strict";o.d(t,{A:()=>N});var s=o("2Wlf"),i=o("ltzk"),n=o("jpy3"),r=o("qT9o"),a=o("o6hE"),d=o("cqvz"),l=o("5yyX"),c=o("uy9O"),u=o("+7jM"),h=o("bV+/"),A=o("JEFO"),m=o("QLQe"),p=o("24xA"),g=o("rjgr"),C=o("vJCg"),v=o("cBgH"),f=o("JvqQ"),E=o("9oid"),S=o("y4dE"),I=o("zfUP"),y=o("2NhI"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const N=new class CustomAgentListController{constructor(){this.init()}init(){g.$D.subscribe(C.A.kRefreshCustomAgentsOnONS,this.refreshCustomAgentsOnONS.bind(this))}setIntl(e){this.intlContext=e}getCustomAgentFromId(e){return s.s3.getCustomAgentFromId(e)}get intendedCustomAgent(){return s.s3.intendedCustomAgent}set intendedCustomAgent(e){s.s3.intendedCustomAgent=e}fetchCustomAgents(){return __awaiter(this,void 0,void 0,(function*(){s.s3.setAddCustomAgentInProgress(!0);try{const e=yield(0,d.xx)(s.Ay.sessionID);if(e.ERR_CODE===n.dE.NO_ERROR){yield(0,h.EP)(),s.s3.setSelectedCustomAgentId(null);const t=[];e.agents.forEach((e=>{const o=new r.A;o.id=e.id,o.name=e.configs.name,o.description=e.configs.description?e.configs.description:"",o.goal=e.configs.goal?e.configs.goal:"",o.instructions=e.configs.instructions,e.audience.forEach((e=>{e===a.mG&&(o.audience=e)})),o.type=e.type,t.push(o);const i={[c.X.kCustomAgentID]:o.id};(0,l.VD)(i,o.name,o.goal,o.instructions,o.audience,o.type),u.A.addUpdates(s.Ay.sessionID,c.X.kUpdated,i)})),s.s3.refreshCustomAgentStore(t),i.A.setIsCustomAgentsListAvailable(!0)}else(0,A.B)("Error getting custom agent list:",e.responseCode)}catch(e){(0,A.B)("Exception getting custom agent list:",e)}s.s3.setAddCustomAgentInProgress(!1)}))}refreshCustomAgentsOnONS(){return __awaiter(this,void 0,void 0,(function*(){try{if(!s.Ay.workspaceUseCustomAgent)return;const e=new E.A(s.Ay.sessionID,!0),t=yield S.A.ExecuteKWCommand(e);if(t.ERR_CODE===n.dE.NO_ERROR){if((0,I.A)(t.role)!==y.Z.kOwner){s.Ay.isReadFromCache=!1,t.custom_agent&&t.custom_agent.id&&t.custom_agent.type?(s.Ay.recipientCustomAgentID=t.custom_agent.id,s.Ay.recipientCustomAgentType=t.custom_agent.type):(s.Ay.recipientCustomAgentID="",s.Ay.recipientCustomAgentType=""),this.updateRecipientCustomAgent(s.Ay.recipientCustomAgentType);const e={[c.X.kCustomAgentID]:s.Ay.recipientCustomAgentID,[c.X.kTypeKey]:s.Ay.recipientCustomAgentType};u.A.addUpdates(s.Ay.sessionID,c.X.kRecipientUpdated,e)}}else(0,A.B)("Error getting recipient custom agent info:",t.responseCode)}catch(e){(0,A.B)("Exception getting recipient custom agent info:",e)}}))}setAddCustomAgentInProgress(e){s.s3.setAddCustomAgentInProgress(e)}get isCustomAgentsListAvailable(){return i.A.isCustomAgentsListAvailable}getCustomAgentListFromStore(){return s.s3.customAgents}get customAgentsCount(){return s.s3.customAgentsCount}get selectedCustomAgentId(){return s.s3.selectedCustomAgentId}getSelectedCustomAgentName(){var e;return this.selectedCustomAgentId||""===this.selectedCustomAgentId?null===(e=this.getCustomAgentFromId(this.selectedCustomAgentId))||void 0===e?void 0:e.name:""}setCustomAgentAudience(e,t){s.s3.setCustomAgentAudience(e,t)}createNewCustomAgent(e,t){return __awaiter(this,void 0,void 0,(function*(){const o={};yield(0,d.qp)(o,e,t);try{c.X.kCustomAgentID in o?0===t.length?u.A.addUpdates(s.Ay.sessionID,c.X.kCreated,o):(u.A.addUpdates(s.Ay.sessionID,c.X.kApplied,o),s.s3.showCustomAgentChangedToPresetSoftBanner(e.name),(0,m.mB)(p.kK,`${p.LB}:${e.name}`)):""!==e.name&&(s.s3.showCustomAgentChangedToPresetFailureSoftBanner(e.name),(0,m.mB)(p.kK,`${p.WK}${p.H8}:${e.name}${p.up}`))}catch(e){(0,A.B)("Exception creating new custom agent:",e)}}))}updateExistingCustomAgent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return __awaiter(this,void 0,void 0,(function*(){const o={},i={value:!1};yield(0,d.mD)(o,e,i,t);try{c.X.kCustomAgentID in o?t?(u.A.addUpdates(s.Ay.sessionID,c.X.kApplied,o),e.audience===a.mG?e.type===a.AR||e.type===a.yK?(s.s3.showCustomAgentChangedToPresetSoftBanner(e.name),(0,m.mB)(p.kK,`${p.LB}:${e.name}`)):e.type===a.gL&&(s.s3.showCustomAgentChangedSoftBanner(),(0,m.mB)(p.kK,p.z$)):(s.s3.showCustomAgentChangedSoftBanner(),(0,m.mB)(p.kK,p.RQ))):u.A.addUpdates(s.Ay.sessionID,c.X.kModified,o):e.audience===a.mG?""!==e.name?(s.s3.showCustomAgentChangedToPresetFailureSoftBanner(e.name),(0,m.mB)(p.kK,`${p.WK}${p.H8}:${e.name}${p.up}`)):(s.s3.showCustomAgentChangedFailureSoftBanner(),(0,m.mB)(p.kK,p.jY)):(s.s3.showCustomAgentChangedFailureSoftBanner(),(0,m.mB)(p.kK,p.pI)),!0===i.value&&console.log("Need to refresh custom agent list but this should not happen in this case")}catch(e){(0,A.B)("Exception updating custom agent:",e)}}))}applyCustomAgent(e){return __awaiter(this,void 0,void 0,(function*(){const t=new r.A;t.id=e,t.audience=a.mG;try{const e=s.s3.getCustomAgentFromId(t.id);if(!e)return void(0,A.B)("Error applying custom agent not found:",t.id);e.type===a.gL?this.intendedCustomAgent=s.s3.defaultCustomAgentNameText:this.intendedCustomAgent=e.name,e.type===a.yK?(t.goal=e.goal,t.instructions=e.instructions,t.name=e.name,(0,m.mB)(p.kK,`${p.OT}:${t.name}`),this.createNewCustomAgent(t,e.id)):(e.type===a.AR?(t.name=e.name,(0,m.mB)(p.kK,`${p.OT}:${t.name}`)):e.type===a.gL&&(0,m.mB)(p.kK,p.EM),this.updateExistingCustomAgent(t,!0))}catch(e){(0,A.B)("Exception applying custom agent:",e)}}))}resetToDefaultAIAssistant(e){return __awaiter(this,void 0,void 0,(function*(){const t=new r.A;t.id=e,t.audience="";try{if(!s.s3.getCustomAgentFromId(t.id))return void(0,A.B)("Error default AI Assistant, custom agent not found:",t.id);this.intendedCustomAgent=s.s3.defaultCustomAgentNameText,this.updateExistingCustomAgent(t,!0)}catch(e){(0,A.B)("Exception default AI Assistant:",e)}}))}canChangeCustomAgent(){return __awaiter(this,void 0,void 0,(function*(){if(s.s3.confirmedCustomAgentChange)return!0;const e=yield(0,h.rC)();return e.data.confirmed&&s.s3.setConfirmedCustomAgentChange(!0),e.data.canChangeCustomAgent}))}populateCustomAgentList(){var e,t,o,s,i;const n=[],r=[];n.push({id:a.ys,name:(null===(e=this.intlContext)||void 0===e?void 0:e.formatMessage({id:"agent.list.none.text"}))||"",info:"Your personal assistant, offering clear guidance and tailored support.",description:null===(t=this.intlContext)||void 0===t?void 0:t.formatMessage({id:"agent.list.none.description"}),type:a.ys,isEnabled:!0}),this.getCustomAgentListFromStore().forEach((e=>{e.type===a.gL?r.push({id:e.id,name:e.name,info:"",type:e.type,isEnabled:!0}):n.push({id:e.id,name:e.name,info:e.description&&e.description.length>0?e.description:e.goal,type:e.type,isEnabled:!0})}));const d=r.length<a.yc;r.push({id:a.V7,name:(null===(o=this.intlContext)||void 0===o?void 0:o.formatMessage({id:"agent.list.createYourOwn.text"}))||"",info:"",type:a.V7,isEnabled:d,showTooltip:!d,toolTipText:(null===(s=this.intlContext)||void 0===s?void 0:s.formatMessage({id:"agent.list.createYourOwn.disabled.tooltip"},{maxAgents:a.yc}))||""});return[{title:"",name:"Top",children:n},r.length>1?{title:(null===(i=this.intlContext)||void 0===i?void 0:i.formatMessage({id:"agent.list.yourspecialists.text"}))||"",name:"Bottom",children:r}:{title:"",name:"Bottom",children:r}]}showCustomAgentDisclaimerBarToRecipient(){return s.Ay.workspaceUseCustomAgent&&s.s3.isRecipientCustomAgentUserKWC&&0===this.customAgentsCount&&v.A.isCollabSessionInfoUpdated&&!(0,f.sO)()}updateRecipientCustomAgent(e){s.s3.shouldShowCustomAgentForRecipient?e!==a.AR&&e!==a.gL&&s.s3.setShowCustomAgentForRecipient(!1):e!==a.AR&&e!==a.gL||s.s3.setShowCustomAgentForRecipient(!0),s.s3.setRecipientCustomAgentUserKWC(e===a.gL)}}},"+I5k":(e,t,o)=>{"use strict";o.d(t,{A:()=>U});var s=o("2Wlf"),i=o("ltzk"),n=o("mVLN"),r=o("9A+i"),a=o("PBXi"),d=o("iEHP"),l=o("GTxN"),c=o("bV+/"),u=o("U5BB"),h=o("oYND"),A=o("QLQe"),m=o("86lk"),p=o("h9J0"),g=o("C/hT"),C=o("CVnK"),v=o("KlZm"),f=o("xYLj"),E=o("Jjq2"),S=o("2NhI"),I=o("jpy3"),y=o("LAsn"),N=o("sVfd"),R=o("/caq"),_=o("mixQ"),k=o("gvDY"),L=o("m1+/"),O=o("rjgr"),P=o("vJCg"),D=o("y4dE"),T=o("mPX5"),b=o("bTOH"),w=o("icFW"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))},__rest=function(e,t){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(o[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(o[s[i]]=e[s[i]])}return o};class LPController extends L.T{get isCutomAgentUpdating(){return k.A.isCustomAgentUpdating}setCustomAgentUpdating(e){k.A.setIsCustomAgentUpdating(e)}setLastOnboardingState(e){this.lastOnboardingState=e}get allLPCardsVisible(){return this.areAllLPCardsVisible}setAllLPCardsVisible(e){this.areAllLPCardsVisible=e}showRefreshedLP(){if(this.refreshedLPCards){Object.keys(this.refreshedLPCards).slice().reverse().every((e=>{const t=this.refreshedLPCards[e];return t.uiState!==r.u4.HEADER_SHOWN&&t.uiState!==r.u4.END||(k.A.setLPCards(t.cards),!1)}),this)}this.refreshedGoals.goals.length>0&&(this.checkAndUpdateGoals(this.refreshedGoals.goals,r.OX.StreamingService),this.refreshedGoals.goals=[])}handleLPRefreshFailed(){0===this.lpCards().length&&(this.LogLPErrorAnalytics(),k.A.lpErrorState.cards||k.A.setCardErrorState(f.O4.TIMEOUT),k.A.lpErrorState.goals||k.A.setGoalErrorState(f.O4.TIMEOUT))}checkAndUpdateGoals(e,t){if(e.length<=0||this.goalsSource>t)(0,E.N7)(E.bi.ThoughtPartner,E.Hc.Goals,"Rejected due to low precedence");else{if(e.every((e=>this.getGoals().includes(e))))return(0,E.N7)(E.bi.ThoughtPartner,E.Hc.Goals,"Rejected duplicates"),void(this.goalsSource=t);(0,E.a8)(E.bi.ThoughtPartner,E.Hc.Goals,`Updated to source ${t}`),this.setIsOnboardingInProgress(!1),this.setGoals(e),this.goalsSource=t}}logCollectionOpenedAnalytics(){this.analyticsStore.CollectionOpenedLogged||(this.analyticsStore.CollectionOpenedLogged=!0,(0,A.mB)(m.fU,m.sm))}refreshLPCard(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return __awaiter(this,void 0,void 0,(function*(){if(s.Ay.isCuratedCollection)return;this.accumulatedSourcesUpdated=0,e||(k.A.clearLPCards(),k.A.setGoalErrorState(null),k.A.setCardErrorState(null));const i="online";if(this.showSourcesUpdatedToast(t),l.A.areAllSourcesImported()){this.analyticsStore.LPRefreshFirstInitTime=Date.now(),this.analyticsStore.LPRefreshLastInitTime=Date.now(),this.analyticsStore.GoalsRefreshInitTime=Date.now();const t=s.Ay.genAISessionId,n=s.Ay.sessionID;console.log("[KW] REFRESHING LP CARDS",s.te.sourceCountNoErrorImported),o&&k.A.lpRefreshHeaderType===r.xO.NONE&&this.setLPRefreshHeaderType(r.xO.GENERATING),(0,d.dU)(t,i,n,this.lpCardMetadataCallback,this.lpStreamingCallback,e,!0),this.goalsSource=this.getGoals().length?r.OX.LocalCache:r.OX.NotFetched,(0,d.A_)(t,i,n,this.goalStreamingCallback,e,!0)}else this.fetchLPRequested={isRequested:!0,background:e}}))}refreshLPAndGoalsForRecipient(){this.goalsSource=this.getGoals().length?r.OX.LocalCache:r.OX.NotFetched,(0,d.nH)(s.Ay.sessionID),(0,d.vc)(this.goalStorageCallback)}autoRenameCollection(e){return __awaiter(this,void 0,void 0,(function*(){let t;const o=yield(0,c.my)(s.Ay.sessionID);try{if(e&&"contents"in e[0]&&!o.data&&!s.Ay.wasAutoRenameSuccessful&&s.Ay.isNewCollection&&(t=e[0].contents[0].children[0].text,""!==t)){const e=new T.A(s.Ay.sessionID,t,void 0,void 0);try{const o=yield D.A.ExecuteKWCommand(e);if(o.ERR_CODE===I.dE.RESOURCE_CONFLICT)return void(0,E.a8)(E.bi.AutoRenameCollection,E.Hc.UpdateCollectionInfo,"Name already exist");o.ERR_CODE===I.dE.NO_ERROR&&(s.Ay.setAutoRenameStatus(!0),(0,c.Ec)({networkCallName:b.oj.UPDATE_COLLECTION,id:s.Ay.sessionID,name:t}))}catch(e){(0,E.qz)(E.bi.AutoRenameCollection,E.Hc.UpdateCollectionInfo,`Update network call error: ${e}`)}}}catch(e){(0,E.qz)(E.bi.AutoRenameCollection,E.Hc.UpdateCollectionInfo,"Condition Failed")}}))}constructor(){super(),this.areAllLPCardsVisible=!1,this.wasLPHeaderUpdated=!1,this.isLPRefreshBarVisible=!1,this.fetchLPRequested={isRequested:!1,background:!1},this.accumulatedSourcesUpdated=0,this.refreshedLPCards={},this.refreshedGoals={goals:[]},this.goalsSource=r.OX.NotFetched,this.mGoalsRequestedTime=0,this.analyticsStore={LPCardLogged:!1,LPLoadedLogged:!1,LPCardPerfStartTime:Date.now(),LPCardPerfEndTime:Date.now(),LPCardScrolledLogged:!1,LPFirstStreamLogged:!1,LPLastStreamLogged:!1,GoalsFetchedLogged:!1,GoalsFetchedForCustomAgentRefreshLogged:!1,GoalsFetchedForRefreshLogged:!1,LPRefreshFirstStreamLogged:!1,LPRefreshForCustomAgentFirstStreamLogged:!1,LPRefreshLastStreamLogged:!1,LPRefreshForCustomAgentLastStreamLogged:!1,LPRefreshFirstInitTime:Date.now(),LPRefreshLastInitTime:Date.now(),LPRefreshForCustomAgentFirstInitTime:Date.now(),LPRefreshForCustomAgentLastInitTime:Date.now(),GoalsRefreshForCustomAgentInitTime:Date.now(),GoalsRefreshInitTime:Date.now(),TriggerTransactionId:"",CollectionOpenedLogged:!1},this.shouldSkipInitialSourceLoad=!0,this.lastOnboardingState=r.Gf.USERWELCOME,this.goalIDMap=new Map,this.activeCardScrollContainerRef=void 0,this.scrollDebounceTimeout=null,this.cardContentscrollDebounceTimeout=null,this.goalStorageCallback=e=>__awaiter(this,void 0,void 0,(function*(){const{response:t}=e,o=[S.Z.kReviewer,S.Z.kViewer].includes(s.Ay.userRole),i=t.goal_recommendations;if(!i||!Array.isArray(i))return void((o||s.Ay.isCuratedCollection)&&((0,E.qz)(E.bi.ThoughtPartner,E.Hc.Goals,`Unable to parse goal storage API response: ${t}`),k.A.setGoalErrorState((0,f.kx)("INVALID_DATA"))));let n=[];try{n=i.map((e=>e.text))}catch(e){return void(o&&((0,E.qz)(E.bi.ThoughtPartner,E.Hc.Goals,`Unable to parse goal storage API response: ${i}`),k.A.setGoalErrorState((0,f.kx)("INVALID_DATA"))))}this.checkAndUpdateGoals(n,r.OX.StorageService);try{const e=i.map((e=>{const{id:t}=e,o=__rest(e,["id"]);return Object.assign(Object.assign({},o),{data_id:t,type:"goal"})})),t=yield g.Ay.getKWCacheNativeAPI();null==t||t.WriteMetaDataToCache(s.Ay.sessionID,e,g.p3.KWCollectionGoal)}catch(e){(0,E.qz)(E.bi.ThoughtPartner,E.Hc.Goals,`Error caching goals: ${e}`)}})),this.debouncedStoreUpdateHandler=(0,v.sg)((()=>{!this.shouldSkipInitialSourceLoad||(this.shouldSkipInitialSourceLoad=!1,this.lpErrorState.cards.errorCode&&[f.O4.UPLOAD_FAILED.code,f.O4.INGESTION_FAILED.code,f.O4.NO_CONTENT_FOUND.code].includes(this.lpErrorState.cards.errorCode.code))?(s.Ay.userRole===S.Z.kOwner&&(this.analyticsStore.LPRefreshFirstInitTime=Date.now(),this.analyticsStore.LPRefreshLastInitTime=Date.now(),this.analyticsStore.GoalsRefreshInitTime=Date.now(),this.analyticsStore.LPRefreshFirstStreamLogged=!1,this.analyticsStore.LPRefreshLastStreamLogged=!1,this.analyticsStore.GoalsFetchedForRefreshLogged=!1,this.refreshLPCard(null===this.lpErrorState.cards.errorCode,this.accumulatedSourcesUpdated,null===this.lpErrorState.cards.errorCode)),_.A.updateChatMessage({type:a.Go.OUTDATED_CHAT_ASSET_UPDATE},!0),this.accumulatedSourcesUpdated=0):this.accumulatedSourcesUpdated=0}),2e3),this.goalStreamingCallback=e=>__awaiter(this,void 0,void 0,(function*(){var t;const{response:o,inBackground:i,shouldLogAnalytics:n,fetchedFromCache:a,isForCustomAgent:d,isForRefresh:l}=e,c=o,u=null!==(t=null==e?void 0:e.transactionId)&&void 0!==t?t:"";if(c.length<=0)return;const h=[];let C=null;if((0,E.a8)(E.bi.ThoughtPartner,E.Hc.Goals,`Goal Streaming Callback data received of size: , ${c.length}`),c.forEach((e=>{try{void 0!==e&&"goal"===e.type?(h.push(e.text),this.goalIDMap.set(e.text,e.data_id),(0,E.a8)(E.bi.ThoughtPartner,E.Hc.Goals,"Goals updated")):void 0!==e&&void 0!==e.ERR&&(C=e.ERR_MSG)}catch(t){(0,E.qz)(E.bi.ThoughtPartner,E.Hc.Goals,`"Unable to parse QnA output: ", ${e}`),C="UNKNOWN_ERROR"}})),C&&k.A.setGoalErrorState((0,f.kx)(C),u),!(h.length<=0)){if(!a){const e=yield g.Ay.getKWCacheNativeAPI();null==e||e.WriteMetaDataToCache(s.Ay.sessionID,o,g.p3.KWCollectionGoal)}n&&l&&(d&&!this.analyticsStore.GoalsFetchedForCustomAgentRefreshLogged?(this.analyticsStore.GoalsFetchedForCustomAgentRefreshLogged=!0,console.log("Goals fetched for LP refresh custom agent"),(0,A.mB)(m.Cw,(0,p.A)(Date.now()-this.analyticsStore.GoalsRefreshForCustomAgentInitTime)),this.analyticsStore.GoalsRefreshForCustomAgentInitTime=Date.now()):this.analyticsStore.GoalsFetchedForRefreshLogged||(this.analyticsStore.GoalsFetchedForRefreshLogged=!0,console.log("Goals fetched for LP refresh"),(0,A.mB)(m.WJ,(0,p.A)(Date.now()-this.analyticsStore.GoalsRefreshInitTime)),this.analyticsStore.GoalsRefreshInitTime=Date.now())),a||!i?(!n||this.analyticsStore.GoalsFetchedLogged||l||(this.analyticsStore.GoalsFetchedLogged=!0,console.log("Goals fetched for LP"),(0,A.mB)(m.Hx,(0,p.A)(Date.now()-this.mGoalsRequestedTime)),this.mGoalsRequestedTime=Date.now()),this.checkAndUpdateGoals(h,a?r.OX.LocalCache:r.OX.StorageService)):this.refreshedGoals={goals:h}}})),this.lpStreamingCallback=e=>{const{response:t,inBackground:o,isForRefresh:s,isForCustomAgent:i,status:n,transactionId:r}=e,a=t;console.log("LP Streaming Callback data received: ",a),(0,E.a8)(E.bi.ThoughtPartner,E.Hc.LandingPage,`Streaming Callback data received of size: , ${a.length}`),s&&(i?(!this.analyticsStore.LPRefreshForCustomAgentFirstStreamLogged&&a.length>0&&(this.analyticsStore.LPRefreshForCustomAgentFirstStreamLogged=!0,console.log("LP Refresh Custom Agent First Stream Logged"),(0,A.mB)(m.z0,(0,p.A)(Date.now()-this.analyticsStore.LPRefreshForCustomAgentFirstInitTime)),this.analyticsStore.LPRefreshForCustomAgentFirstInitTime=Date.now()),n===R.Br.kEndProcess&&!this.analyticsStore.LPRefreshForCustomAgentLastStreamLogged&&this.analyticsStore.LPRefreshForCustomAgentFirstStreamLogged&&(this.analyticsStore.LPRefreshForCustomAgentLastStreamLogged=!0,console.log("LP Refresh Custom Agent Last Stream Logged"),(0,A.mB)(m.p3,(0,p.A)(Date.now()-this.analyticsStore.LPRefreshForCustomAgentLastInitTime)),this.analyticsStore.LPRefreshForCustomAgentLastInitTime=Date.now())):(!this.analyticsStore.LPRefreshFirstStreamLogged&&a.length>0&&(this.analyticsStore.LPRefreshFirstStreamLogged=!0,console.log("LP Refresh First Stream Logged"),(0,A.mB)(m.rF,(0,p.A)(Date.now()-this.analyticsStore.LPRefreshFirstInitTime)),this.analyticsStore.LPRefreshFirstInitTime=Date.now()),n===R.Br.kEndProcess&&!this.analyticsStore.LPRefreshLastStreamLogged&&this.analyticsStore.LPRefreshFirstStreamLogged&&(this.analyticsStore.LPRefreshLastStreamLogged=!0,console.log("LP Refresh Last Stream Logged"),(0,A.mB)(m.HX,(0,p.A)(Date.now()-this.analyticsStore.LPRefreshLastInitTime)),this.analyticsStore.LPRefreshLastInitTime=Date.now()))),o?r&&this.streamBackgroundLP(e):(s||(!this.analyticsStore.LPFirstStreamLogged&&a.length>0&&(this.analyticsStore.LPFirstStreamLogged=!0,console.log("LP First Stream Logged"),(0,A.mB)(m.qq,(0,p.A)(Date.now()-this.analyticsStore.LPCardPerfStartTime)),this.analyticsStore.LPCardPerfStartTime=Date.now()),n===R.Br.kEndProcess&&!this.analyticsStore.LPLastStreamLogged&&this.analyticsStore.LPFirstStreamLogged&&(this.analyticsStore.LPLastStreamLogged=!0,console.log("LP Last Stream Logged"),(0,A.mB)(m.g2,(0,p.A)(Date.now()-this.analyticsStore.LPCardPerfEndTime)),this.analyticsStore.LPCardPerfEndTime=Date.now())),this.handleLPStreamedContent(a))},this.lpCardMetadataCallback=e=>__awaiter(this,void 0,void 0,(function*(){var t,o,i,n;const{response:a,inBackground:l,transactionId:c}=e,u=a;console.log("LP lpCardMetadataCallback Callback data received: ",u);const h=null!==(t=null==e?void 0:e.transactionId)&&void 0!==t?t:"";if(u.length<=0)return;let A=!1;if((0,d.T_)(u)){(yield g.Ay.getKWCacheNativeAPI()).removeDataFromCache(s.Ay.sessionID,g.p3.KWCollectionLPCard);const e=[];l?c&&(null===(o=u[0].noteIds)||void 0===o||o.forEach(((t,o)=>{var s;const i=new y.A(t,void 0,r.B2.InProgress,r.d.RefreshedStream,null===(s=u[0].noteIdsFull)||void 0===s?void 0:s[o],u[0].schemaVersion,h);e.push(i)})),this.refreshedLPCards[c]={cards:e,cardStream:[],uiState:r.u4.HIDDEN},(null===(i=u[0].noteIds)||void 0===i?void 0:i.length)>0&&(A=!0)):(k.A.clearLPCards(),null===(n=u[0].noteIds)||void 0===n||n.forEach(((t,o)=>{var s;const i=new y.A(t,void 0,r.B2.InProgress,r.d.Stream,null===(s=u[0].noteIdsFull)||void 0===s?void 0:s[o],u[0].schemaVersion,h);e.push(i)})),k.A.setLPCards(e),console.log("[KW][TP] LP Streaming Callback end of answer received, fetch from Notes service"),(0,N.th)("[KW][TP] LP Streaming Callback end of answer received, fetch from Notes service"))}else u[0].status&&"No_Updates"!==u[0].status?(console.log("[KW][TP] LP Streaming Callback error - ",u),k.A.setCardErrorState(f.O4.UNKNOWN_ERROR,h)):"No_Updates"===u[0].status?(console.log("[KW][TP] LP Streaming No Updates - ",u),k.A.setCardErrorState(f.O4.UNKNOWN_ERROR,h)):void 0!==u[0].ERR&&k.A.setCardErrorState((0,f.kx)(u[0].ERR_MSG),h);!A&&l&&k.A.getLPRefreshHeaderType()===r.xO.GENERATING&&k.A.setLPRefreshHeaderType(r.xO.NONE)})),this.LogLPErrorAnalytics=()=>{(0,A.mB)(m.mz,m.wR),(0,A.mB)(m.un,(0,p.A)(Date.now()-this.analyticsStore.LPCardPerfStartTime))},this.refreshLPCardForCustomAgent=e=>__awaiter(this,void 0,void 0,(function*(){var t,o;const s=null!==(o=null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.isModified)&&void 0!==o&&o;this.setCustomAgentUpdating(!0),k.A.lpRefreshHeaderType===r.xO.NONE&&this.setLPRefreshHeaderType(r.xO.GENERATING),yield new Promise((e=>setTimeout(e,1e3))),this.resetLPCardsAndGoal(),this.analyticsStore.GoalsRefreshForCustomAgentInitTime=Date.now(),this.analyticsStore.LPRefreshForCustomAgentFirstInitTime=Date.now(),this.analyticsStore.LPRefreshForCustomAgentLastInitTime=Date.now(),this.analyticsStore.GoalsFetchedForCustomAgentRefreshLogged=!1,this.analyticsStore.LPRefreshForCustomAgentFirstStreamLogged=!1,this.analyticsStore.LPRefreshForCustomAgentLastStreamLogged=!1,yield this.refreshLPCardForCustomAgentHelper(s),this.setCustomAgentUpdating(!1),this.setLPRefreshHeaderType(r.xO.NONE)})),this.registerActiveLpMenu=(e,t)=>{k.A.registerActiveLpMenuAction(e,t)},this.unregisterActiveLpMenu=e=>{k.A.unregisterActiveLpMenuAction(e)},this.getAdditionalGoalData=e=>{const t=this.goalIDMap.get(e);return t?{question_id:t}:{}},this.init();const e="online";this.accumulatedSourcesUpdated=0,(0,C.mJ)((()=>s.te.importedSources),((e,t)=>{if(0===e.length)return;const o=new Set(t.map((e=>e.id))||[]),s=e.length-t.length,i=e.every((e=>!!o.has(e.id)&&(o.delete(e.id),!0)));if(console.log("Sources updated for refresh",e,t),!i||o.size>0){if(this.accumulatedSourcesUpdated+=s,!l.A.areAllSourcesImported()&&this.accumulatedSourcesUpdated>0)return;this.debouncedStoreUpdateHandler()}}),{fireImmediately:!1,delay:20}),(0,C.z7)((()=>l.A.areAllSourcesImported()),(()=>{if(!0===this.fetchLPRequested.isRequested){const t=s.Ay.genAISessionId,o=s.Ay.sessionID;(0,d.dU)(t,e,o,this.lpCardMetadataCallback,this.lpStreamingCallback,this.fetchLPRequested.background),(0,d.vc)(this.goalStorageCallback),s.Ay.isCuratedCollection||(0,d.A_)(t,e,o,this.goalStreamingCallback,this.fetchLPRequested.background),this.mGoalsRequestedTime=Date.now(),this.fetchLPRequested={isRequested:!0,background:!1}}})),(0,C.mJ)((()=>s.te.sources.length>0&&s.te.sourceCountFailedBeforeImport===s.te.sources.length),(e=>{e&&(this.lpErrorState.cards.errorCode&&(k.A.clearGoals(),k.A.clearLPCards(),this.goalsSource=r.OX.NotFetched),k.A.setCardErrorState(f.O4.UPLOAD_FAILED,"",!0),k.A.setGoalErrorState(f.O4.UPLOAD_FAILED,"",!0))})),(0,C.mJ)((()=>s.te.sources.length),((e,t)=>{0===e&&t>0&&(k.A.clearGoals(),k.A.clearLPCards(),this.goalsSource=r.OX.NotFetched,k.A.setCardErrorState(f.O4.NO_CONTENT_FOUND,"",!0),k.A.setGoalErrorState(f.O4.NO_CONTENT_FOUND,"",!0))}),{fireImmediately:!1,delay:20}),(0,C.mJ)((()=>k.A.lpCards.length>1&&k.A.lpCards.every((e=>e.cardStatus===r.B2.Failed))),(e=>{e&&(k.A.setLPCards([k.A.lpCards[0]]),(0,A.mB)(w.EP,`${w.S_}_${k.A.lpCards[0].errorCode}`))}))}init(){u.A.listenForCustomEvent(h.A.ONS_UPDATE,this.onONSNotificationEvent.bind(this)),O.$D.subscribe(P.A.kCustomAgentApplied,this.refreshLPCardForCustomAgent),O.$D.subscribe(P.A.kSourceListAvailable,(()=>{0===s.te.sources.length&&setTimeout((()=>{0===s.te.sources.length&&(k.A.clearGoals(),k.A.clearLPCards(),this.goalsSource=r.OX.NotFetched,k.A.setCardErrorState(f.O4.NO_CONTENT_FOUND,"",!0),k.A.setGoalErrorState(f.O4.NO_CONTENT_FOUND,"",!0))}),20)}))}onONSNotificationEvent(e){var t,o;console.log("ONS update received",null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.params);const i=null===(o=null==e?void 0:e.detail)||void 0===o?void 0:o.params,n=null==i?void 0:i.parentFolder,d=null==i?void 0:i.asset_id,l=null==i?void 0:i.changeOP;if("KWC"===n){if(d===s.Ay.sessionID)return;"Modified"!==l&&_.A.updateChatMessage({type:a.Go.OUTDATED_CHAT_ONS_NOTIFICATION},!0)}else if("LP"===n){if(s.Ay.userRole===S.Z.kOwner)return;this.setLPRefreshHeaderType(r.xO.ONS_NOTIFICATION),k.A.lpCardsPendingUpdatePostNotification=!0}}getGoals(){return k.A.goals}setGoals(e){k.A.clearGoals(),k.A.setGoals(e)}shouldHideTP(){return i.A.lhpViewState===n.vU.FULL_SCREEN}getTPViewWidth(){const e=i.A.lhpViewActualWidth;return`calc(100vh - ${i.A.lhpViewState===n.vU.FULL_SCREEN?"100vh":e})`}handleLPStreamedContent(e){if(k.A.setIsOnboardingInProgress(!1),!(e.length<=0))if(void 0!==e[e.length-1].ERR){if(k.A.lpCards.every((e=>e.cardStatus===r.B2.Failed)))return;if(k.A.lpCards.filter((e=>e.cardStatus===r.B2.InProgress||e.cardStatus===r.B2.Failed)).length===k.A.lpCards.length){const e=k.A.lpCards.find((e=>e.cardStatus===r.B2.Failed));if(e)k.A.setLPCards([e]),(0,A.mB)(w.EP,`${w.S_}_${e.errorCode}`);else{const e=k.A.lpCards[0];e.cardStatus=r.B2.Failed,k.A.setLPCards([e]),(0,A.mB)(w.EP,`${w.S_}_${e.errorCode}`)}}else k.A.lpCards.forEach((e=>{e.cardStatus===r.B2.InProgress&&k.A.updateLPCardStatus(e.id,r.B2.Failed)})),k.A.setLPCards(k.A.lpCards.filter((e=>e.cardStatus!==r.B2.Failed)))}else k.A.setLpCardsStreamedContent(e)}deleteStaleRefreshedLPCards(){Object.keys(this.refreshedLPCards).forEach((e=>{this.refreshedLPCards[e].uiState!==r.u4.END&&this.refreshedLPCards[e].uiState!==r.u4.ERROR||delete this.refreshedLPCards[e]}))}streamBackgroundLP(e){const{response:t,status:o,transactionId:s}=e;if(!s)return;const i=t,n=this.refreshedLPCards[s];n&&(i.length>0&&(void 0!==i[0].ERR&&n.uiState!==r.u4.SHOWING&&n.uiState!==r.u4.SHOWN?(n.uiState=r.u4.ERROR,k.A.setLPRefreshHeaderType(r.xO.NONE)):n&&(n.uiState===r.u4.HIDDEN?(n.uiState=r.u4.HEADER_SHOWN,null==n||n.cardStream.push(...i),k.A.setLPRefreshHeaderType(r.xO.ASSET_UPDATE)):n.uiState===r.u4.HEADER_SHOWN?null==n||n.cardStream.push(...i):n.uiState!==r.u4.SHOWING&&n.uiState!==r.u4.SHOWN||(this.handleLPStreamedContent(i),n.uiState=r.u4.SHOWN))),o===R.Br.kEndProcess&&(this.deleteStaleRefreshedLPCards(),n.uiState=r.u4.END))}resetLPCardsAndGoal(){k.A.clearLPCards(),k.A.clearGoals(),this.goalsSource=r.OX.NotFetched,k.A.setGoalErrorState(null),k.A.setCardErrorState(null)}fetchLPCards(){return __awaiter(this,void 0,void 0,(function*(){(0,d.np)(s.Ay.sessionID,this.goalStreamingCallback);const e="online";if(s.Ay.isNewCollection||((0,d.vc)(this.goalStorageCallback),yield(0,d.nH)(s.Ay.sessionID)),!s.Ay.isNewCollection&&s.Ay.userRole===S.Z.kOwner&&this.lpCards().length>0&&this.getGoals().length>0)this.refreshLPCard(!0,0,!1);else if(s.Ay.userRole===S.Z.kOwner&&!s.Ay.isCuratedCollection)if(l.A.areAllSourcesImported()||!s.Ay.isNewCollection&&0===s.te.sources.length){console.log("Fetch LP cards actually triggered");const t=s.Ay.genAISessionId,o=s.Ay.sessionID;s.Ay.userRole!==S.Z.kOwner||s.Ay.isCuratedCollection||((0,d.dU)(t,e,o,this.lpCardMetadataCallback,this.lpStreamingCallback,!1),(0,d.A_)(t,e,o,this.goalStreamingCallback,!1),this.mGoalsRequestedTime=Date.now())}else this.fetchLPRequested={isRequested:!0,background:!1}}))}handleLPCardTimeout(){0===this.lpCards().length&&(this.LogLPErrorAnalytics(),k.A.lpErrorState.cards||k.A.setCardErrorState(f.O4.TIMEOUT),k.A.lpErrorState.goals||k.A.setGoalErrorState(f.O4.TIMEOUT))}fetchLPCardsOffline(){const e=s.Ay.sessionID,t=s.Ay.genAISessionId;(0,d.A_)(t,"offline",e,this.goalStreamingCallback,!1),(0,d.nH)(s.Ay.sessionID,"offline")}lpCards(){return k.A.getlpCards()}get expandedLPCard(){return k.A.expandedLPCard}get isOnboardingInProgress(){return k.A.isOnboardingInProgress}setIsOnboardingInProgress(e){k.A.setIsOnboardingInProgress(e)}checkAndStartOnboarding(e){return __awaiter(this,void 0,void 0,(function*(){return e<LPController.NUM_TIMES_TO_SHOW_OB&&!l.A.areAllSourcesImported()&&(!k.A.isOnboardingInProgress&&s.Ay.isNewCollection&&(this.setIsOnboardingInProgress(!0),(0,c.h6)()),!0)}))}get lpErrorState(){return k.A.lpErrorState}setLPRefreshHeaderType(e){k.A.setLPRefreshHeaderType(e)}get lpRefreshHeaderType(){return k.A.lpRefreshHeaderType}handleNetwork(e){e||(k.A.lpErrorState.cards.errorCode=0===this.lpCards().length?f.O4.NETWORK_ERROR:null,k.A.lpErrorState.goals.errorCode=0===this.getGoals().length?f.O4.NETWORK_ERROR:null)}setLastHoveredLpCardId(e){k.A.setLastHoveredLpCardIdAction(e)}updateActiveLPCard(){k.A.setActiveLPCardFromHover()}scrollToActiveCard(){-1===k.A.activeLPCard||this.expandedLPCard||setTimeout((()=>{var e;null===(e=document.getElementById(`lp-card-${k.A.activeLPCard}`))||void 0===e||e.scrollIntoView({inline:"center",behavior:"smooth"}),(0,O.HY)(P.A.kInvalidateAttributionMenu)}),10)}refreshLPCardForCustomAgentHelper(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return __awaiter(this,void 0,void 0,(function*(){this.isCutomAgentUpdating||(0,d.np)(s.Ay.sessionID,this.goalStreamingCallback);const t="online";e||(s.Ay.isNewCollection?(0,d.nH)(s.Ay.sessionID,t,!this.isCutomAgentUpdating):((0,d.vc)(this.goalStorageCallback),yield(0,d.nH)(s.Ay.sessionID,t,!this.isCutomAgentUpdating)));const o=!1;if(l.A.areAllSourcesImported()){this.analyticsStore.LPRefreshForCustomAgentFirstInitTime=Date.now(),this.analyticsStore.LPRefreshForCustomAgentLastInitTime=Date.now(),this.analyticsStore.LPRefreshForCustomAgentFirstStreamLogged=!1,this.analyticsStore.LPRefreshForCustomAgentLastStreamLogged=!1;const e=s.Ay.genAISessionId,i=s.Ay.sessionID;(0,d.dU)(e,t,i,this.lpCardMetadataCallback,this.lpStreamingCallback,o,!0,!0),s.Ay.isCuratedCollection||(0,d.A_)(e,t,i,this.goalStreamingCallback,o,!0,!0),this.mGoalsRequestedTime=Date.now()}else this.fetchLPRequested={isRequested:!0,background:o}}))}updateLPStreamContentToCache(e,t){return __awaiter(this,void 0,void 0,(function*(){const o={ERR_CODE:I.dE.NO_ERROR,responseCode:200,content:t.cardMarkup,eTag:""},i=yield g.Ay.getKWCacheNativeAPI();if(null==i||i.WriteResourceDataToCache(s.Ay.sessionID,o,g.p3.KWCollectionLPCard,e),3===k.A.lpCardsUpdatedToCacheCount){let e;e=setInterval((()=>__awaiter(this,void 0,void 0,(function*(){const t=yield(0,d.zP)(s.Ay.sessionID,"lp_card");(Array.isArray(t)||t.ERR_CODE===I.dE.NO_ERROR&&t.children.length>0)&&clearInterval(e)}))),15e3),k.A.lpCardsUpdatedToCacheCount=0}else k.A.lpCardsUpdatedToCacheCount+=1}))}get shouldWaitForLPStream(){return k.A.shouldWaitForLPStream}setIsAttributionMenuInteractionActive(e){k.A.setIsAttributionMenuInteractionActive(e)}get isAttributionMenuInteractionActive(){return k.A.isAttributionMenuInteractionActive}get activeAttributionSourceId(){return k.A.activeAttributionSourceId}setActiveAttributionSourceId(e){k.A.setActiveAttributionSourceId(e)}LogCarouselCardsScrolled(){this.scrollDebounceTimeout&&clearTimeout(this.scrollDebounceTimeout),this.scrollDebounceTimeout=setTimeout((()=>{(0,A.mB)(m.p1,m.Yt),this.scrollDebounceTimeout=null}),1e3)}handleCardContentScroll(e){var t;this.cardContentscrollDebounceTimeout||((0,A.mB)(m.dO,(null===(t=e.noteIdFull)||void 0===t?void 0:t.length)?e.noteIdFull:m.uT),this.cardContentscrollDebounceTimeout=setTimeout((()=>{this.cardContentscrollDebounceTimeout=null}),1e3))}}LPController.NUM_TIMES_TO_SHOW_OB=Number.MAX_SAFE_INTEGER;const U=new LPController},S3kN:(e,t,o)=>{"use strict";o.d(t,{A:()=>H});var s=o("2Wlf"),i=o("EQIZ"),n=o("PBXi"),r=o("0VNB"),a=o("iEHP"),d=o("h9J0"),l=o("eOjs"),c=o("QLQe"),u=o("m1+/");function LogQnAPerfAnalytics(e,t,o){const s=`${l.Xp}_ ${u.A.lastQnAInvocationPoint}_${e}${o?"_FirstToken":"_LastToken"}`;(0,c.mB)(s,(0,d.A)(Date.now()-t))}var h,A=o("xYLj"),m=o("Jjq2"),p=o("CVnK"),g=o("oFBY"),C=o("mVLN"),v=o("bV+/"),f=o("C/hT"),E=o("mixQ"),S=o("U5BB"),I=o("oYND"),y=o("+7jM"),N=o("uy9O"),R=o("vDg+");!function(e){e.NONE="NONE",e.DEFAULT="DEFAULT",e.ANONYMOUS_INFORM="ANONYMOUS_INFORM",e.PHASE1_INDIVIDUAL="PHASE1_INDIVIDUAL",e.PHASE1_TEAM="PHASE1_TEAM",e.PHASE1_HYBRID_ADMIN="PHASE1_HYBRID_ADMIN",e.PHASE2_INDIVIDUAL="PHASE2_INDIVIDUAL",e.PHASE2_TEAM="PHASE2_TEAM",e.PHASE2_HYBRID_ADMIN="PHASE2_HYBRID_ADMIN",e.PHASE3_INDIVIDUAL="PHASE3_INDIVIDUAL",e.PHASE3_TEAM="PHASE3_TEAM",e.PHASE3_HYBRID_ADMIN="PHASE3_HYBRID_ADMIN"}(h||(h={}));const _=h;var k=o("XiVx"),L=o("v52D"),O=o("VrJP"),P=o("HmZB"),D=o("iBnc"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};new class UpsellController{getUpsellBannerType(e){const t=k.A.info,o=k.A.status,s=k.A.monetPhases;if(o===k.m.NotInitialized||o===k.m.InProgress)return _.NONE;if(o===k.m.Error)return _.NONE;if(!t)return _.NONE;const{userInfo:i,provisioningInfo:n,subscriptionLevel:r}=t;if(console.log("Provisioning details:",{userInfo:i,provisioningInfo:n}),void 0===(null==s?void 0:s.KWMonetConsumptionPhaseVal))return _.NONE;if("PAID"===r)return _.NONE;const a=s.KWMonetConsumptionPhaseVal,d=e===P.A.TEAMS_ADMIN,l=e===P.A.TEAMS_END_USER,c=(null==i?void 0:i.customerType)===P.A.INDIVIDUAL_USER&&!d;if(a===L.v.PHASE1){if(c)return _.PHASE1_INDIVIDUAL;if(l)return _.PHASE1_TEAM;if(d)return _.PHASE1_HYBRID_ADMIN}if(a===L.v.PHASE2){if(c)return _.PHASE2_INDIVIDUAL;if(l)return _.PHASE2_TEAM;if(d)return _.PHASE2_HYBRID_ADMIN}if(a===L.v.PHASE3){if(c)return _.PHASE3_INDIVIDUAL;if(l)return _.PHASE3_TEAM;if(d)return _.PHASE3_HYBRID_ADMIN}return _.DEFAULT}openSubscriptionPage(e){return __awaiter(this,void 0,void 0,(function*(){console.log(`[KW] Opening subscription page from ${e}`);try{O.A.handleSubscriptionAction(D.R.CHAT,D.Q.CHAT_BANNER)}catch(e){console.error("[KW] Error opening subscription page",e)}}))}};o("DHl7");var T=o("cBgH"),b=o("JvqQ"),w=o("+I5k"),U=o("wh8g"),F=o("bTOH"),QnAController_awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};class QnAController extends u.T{constructor(){super(),this.chatSessionID="",this.chatHistoryEventsUri="",this.mShouldScrollToEnd=!1,this.mQuestionAskedTime=0,this.mCompletedResponseCount=0,this.askedQuestionInQueue=[],this.mActiveAttributionProps={answerPartID:"",showMenu:!1},this.showChatViewNativeNotification=()=>{this.shouldScrollToEnd=!0,i.A.setViewType(R.A.ChatView),g.A.getLhpViewState()===C.vU.FULL_SCREEN&&g.A.setLhpViewState(C.vU.EXPANDED)},this.getQuestionAskedStateInSession=()=>E.A.QuestionsAskedStateInSession,this.getActiveAttributionProps=()=>this.mActiveAttributionProps,this.setActiveAttributionProps=(e,t)=>{this.mActiveAttributionProps={answerPartID:e,showMenu:t}},this.qnaStreamingCallback=e=>{var t;const{response:o,transactionId:s}=e;let i="",n="";const r=[],a=[];let d=!1;const l=o;if((0,m.a8)(m.bi.ThoughtPartner,m.Hc.QnA,`Streaming Callback data received of size: ${l.length}`),l.length<=0)return;l.forEach((e=>{var t;try{const o=e;if(void 0!==o)if("metadata"===o.type)i=o.question_id;else if("answer"===o.type&&"answer"in o&&"string"==typeof o.answer){""===i&&(i=o.question_id),n+=o.answer;const e={id:o.part_id,text:o.answer,hasSources:!1};r.push(e)}else if("sources"===o.type&&"sources"in o)""===i&&(i=o.question_id),null===(t=o.sources)||void 0===t||t.forEach((e=>{const t={index:0,sourceID:e.source_id,answerPartID:e.part_id,text:e.text,docID:e.doc_id,bounds:e.bounds};a.push(t)}));else if("end_of_answer"===o.type)""===i&&(i=o.question_id),d=!0,(0,m.a8)(m.bi.ThoughtPartner,m.Hc.QnA,`Streaming Callback end of answer received for question ID: ${i}`);else if("error"===o.ERR)return""===i&&(i=o.id),void this.handleQnAError(o)}catch(t){(0,m.qz)(m.bi.ThoughtPartner,m.Hc.QnA,`"Unable to parse QnA output: ", ${e}`)}})),console.log("QnA Streaming Callback: ",i,n,r,a,d);const c="start_of_answer"===(null===(t=l[0])||void 0===t?void 0:t.type);this.updateQnAResponse(i,n,r,a,d,s,c)},this.IsCurrentAnswerPending=()=>E.A.IsCurrentAnswerPending,this.onAskQuestion=e=>{0!==e.trim().length&&this.askQuestion(e)},this.updateAnswerState=(e,t)=>E.A.updateAnswerState(e,t),this.updateErrorState=(e,t)=>E.A.updateErrorState(e,t),this.onStopAnswer=()=>{const e=this.getQnARecords(),t=e[e.length-1];(null==t?void 0:t.transactionId)&&(0,U.MB)(F.Od.QuestionAnswer,t.transactionId,s.Ay.senseiServiceBaseUri).then((e=>{(0,m.a8)(m.bi.ThoughtPartner,m.Hc.QnA,`TPCancelRequest response: ${e}`)})).catch((e=>{(0,m.qz)(m.bi.ThoughtPartner,m.Hc.QnA,`Error cancelling request: ${e}`)})),0===t.answer.length?(E.A.removeQnARecord(t.id),this.askedQuestionInQueue=[]):this.IsCurrentAnswerPending()&&this.updateAnswerState(t.id,n.qi.kCancelled)},this.lastAskedQuestion=()=>{const e=this.getQnARecords();return e.length>0?e[e.length-1]:void 0},this.handleQnAError=e=>{const{ERR_MSG:t,qId:o,tId:s}=e;let i=null;if(o&&""!==o&&(i=this.getQnARecordByID(o)),!i&&s&&""!==s){i=this.getQnARecords().find((e=>e.transactionId===s))}i&&null===i.error&&(E.A.updateErrorState(i.id,(0,A.kx)(t)),E.A.updateAnswerState(i.id,n.qi.kCompleted))},this.setAskedQuestionPrompt=e=>{E.A.setAskedQuestionPrompt(e)},this.chatHistoryStreamingCallback=e=>QnAController_awaiter(this,void 0,void 0,(function*(){var t,o,i;const{response:r}=e,a=r;if(Array.isArray(a)&&a[0].length<=0)return;(0,m.a8)(m.bi.ThoughtPartner,m.Hc.ChatHistory,`"Chat History Streaming Callback data received of size: ", ${a[0].length}`);const d=this.getQnARecords();if(!(!0===a[1]))return d.unshift(...a[0]),E.A.updateChatHistoryState(n.oE.kRestoredFromCache),void(0,m.N7)(m.bi.ThoughtPartner,m.Hc.ChatHistory,"state updated to kRestoredFromCache");let u=[];const h=this.lastAskedQuestion();h&&h.answerState!==n.qi.kCompleted&&(u=d.slice(d.length-1));const A=[];a[0].forEach((e=>{var t,o,s;if(e.body&&e.body.eventType&&"ANSWERED_QUESTION"===e.body.eventType){const i={id:e.body.question.id,question:e.body.question.text,answer:"",answerParts:[],attributions:[],loading:!1,error:null,answerState:n.qi.kCompleted,questionType:"USER"===e.body.question.type?n.Zv.USER_ENTERED:n.Zv.GOAL_RECOMMENDATIONS,timestamp:e.body.timestamp};null===(t=e.body.answerParts)||void 0===t||t.forEach((e=>{const t={id:e.id,text:e.text,hasSources:!1};i.answer+=t.text,i.answerParts.push(t)}));const r=new Map;null===(o=e.body.attributions)||void 0===o||o.forEach((e=>{r.has(e.id)||r.set(e.id,r.size+1)})),null===(s=e.body.attributions)||void 0===s||s.forEach((e=>{var t;const o={index:r.get(e.id)||0,sourceID:e.id,answerPartID:e.partId,text:e.text,docID:e.asset.docId,bounds:e.bounds};i.attributions.push(o);const s=null===(t=i.answerParts)||void 0===t?void 0:t.find((e=>e.id===o.answerPartID));s&&!s.hasSources&&(s.hasSources=!0)})),i.answer=i.answerParts.reduce(((e,t)=>e+t.text+(t.hasSources?` *AttributionBtn_${t.id}*`:"")),""),A.unshift(i)}})),E.A.resetChat([...A,...u]);const g=yield f.Ay.getKWCacheNativeAPI();(null===(o=null===(t=E.A.currentChat)||void 0===t?void 0:t.qnaRecords)||void 0===o?void 0:o.length)>0?null==g||g.WriteResourceDataToCache(s.Ay.sessionID,(0,p.HO)(null===(i=E.A.currentChat)||void 0===i?void 0:i.qnaRecords),f.p3.KWCollectionChat,this.chatSessionID,""):null==g||g.removeDataFromCache(s.Ay.sessionID,f.p3.KWCollectionChat,this.chatSessionID),E.A.updateChatHistoryState(n.oE.kRestoredFromService),(0,m.N7)(m.bi.ThoughtPartner,m.Hc.ChatHistory,"state updated to kRestoredFromService"),(0,c.mB)(l.Ct,l.cu)})),this.onStopInputAction=()=>{if(this.IsCurrentAnswerPending()){const e=this.lastAskedQuestion();e&&0===this.askedQuestionPrompt.length&&this.setAskedQuestionPrompt(e.question)}this.onStopAnswer()},this.onSendInputAction=()=>{this.IsCurrentAnswerPending()||((0,c.mB)(l.Ct,l.Kz),this.onAskQuestion(this.askedQuestionPrompt),this.setAskedQuestionPrompt(""))},(0,p.Gn)(this,{mActiveAttributionProps:p.sH,setActiveAttributionProps:p.XI}),(0,p.fm)((()=>{E.A.isIngestionPending||this.askedQuestionInQueue.length>0&&(this.askedQuestionInQueue.forEach((e=>{var t;(0,a.Fd)(s.Ay.sessionID,this.chatSessionID,e.question,null!==(t=e.id)&&void 0!==t?t:"",this.qnaStreamingCallback)})),this.mQuestionAskedTime=Date.now(),this.askedQuestionInQueue=[])})),this.init()}init(){S.A.listenForCustomEvent(I.A.SHOW_CHAT_VIEW,this.showChatViewNativeNotification)}getQnARecords(){return E.A.currentChat.qnaRecords}hasQnARecords(){return this.getQnARecords().length>0}get containerRef(){return this.mContainerRef}set containerRef(e){this.mContainerRef=e}get shouldScrollToEnd(){return this.mShouldScrollToEnd}set shouldScrollToEnd(e){this.mShouldScrollToEnd=e}getResponseString(e){const t=this.getQnARecords(),o=null==t?void 0:t.find((t=>t.id===e));return o?o.answerParts.reduce(((e,t)=>e+t.text),""):""}shouldShowAttributions(){return E.A.shouldShowAttributions}showAttributions(e){E.A.showAttributions(e)}recomputeAnswerString(e){E.A.recomputeAnswerString(e)}highlightAnswerPart(e,t){E.A.highlightAnswerPart(e,t)}get isIngestionPending(){return E.A.isIngestionPending}confirmClearChat(){return QnAController_awaiter(this,void 0,void 0,(function*(){const e=yield(0,v.Rt)();if((0,c.mB)(l.xu,e.data?l.U_:l.Qq),e.data){""===this.chatSessionID&&([this.chatSessionID,this.chatHistoryEventsUri]=yield(0,a.fk)(s.Ay.sessionID)),E.A.deleteChatHistory(),y.A.addUpdates(s.Ay.sessionID,N.t.kAssetClearHighlight,{}),(0,a.mo)(s.Ay.sessionID,this.chatSessionID);(yield f.Ay.getKWCacheNativeAPI()).removeDataFromCache(s.Ay.sessionID,f.p3.KWCollectionChat),this.chatSessionID="",this.chatHistoryEventsUri="",(0,m.a8)(m.bi.ThoughtPartner,m.Hc.ChatHistory,"Chat history deleted by user")}}))}updateQnAResponse(e,t,o,s,i,r,a){var d;const l=this.getQnARecords();let c=null==l?void 0:l.find((t=>t.id===e));(null==c?void 0:c.answerState)===n.qi.kCompleted&&Array.from(w.A.goalIDMap.values()).find((e=>e===(null==c?void 0:c.id)))&&(c=void 0),!c&&r&&(c=null==l?void 0:l.find((e=>e.transactionId===r))),c&&c.answerParts.length<=0&&""===c.answer&&a&&LogQnAPerfAnalytics(c.questionType,this.mQuestionAskedTime,!0),c&&i&&(LogQnAPerfAnalytics(c.questionType,this.mQuestionAskedTime,!1),T.A.isCollabSessionInfoUpdated&&!(0,b.sO)()&&this.mCompletedResponseCount<2&&(this.mCompletedResponseCount+=1,2===this.mCompletedResponseCount&&document.dispatchEvent(new CustomEvent("copyAnswer",{detail:{qnaId:e,copySource:"QnAResponse"}})))),E.A.updateQnAResponse(null!==(d=null==c?void 0:c.id)&&void 0!==d?d:e,t,o,s,i)}getQuestionTypeForChatResponse(e){switch(e){case n.Zv.GOAL_RECOMMENDATIONS:case n.Zv.LP_CARD:return e;default:return}}askQuestion(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Zv.USER_ENTERED,o=arguments.length>2?arguments[2]:void 0;return QnAController_awaiter(this,void 0,void 0,(function*(){if(!(yield new Promise((e=>{const handleJITResult=t=>{var o,s;S.A.unListenForCustomEvent(I.A.KW_JIT_CLOSED_CALLBACK,handleJITResult);try{const i=null===(s=null===(o=null==t?void 0:t.detail)||void 0===o?void 0:o.params)||void 0===s?void 0:s.jitSuccess;e(i)}catch(t){e(!1)}};S.A.listenForCustomEvent(I.A.KW_JIT_CLOSED_CALLBACK,handleJITResult),(0,v.Ny)()}))))return;this.getQuestionAskedStateInSession()===n.ao.NoQuestionAskedInSession?E.A.setQuestionsAskedStateInSession(n.ao.FirstQuestionAskedInSession):this.getQuestionAskedStateInSession()===n.ao.FirstQuestionAskedInSession&&E.A.setQuestionsAskedStateInSession(n.ao.SecondQuestionAskedInSession);const d={id:(0,r.v4)(),question:e,answer:"",answerParts:[],attributions:[],loading:!0,answerState:n.qi.kInprogress,questionType:t,error:null};E.A.addQnARecord(d),i.A.shouldShowChatView||i.A.setViewType(R.A.ChatView);const l=s.Ay.sessionID;""===this.chatSessionID&&([this.chatSessionID,this.chatHistoryEventsUri]=yield(0,a.fk)(l),E.A.currentChat.chatSessionID=this.chatSessionID),this.setAskedQuestionPrompt(""),E.A.isIngestionPending?this.askedQuestionInQueue.push(d):setTimeout((()=>{var e;(0,a.Fd)(s.Ay.sessionID,this.chatSessionID,d.question,null!==(e=d.id)&&void 0!==e?e:"",this.qnaStreamingCallback,this.getQuestionTypeForChatResponse(d.questionType),o),this.mQuestionAskedTime=Date.now()}),10),setTimeout((()=>{""===d.answer&&(this.updateErrorState(d.id,A.O4.TIMEOUT),this.askedQuestionInQueue=this.askedQuestionInQueue.filter((e=>e.id!==d.id)))}),3e5)}))}get askedQuestionPrompt(){return E.A.askedQuestionPrompt}getQnARecordByID(e){return this.getQnARecords().find((t=>t.id===e))}removeErroredQnARecords(){const e=this.getQnARecords();E.A.currentChat.qnaRecords=e.filter((e=>null===e.error||e.error===A.O4.NO_ERROR))}get questionAskedTime(){return this.mQuestionAskedTime}set questionAskedTime(e){this.mQuestionAskedTime=e}get chatHistoryState(){return E.A.chatHistoryState}fetchConversationHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"online";return QnAController_awaiter(this,void 0,void 0,(function*(){""===this.chatSessionID&&([this.chatSessionID,this.chatHistoryEventsUri]=yield(0,a.fk)(s.Ay.sessionID),E.A.currentChat.chatSessionID=this.chatSessionID),""!==this.chatHistoryEventsUri?((0,a.jC)(s.Ay.sessionID,this.chatSessionID,this.chatHistoryEventsUri,e,this.chatHistoryStreamingCallback),E.A.updateChatHistoryState(n.oE.kRequested),(0,m.N7)(m.bi.ThoughtPartner,m.Hc.ChatHistory,"state updated to kRequested")):(E.A.updateChatHistoryState(n.oE.kDoesNotExist),(0,m.N7)(m.bi.ThoughtPartner,m.Hc.ChatHistory,"state updated to kDoesNotExist"))}))}set questionInputContainerRef(e){E.A.inputContainerRef=e}get questionInputContainerRef(){return E.A.inputContainerRef}}const H=new QnAController},"m1+/":(e,t,o)=>{"use strict";o.d(t,{T:()=>TPController,A:()=>c});var s=o("bV+/"),i=o("EQIZ"),n=o("mVLN"),r=o("vDg+"),a=o("eOjs"),d=o("86lk");var l=o("QLQe");class TPController{constructor(){this.lastQnAInvocationPoint=r.A.None,this.init()}init(){}setIntl(e){this.intlContext=e}shouldShowLandingPage(){return i.A.shouldShowLandingPage}switchToLandingPage(){return i.A.setViewType(r.A.LPView)}shouldShowChatView(){return i.A.shouldShowChatView}switchToChatView(){return i.A.setViewType(r.A.ChatView)}showSourcesUpdatedToast(e){if(this.intlContext){let t="";if(0===e)return;const o=this.intlContext.formatPlural(e);e>0?t=this.intlContext.formatMessage({id:`lp.refresh.toast.asset.added.${o}`}):e<0&&(t=this.intlContext.formatMessage({id:`lp.refresh.toast.asset.removed.${o}`}));const i={type:n.O.kPositive,timeout:5,position:n.Xu.kBottomRight,message:t};(0,s.Vf)(i)}}setInvocationAndlogQuestionAskedAnalytics(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.lastQnAInvocationPoint=i.A.getViewType(),e&&(0,l.mB)(r.A.ChatView===i.A.getViewType()?a.Ct:d.vp,"Question_Asked")}}const c=new TPController},"5XXy":(e,t,o)=>{"use strict";o.d(t,{du:()=>CanCreateCollection,DW:()=>initKWSession,sF:()=>isHighContrastMode,nh:()=>showFTERecipientOnboarding});var s=o("plsW"),i=o("stSR"),n=o("9oid"),r=o("y4dE"),a=o("jpy3"),d=o("2Wlf"),l=o("zfUP"),c=o("+7jM"),u=o("tT5Q"),h=o("AYpf"),A=o("2NhI"),m=o("cBgH"),p=o("bV+/"),g=o("U5BB"),C=o("oYND"),v=o("UQd+"),f=o("sVfd"),E=o("eJZf"),S=o("uy9O"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const I=new class CollabController{constructor(){this.IsSignedIn=()=>__awaiter(this,void 0,void 0,(function*(){const e=yield s.providers["native-api"]();return(yield e.SessionAPI()).isSignedIn()})),g.A.listenForCustomEvent(C.A.OWNER_AVATAR_UPDATE_NOTIF,this.updateOwnerAvatar.bind(this))}init(){}updateOwnerAvatar(e){var t;return __awaiter(this,void 0,void 0,(function*(){const o=null==e?void 0:e.detail;v.A.fetchBinaryBlob(null===(t=null==o?void 0:o.params)||void 0===t?void 0:t.url).then((e=>{m.A.setOwnerAvatarUrl(URL.createObjectURL(e))}))}))}updateCollabSessionInfo(e,t,o,i,n,r){return __awaiter(this,void 0,void 0,(function*(){if(""!==e)if(m.A.collabInfo.userRole===A.Z.kUndefined)yield Promise.all([this.getSharingConfig(e,r),this.getcollaborators(e)]),r&&d.Ay.userRole===A.Z.kOwner&&E.A.fetchCustomAgents();else{const a=yield s.providers["native-api"](),u=yield a.SessionAPI(),p=yield u.GetUserId(),g={[h.G.kAdobeID]:p,[h.G.kRoleKey]:(0,l.A)(t),[h.G.kCanShareKey]:o,[h.G.kCanCommentKey]:i};m.A.setSharedCustomMessage(n),d.Ay.userRole=(0,l.A)(t),d.Ay.userRole===A.Z.kOwner?(c.A.addUpdates(d.Ay.sessionID,h.G.kUpdated,g),r&&E.A.fetchCustomAgents()):r&&(d.Ay.isCuratedCollection?E.A.refreshCustomAgentsOnONS():E.A.updateRecipientCustomAgent(d.Ay.recipientCustomAgentType)),m.A.setCollabSessionInfoUpdated(!0),yield this.getcollaborators(e)}}))}getSharingConfig(e,t){var o;return __awaiter(this,void 0,void 0,(function*(){const i=yield s.providers["native-api"](),u=yield i.SessionAPI(),p=new n.A(e,t),g=yield r.A.ExecuteKWCommand(p);if(g.ERR_CODE===a.dE.NO_ERROR){const e=(0,l.A)(g.role);d.Ay.userRole=e,m.A.setCollabInfo({sharedCustomMessage:null!==(o=g.custom_message)&&void 0!==o?o:"",ownerName:"",ownerId:""}),m.A.setCanComment(g.can_comment),m.A.setCanShare(g.can_share);if(yield this.IsSignedIn()){const t=yield u.GetUserId(),o={[h.G.kAdobeID]:t,[h.G.kRoleKey]:e,[h.G.kCanShareKey]:g.can_share,[h.G.kCanCommentKey]:g.can_comment};e===A.Z.kOwner&&c.A.addUpdates(d.Ay.sessionID,h.G.kUpdated,o)}if(e!==A.Z.kOwner&&t){d.Ay.isReadFromCache=!1,g.custom_agent&&g.custom_agent.id&&g.custom_agent.type?(d.Ay.recipientCustomAgentID=g.custom_agent.id,d.Ay.recipientCustomAgentType=g.custom_agent.type):(d.Ay.recipientCustomAgentID="",d.Ay.recipientCustomAgentType=""),E.A.updateRecipientCustomAgent(d.Ay.recipientCustomAgentType);const e={[S.X.kCustomAgentID]:d.Ay.recipientCustomAgentID,[S.X.kTypeKey]:d.Ay.recipientCustomAgentType};c.A.addUpdates(d.Ay.sessionID,S.X.kRecipientUpdated,e)}m.A.setCollabSessionInfoUpdated(!0)}}))}ProcessCollaboratorsResponse(e,t,o){e.ERR_CODE===a.dE.NO_ERROR&&(null==o||o.collaborators.forEach((o=>{if(!e.collaborators.some((e=>e.id===o.id))&&t){const e={[h.G.kAdobeID]:o.id};c.A.addUpdates(t,h.G.kRemoved,e)}})),e.collaborators.forEach((e=>{const t={[h.G.kAdobeID]:e.id,[h.G.kRoleKey]:(0,l.A)(e.role),[h.G.kCanShareKey]:e.can_share,[h.G.kCanCommentKey]:e.can_comment,[h.G.kEmailKey]:e.email,[h.G.kNameKey]:e.display_name};(0,l.A)(e.role)===A.Z.kOwner&&m.A.setCollabInfo(Object.assign(Object.assign({},m.A.collabInfo),{ownerName:e.display_name||e.email||"",ownerId:e.id})),c.A.addUpdates(d.Ay.sessionID,h.G.kRefreshed,t)})))}getcollaborators(e){return __awaiter(this,void 0,void 0,(function*(){const t=new u.A(e,!0),o=yield r.A.ExecuteKWCommand(t);if(Array.isArray(o)){const[t,s]=o;this.ProcessCollaboratorsResponse(t),yield this.fetchAndSetDefaultAvatar(),(0,p.dl)(m.A.collabInfo.ownerId),s.then((o=>{(0,f.th)(`Asset list fetched from network: ${o}`),this.ProcessCollaboratorsResponse(o,e,t)}))}else this.ProcessCollaboratorsResponse(o),yield this.fetchAndSetDefaultAvatar(),(0,p.dl)(m.A.collabInfo.ownerId)}))}fetchAndSetDefaultAvatar(){return __awaiter(this,void 0,void 0,(function*(){const e=yield(0,p.tw)();if((null==e?void 0:e.data)&&e.data.length>0){const t=yield v.A.fetchBinaryBlob(e.data);m.A.setOwnerAvatarUrl(URL.createObjectURL(t))}}))}};var y=o("GTxN"),N=o("C/hT"),R=o("bTOH"),_=o("mixQ"),k=o("mVLN"),L=o("CVnK"),O=o("qii3"),IngestionController_awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const P="done",D="in_progress",T="failed";const b=new class IngestionController{constructor(){this.intervalMs=2e3,this.timeoutMs=66e4,this.cache=null,this.pollerStatus=!1,this.init(),(0,L.mJ)((()=>d.te.importedSources),((e,t)=>IngestionController_awaiter(this,void 0,void 0,(function*(){const[o,s]=yield(0,R.kT)();if(o&&!s)return;if(0===e.length)return;const i=new Set(t.map((e=>e.id))||[]),n=e.filter((e=>!i.has(e.id)));n.length>0&&setTimeout((()=>IngestionController_awaiter(this,void 0,void 0,(function*(){const e=n.map((e=>IngestionController_awaiter(this,void 0,void 0,(function*(){try{yield this.initiateSourceIngestion(d.Ay.sessionID,e.id),(0,L.h5)((()=>d.te.updateIngestionStatus(e.id,P)))}catch(t){const o=t.assetId||e.id;console.error(`Error while ingesting source ${o}:`,t),(0,L.h5)((()=>d.te.updateIngestionStatus(e.id,P,t.message))),(0,L.h5)((()=>d.te.updateErrorStatus(e.id,k.by.kIngestionFailed)))}}))));yield Promise.all(e)}))),1e3)}))))}init(){}getSourcesLinkedToCollection(e){return IngestionController_awaiter(this,void 0,void 0,(function*(){const t=new O.A(d.Ay.sessionServiceV2BaseUri,e),o=yield r.A.ExecuteKWCommand(t);return o.ERR_CODE===a.dE.NO_ERROR?o.data.map((e=>{var t;return{docId:e.doc_id,status:e.status,details:{ingestionStatus:{extractStatus:e.details.extract_status,embeddingsIndexingStatus:e.details.embeddings_indexing_status,docOverviewStatus:e.details.doc_overview_status,markdownStatus:e.details.markdown_status}},error:null===(t=e.details)||void 0===t?void 0:t.error}})):[]}))}pollIngestionStatus(e){let t,o;this.pollerStatus=!0,_.A.updateIngestionPollerStatus(!0);const clearTimeoutAndInterval=()=>{clearInterval(o),clearTimeout(t)};return new Promise(((s,i)=>{t=setTimeout((()=>{_.A.updateIngestionPollerStatus(!1),clearInterval(o),i(Object.assign(new Error("Ingestion polling timed out")))}),this.timeoutMs),o=setInterval((()=>IngestionController_awaiter(this,void 0,void 0,(function*(){try{console.log("Polling ingestion status..."),this.cache=this.getSourcesLinkedToCollection(e);const t=yield this.cache,o=t.some((e=>e.status===D));(t.length>0&&!o||0===d.te.importedSources.length)&&(this.pollerStatus=!1,_.A.updateIngestionPollerStatus(!1),clearTimeoutAndInterval(),s())}catch(e){this.pollerStatus=!1,_.A.updateIngestionPollerStatus(!1),clearTimeoutAndInterval(),i(e)}}))),this.intervalMs)}))}populateCacheAndStartPolling(e){this.cache||(this.cache=this.getSourcesLinkedToCollection(e),setTimeout((()=>{this.pollIngestionStatus(e)}),this.intervalMs))}initiateSourceIngestion(e,t,o){return IngestionController_awaiter(this,void 0,void 0,(function*(){let s,i,n=0;const[r,a]=yield(0,R.kT)();if(r&&!a)return Promise.resolve();if(this.cache){(yield this.cache).find((e=>e.docId===t))||this.pollerStatus||(this.cache=null)}this.populateCacheAndStartPolling(e);const clearTimeoutAndInterval=()=>{clearInterval(s),clearTimeout(i)};return new Promise(((e,r)=>IngestionController_awaiter(this,void 0,void 0,(function*(){i=setTimeout((()=>IngestionController_awaiter(this,void 0,void 0,(function*(){const[o,i]=yield(0,R.kT)();clearInterval(s),!o||i?r(Object.assign(new Error("TIMEOUT"),{assetId:t})):e()}))),this.timeoutMs),s=setInterval((()=>IngestionController_awaiter(this,void 0,void 0,(function*(){var s,i;try{const a=yield this.cache,d=null==a?void 0:a.find((e=>e.docId===t));if(!d){if(n+=1,yield new Promise((e=>{setTimeout(e,1e4)})),n>10){clearTimeoutAndInterval();const[o,s]=yield(0,R.kT)();if(o&&!s)return void e();r(Object.assign(new Error("TIMEOUT"),{assetId:t}))}return}(o||d.status===P)&&(clearTimeoutAndInterval(),e()),d.status===T&&(clearTimeoutAndInterval(),r(Object.assign(new Error(null!==(i=null===(s=d.error)||void 0===s?void 0:s.code)&&void 0!==i?i:"UNKNOWN_ERROR"),{assetId:t})))}catch(e){clearTimeoutAndInterval(),r(e)}}))),this.intervalMs)}))))}))}};var w=o("WveF"),U=o("S3kN"),F=o("+I5k"),H=o("oFBY"),M=o("DHl7"),B=o("JvqQ"),W=o("Jjq2"),CommonUtils_awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const initKWSession=e=>{const{kwcId:t,kwcName:o,kwcGoal:s,kwcDesc:n,kwcCreateLongNote:r,kwcUpdateLongNote:a,kwcDownloadLongNote:u,kwcIsNewCollection:h,kwcNumTimesKwOnboardingShown:g,kwcEnableShareAssetOutsideCollection:C,kwcUserRole:v,kwcCanUserShare:f,kwcCanUserComment:S,kwcSenderCustomMessage:_,kwcUseCustomAgent:k,kwcDefaultSelectedTab:L,kwcProvisionInfo:O,kwcMonetPhasesFlag:P,kwcEnableReportAbuse:D,kwcEnableDownloadAsPdf:T,kwcIsCuratedCollection:B,kwcIsKWCreationEnabled:W,kwcIsPresentInCache:x,kwcIsChatInCache:K,kwcIsCalledFromVerifyOpen:Q,kwcIsReadFromCache:G,kwcRecipientCustomAgentID:V,kwcRecipientCustomAgentType:q}=e;(0,p.Co)(),c.A.init();(0,w.A)()&&b.init(),(h||(0,l.A)(v)===A.Z.kOwner)&&(d.Ay.userRole=A.Z.kOwner,m.A.setCollabSessionInfoUpdated(!0)),O&&M.A.setProvisioningInfoFromNative(O),CommonUtils_awaiter(void 0,void 0,void 0,(function*(){yield y.A.updateSessionInfo(t,o,s,n,r,a,u,h,C,v,f,S,_,k,D,T,B,W,x,K,Q,G,V,q),yield(0,N.Bm)();const[e,d]=yield(0,R.kT)();if(e&&!d)i.A.fetchNotes(),F.A.fetchLPCardsOffline(),U.A.fetchConversationHistory("offline");else{let e=!1;k&&!h&&(0,l.A)(v)!==A.Z.kOwner&&(e=!0),I.updateCollabSessionInfo(t,v,f,S,_,e),k&&(e||(B?E.A.refreshCustomAgentsOnONS():E.A.fetchCustomAgents())),i.A.fetchNotes(),P&&M.A.setMonetPhasesFlagFromNative(P),K?(F.A.fetchLPCards(),yield U.A.fetchConversationHistory()):(U.A.fetchConversationHistory(),yield F.A.fetchLPCards()),yield CommonUtils_awaiter(void 0,void 0,void 0,(function*(){const e=new Promise(((e,t)=>{setTimeout((()=>{t(new Error("Low priority tasks timed out"))}),100)}));try{yield Promise.race([M.A.updateProvisioningStatus(),e])}catch(e){console.warn("Low priority tasks timed out:",e)}}))}})),H.A.setDefaultSelectedTab(L),F.A.checkAndStartOnboarding(g)},showFTERecipientOnboarding=()=>!(0,B.PV)()&&!d.Ay.isPresentInCache;function isHighContrastMode(){return!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(forced-colors: active)").matches}const CanCreateCollection=()=>CommonUtils_awaiter(void 0,void 0,void 0,(function*(){if(!(yield(0,p.e9)()).data){(0,W.a8)(W.bi.WorkspaceHome,W.Hc.CreateWorkspaceBtnClicked,"AIA consent not available");if(!(yield(0,p.Fo)()).data)return(0,W.a8)(W.bi.WorkspaceHome,W.Hc.CreateWorkspaceBtnClicked,"User did not provide consent"),!1}return!0}))},HB7v:(e,t,o)=>{"use strict";o.d(t,{A_:()=>copySelection,FX:()=>ShowNativeSpectrumToastOnCopy,I0:()=>getChatContent,c7:()=>copyElement,cL:()=>removeNewLines,yD:()=>copyChat});var s=o("plsW"),i=o("vyzc"),n=o("kqKr"),r=o("bV+/"),a=o("mVLN"),d=o("oYND"),l=o("oFBY"),__awaiter=function(e,t,o,s){return new(o||(o=Promise))((function(i,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};const getElementsContent=e=>{let t="",o="";for(let s=0;s<e.length;s+=1){const i=e[s],r=i.cloneNode(!0);(0,n.Gt)(r);const a=r;t+=(0,n.Tw)(i,a),o+=a.textContent,o+="\n"}return{htmlString:t,textString:o}},copyChat=()=>{(e=>{__awaiter(void 0,void 0,void 0,(function*(){if(!s.providers["native-api"])return;const t=yield s.providers["native-api"](),o=yield t.kwcAPI(),{htmlString:i,textString:n}=getElementsContent(e);o.setClipboardHTMLSnippet(i,n)}))})(document.querySelectorAll("#qnaContainer .tp_copyable"))},getChatContent=()=>{const e=document.querySelectorAll("#qnaContainer .tp_copyable");return getElementsContent(e)},copyElement=(e,t,o)=>{__awaiter(void 0,void 0,void 0,(function*(){if(!s.providers["native-api"])return;const i=yield s.providers["native-api"](),r=yield i.kwcAPI(),a=document.getElementById(e),d=a.cloneNode(!0);(0,n.Gt)(d,o);const l=d;r.setClipboardHTMLSnippet((0,n.Tw)(a,l),t||l.textContent)}))},copySelection=(e,t)=>{var o;if(null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.className.includes("spectrum-Textfield-input"))return;if(!s.providers["native-api"])return;e&&!i.A.IsRunningInNativeWebView()&&e.preventDefault();const{html:r,text:a}=(0,n.iS)(t);setTimeout((()=>{__awaiter(void 0,void 0,void 0,(function*(){const e=yield s.providers["native-api"]();(yield e.kwcAPI()).setClipboardHTMLSnippet(r,a)}))}),200)},ShowNativeSpectrumToastOnCopy=(e,t,o)=>{if(l.A.getLhpViewState()===a.vU.CLOSED&&""!==e){const s={type:a.O.kPositive,message:o.formatMessage({id:t}),timeout:8,position:a.Xu.kBottomRight,actionString:o.formatMessage({id:"notes.toast.openaction"}),actionRef:e,dropinEvent:d.A.SHOW_NOTE};(0,r.Vf)(s)}},removeNewLines=e=>{try{return JSON.parse(`"${e.replace(/"/g,'\\"')}"`)}catch(t){return e}}},JvqQ:(e,t,o)=>{"use strict";o.d(t,{PV:()=>isProjectOwner,nu:()=>canNotesBeModifiedOrCreated,sO:()=>canSourcesBeModifiedOrCreated});var s=o("cBgH"),i=o("2Wlf"),n=o("2NhI");const canNotesBeModifiedOrCreated=()=>!(!s.A.isCollabSessionInfoUpdated||i.Ay.userRole===n.Z.kViewer||i.Ay.userRole===n.Z.kReviewer),canSourcesBeModifiedOrCreated=()=>s.A.isCollabSessionInfoUpdated&&(i.Ay.userRole===n.Z.kOwner||i.Ay.userRole===n.Z.kContributor),isProjectOwner=()=>s.A.isCollabSessionInfoUpdated&&(i.Ay.userRole===n.Z.kOwner||i.Ay.userRole===n.Z.kContributor)},"2JWG":(e,t,o)=>{"use strict";o.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var s=o("YWiy");const __WEBPACK_DEFAULT_EXPORT__=e=>{const t=(0,s.useCallback)((()=>{e()}),[]),o=(0,s.useCallback)(((e,t)=>{t?window.addEventListener("resize",e):window.removeEventListener("resize",e)}),[]);(0,s.useEffect)((()=>(o(t,!0),()=>{o(t,!1)})),[])}},tT5Q:(e,t,o)=>{"use strict";o.d(t,{A:()=>GetCollaboratorsCommand});var s=o("yXqW");class GetCollaboratorsCommand extends s.VM{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(s.Bm.GET_COLLABORATORS),this.kw_id=e,this.fetch_from_cache=t}}},"9oid":(e,t,o)=>{"use strict";o.d(t,{A:()=>GetUserSharingMetadataCommand});var s=o("yXqW");class GetUserSharingMetadataCommand extends s.VM{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(s.Bm.GET_USER_SHARING_METADATA),this.includeCustomAgent=!1,this.kw_id=e,this.includeCustomAgent=t}}},Zs79:(e,t,o)=>{"use strict";o.d(t,{A:()=>CopyCollectionCommand});var s=o("yXqW");class CopyCollectionCommand extends s.VM{constructor(e,t){if(super(s.Bm.COPY_COLLECTION),!e)throw new Error("The 'source' object is required.");this.source=Object.assign({},e),this.source.assets&&0===this.source.assets.length&&delete this.source.assets,this.source.notes&&0===this.source.notes.length&&delete this.source.notes,t&&t.kwcollection_id&&(this.target=t)}}},mPX5:(e,t,o)=>{"use strict";o.d(t,{A:()=>UpdateCollectionCommand});var s=o("yXqW");class UpdateCollectionCommand extends s.VM{constructor(e,t,o,i){super(s.Bm.UPDATE_COLLECTION),this.iD=e,this.name=t,this.goal=o,this.description=i}}},vRtn:(e,t,o)=>{"use strict";o.d(t,{A:()=>GetNoteMetadataCommand});var s=o("yXqW");class GetNoteMetadataCommand extends s.VM{constructor(e,t){super(s.Bm.GET_NOTE_METADATA),this.kwId=e,this.noteId=t}}},"SG/b":(e,t,o)=>{"use strict";o.d(t,{d:()=>loadDropinClass});var s=o("plsW");const loadDropinClass=e=>s.providers.discovery(null,window.adobe_dc_sdk.cache.VERSIONS).then((t=>t.loadDropinClass(e)))},"2sT2":(e,t,o)=>{(t=o("AXyZ")(!1)).push([e.id,".ErrorStyles__networkHeading___2q6Ts{font-size:var(--spectrum-global-dimension-font-size-800)}.ErrorStyles__networkHeading___2q6Ts,.ErrorStyles__networkText___n62jI{font-weight:100;font-style:normal;text-align:center}.ErrorStyles__networkText___n62jI{font-size:var(--spectrum-global-dimension-font-size-200);color:var(--spectrum-global-color-gray-500)}",""]),t.locals={networkHeading:"ErrorStyles__networkHeading___2q6Ts",networkText:"ErrorStyles__networkText___n62jI"},e.exports=t},Scuq:(e,t,o)=>{(t=o("AXyZ")(!1)).push([e.id,".WinCustomScrollbar__customScrollbarViewLight___ryYHZ,.WinCustomScrollbar__customScrollbarViewLight___ryYHZ:hover{overflow-y:auto}.WinCustomScrollbar__customScrollbarViewLight___ryYHZ::-webkit-scrollbar{width:7px;background-color:#fff}.WinCustomScrollbar__customScrollbarViewLight___ryYHZ::-webkit-scrollbar-thumb{border-radius:10px;background:hsla(0,0%,50.2%,.5)}.WinCustomScrollbar__customScrollbarViewLight___ryYHZ::-webkit-scrollbar-button:vertical:decrement,.WinCustomScrollbar__customScrollbarViewLight___ryYHZ::-webkit-scrollbar-button:vertical:increment{visibility:hidden;width:0;height:0}.WinCustomScrollbar__customScrollbarViewDark___2IhA6,.WinCustomScrollbar__customScrollbarViewDark___2IhA6:hover{overflow-y:auto}.WinCustomScrollbar__customScrollbarViewDark___2IhA6::-webkit-scrollbar{width:7px;background-color:#323232}.WinCustomScrollbar__customScrollbarViewDark___2IhA6::-webkit-scrollbar-thumb{border-radius:10px;background:hsla(0,0%,50.2%,.5)}.WinCustomScrollbar__customScrollbarViewDark___2IhA6::-webkit-scrollbar-button:vertical:decrement,.WinCustomScrollbar__customScrollbarViewDark___2IhA6::-webkit-scrollbar-button:vertical:increment{visibility:hidden;width:0;height:0}@media (forced-colors:active){.WinCustomScrollbar__customScrollbarViewDark___2IhA6::-webkit-scrollbar-thumb,.WinCustomScrollbar__customScrollbarViewLight___ryYHZ::-webkit-scrollbar-thumb{background:ButtonText}.WinCustomScrollbar__customScrollbarViewDark___2IhA6::-webkit-scrollbar-thumb:hover,.WinCustomScrollbar__customScrollbarViewLight___ryYHZ::-webkit-scrollbar-thumb:hover{background:Highlight}}",""]),t.locals={customScrollbarViewLight:"WinCustomScrollbar__customScrollbarViewLight___ryYHZ",customScrollbarViewDark:"WinCustomScrollbar__customScrollbarViewDark___2IhA6"},e.exports=t},"2OSL":(e,t,o)=>{var s=o("2KPK"),i=o("2sT2");"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.id,i,""]]);var n={insert:"head",singleton:!1};s(i,n);e.exports=i.locals||{}},qK7d:(e,t,o)=>{var s=o("2KPK"),i=o("Scuq");"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.id,i,""]]);var n={insert:"head",singleton:!1};s(i,n);e.exports=i.locals||{}},m6SO:(e,t,o)=>{var s=o("YWiy");function SChevronRightMedium18N(e){return s.createElement("svg",e,s.createElement("g",{id:"Icons"},s.createElement("path",{d:"M11.99,9a.99677.99677,0,0,0-.29327-.70734L7.71734,4.30329A.9999.9999,0,1,0,6.30082,5.7149l.00245.00246L9.58594,9,6.30327,12.28268a.9999.9999,0,1,0,1.41166,1.41648l.00241-.00241,3.97939-3.98939A.9967.9967,0,0,0,11.99,9Z",fill:"#4b4b4b"})))}SChevronRightMedium18N.defaultProps={width:"18",height:"18",viewBox:"0 0 18 18"},e.exports=SChevronRightMedium18N,SChevronRightMedium18N.default=SChevronRightMedium18N},hTvL:(e,t,o)=>{var s=o("YWiy");function SIlluError136x136(e){return s.createElement("svg",e,[s.createElement("defs",{key:0},s.createElement("style",null,"\r\n      .cls-1 {\r\n        fill: #b3b3b3;\r\n      }\r\n    ")),s.createElement("title",{key:1},"S_IlluError_136x136"),s.createElement("path",{className:"cls-1",d:"M47.06152,117.0752a1.00026,1.00026,0,0,0-1.22363.708l-1.80371,6.76368a.99894.99894,0,0,0,.708,1.22363.987.987,0,0,0,.25879.03418.99964.99964,0,0,0,.96484-.74219l1.80371-6.76367A.99893.99893,0,0,0,47.06152,117.0752Z",key:2}),s.createElement("path",{className:"cls-1",d:"M53.25781,93.83887a.99874.99874,0,0,0-1.22363.708L50.7334,99.4248a.99894.99894,0,0,0,.708,1.22364.987.987,0,0,0,.25879.03418.99964.99964,0,0,0,.96484-.74219l1.30078-4.87793A.99893.99893,0,0,0,53.25781,93.83887Z",key:3}),s.createElement("path",{className:"cls-1",d:"M50.41113,104.51465a1.001,1.001,0,0,0-1.22363.708l-1.80371,6.76269a.99893.99893,0,0,0,.708,1.22363.987.987,0,0,0,.25879.03418.99964.99964,0,0,0,.96484-.74218l1.80371-6.7627A.99893.99893,0,0,0,50.41113,104.51465Z",key:4}),s.createElement("path",{className:"cls-1",d:"M75.20215,111.28809a1.00641,1.00641,0,0,0-1.207.73828L72.35547,118.832a1.0012,1.0012,0,0,0,.73828,1.207,1.02461,1.02461,0,0,0,.23535.02735,1.00164,1.00164,0,0,0,.97168-.76563l1.63965-6.80566A1.0012,1.0012,0,0,0,75.20215,111.28809Z",key:5}),s.createElement("path",{className:"cls-1",d:"M78.24609,98.64941a1.0075,1.0075,0,0,0-1.207.73829l-1.63965,6.80566a1.00122,1.00122,0,0,0,.73829,1.207,1.02453,1.02453,0,0,0,.23535.02734,1.00163,1.00163,0,0,0,.97168-.76562l1.63965-6.80566A1.00123,1.00123,0,0,0,78.24609,98.64941Z",key:6}),s.createElement("path",{className:"cls-1",d:"M87.09277,102.43164a.99445.99445,0,0,0-1.21191.72754l-1.69727,6.791a.99951.99951,0,1,0,1.93946.48437l1.69726-6.791A.99849.99849,0,0,0,87.09277,102.43164Z",key:7}),s.createElement("path",{className:"cls-1",d:"M83.93945,115.044a.9928.9928,0,0,0-1.21191.72753l-1.69727,6.791a.99952.99952,0,1,0,1.93946.48438l1.69726-6.791A.99848.99848,0,0,0,83.93945,115.044Z",key:8}),s.createElement("path",{className:"cls-1",d:"M89.24219,93.835a.9961.9961,0,0,0-1.21192.72754l-.69433,2.77637a.99951.99951,0,1,0,1.93945.48437l.69434-2.77636A.99851.99851,0,0,0,89.24219,93.835Z",key:9}),s.createElement("path",{className:"cls-1",d:"M67.68555,106.58887a1.0043,1.0043,0,0,0-1.2334.69238l-1.89551,6.73828a1.00017,1.00017,0,0,0,1.92578.541l1.89551-6.73828A1.00006,1.00006,0,0,0,67.68555,106.58887Z",key:10}),s.createElement("path",{className:"cls-1",d:"M64.166,119.10352a1.00735,1.00735,0,0,0-1.2334.69238l-1.89551,6.73828a1.00017,1.00017,0,0,0,1.92578.541l1.89551-6.73829A1.00005,1.00005,0,0,0,64.166,119.10352Z",key:11}),s.createElement("path",{className:"cls-1",d:"M71.20508,94.07422a1.00588,1.00588,0,0,0-1.2334.69238l-1.89551,6.73828a1.00017,1.00017,0,0,0,1.92578.541l1.89551-6.73828A1.00005,1.00005,0,0,0,71.20508,94.07422Z",key:12}),s.createElement("path",{className:"cls-1",d:"M61.81348,96.00586a.998.998,0,0,0-1.208.73535L58.94922,103.542a1,1,0,0,0,1.94336.47266l1.65625-6.80078A.99978.99978,0,0,0,61.81348,96.00586Z",key:13}),s.createElement("path",{className:"cls-1",d:"M55.66113,121.26758a1.003,1.003,0,0,0-1.208.73535l-1.65624,6.80078a1,1,0,0,0,1.94335.47266l1.65625-6.80078A.99978.99978,0,0,0,55.66113,121.26758Z",key:14}),s.createElement("path",{className:"cls-1",d:"M58.7373,108.63672a.99932.99932,0,0,0-1.208.73535l-1.65625,6.80078a1,1,0,0,0,1.94336.47266l1.65625-6.80078A.99979.99979,0,0,0,58.7373,108.63672Z",key:15}),s.createElement("path",{className:"cls-1",d:"M68.61035,75.72363a2.28121,2.28121,0,0,0-2.41357,2.3125,2.41972,2.41972,0,0,0,4.8269,0A2.24457,2.24457,0,0,0,68.61035,75.72363Z",key:16}),s.createElement("path",{className:"cls-1",d:"M67.26953,72.63965h2.68164c.20117,0,.23438-.10059.23438-.20117.10058-1.00537.67041-8.916.67041-11.73145V58.29346a.42155.42155,0,0,0-.20117-.36914,6.60654,6.60654,0,0,0-2.04444-.30127,5.80509,5.80509,0,0,0-2.01123.40234.35785.35785,0,0,0-.16748.36816v2.41407c0,2.81543.53613,10.69238.60327,11.63086A.22184.22184,0,0,0,67.26953,72.63965Z",key:17}),s.createElement("path",{className:"cls-1",d:"M72.94434,45.52344a4.84365,4.84365,0,0,0-8.39063,0L44.23926,80.73535A4.84411,4.84411,0,0,0,48.43457,88H89.06348a4.84411,4.84411,0,0,0,4.19531-7.26465ZM90.66016,84.07812A1.81083,1.81083,0,0,1,89.06348,85H48.43457a1.84411,1.84411,0,0,1-1.59766-2.76465L67.15137,47.02344a1.84437,1.84437,0,0,1,3.19531,0L90.66113,82.23535A1.811,1.811,0,0,1,90.66016,84.07812Z",key:18}),s.createElement("path",{className:"cls-1",d:"M108.11426,34.44141a1.50008,1.50008,0,1,0-.21875,2.99218,23.255,23.255,0,0,1-1.82813,46.44336l-4.11621.00586a1.5,1.5,0,0,0,.00195,3h.002l4.11621-.00586a26.2551,26.2551,0,0,0,2.043-52.43554Z",key:19}),s.createElement("path",{className:"cls-1",d:"M101.23047,45.60742a1.4972,1.4972,0,0,0,1.36133-.86914A28.9399,28.9399,0,1,0,48.03809,26.5127a1.49951,1.49951,0,1,0,2.93359.623A25.941,25.941,0,1,1,99.87109,43.47656a1.50047,1.50047,0,0,0,1.35938,2.13086Z",key:20}),s.createElement("path",{className:"cls-1",d:"M39.47266,26.67285a21.18724,21.18724,0,0,1,5.33789.30664,1.50028,1.50028,0,0,0,.55273-2.94922A23.78062,23.78062,0,0,0,17.88086,53.11133,17.21371,17.21371,0,0,0,4.085,69.9248,17.09437,17.09437,0,0,0,21.17773,86.98242h.04l17.4961-.02148a1.5,1.5,0,0,0-.002-3H38.71l-17.49707.02148h-.0332A14.09695,14.09695,0,0,1,7.085,69.919,14.17542,14.17542,0,0,1,19.92773,55.8457a1.50063,1.50063,0,0,0,1.29395-1.96289,20.78264,20.78264,0,0,1,18.251-27.21Z",key:21})])}SIlluError136x136.defaultProps={id:"production",width:"136",height:"136",viewBox:"0 0 136 136"},e.exports=SIlluError136x136,SIlluError136x136.default=SIlluError136x136},YTmI:(e,t,o)=>{var s=o("YWiy");function ErrorIllustrationLight(e){return s.createElement("svg",e,s.createElement("g",{id:"Br_Illu_KW-error state 1"},[s.createElement("path",{id:"Vector",d:"M33.2704 86.99C33.2304 86.31 32.6404 85.79 31.9804 85.83L14.1204 86.79C14.0304 86.79 13.9504 86.79 13.8604 86.79C10.1404 86.79 7.0104 83.83 6.8404 80.08L3.8704 22C3.6604 18.16 6.6004 14.84 10.4104 14.6L39.6204 13.11C41.0904 13.03 42.5604 13.56 43.6504 14.55L58.3104 27.97C59.4304 28.99 60.0904 30.38 60.1604 31.9L61.7004 63.46C61.7304 64.14 62.3504 64.65 62.9904 64.63C63.6704 64.6 64.1904 64.02 64.1604 63.34L62.6204 31.78C62.5204 29.61 61.5804 27.6 59.9704 26.15L45.3104 12.73C43.7404 11.3 41.6104 10.54 39.4904 10.65L10.2704 12.14C5.1004 12.47 1.1204 16.96 1.4104 22.13L4.3704 80.19C4.6004 85.25 8.8204 89.25 13.8704 89.25C13.9904 89.25 14.1104 89.25 14.2304 89.25L32.1104 88.29C32.7904 88.25 33.3104 87.67 33.2704 87V86.99Z",fill:"#010101",key:0}),s.createElement("path",{id:"Vector_2",d:"M51.4301 15.6901L54.7701 15.5201C56.2401 15.4401 57.7101 15.9701 58.8001 16.9601L73.4601 30.3801C74.5801 31.4001 75.2401 32.7901 75.3101 34.3101L76.7301 63.3801C76.7601 64.0401 77.3101 64.5501 77.9601 64.5501C77.9801 64.5501 78.0001 64.5501 78.0201 64.5501C78.7001 64.5201 79.2201 63.9401 79.1901 63.2601L77.7701 34.2001C77.6701 32.0301 76.7301 30.0201 75.1201 28.5701L60.4601 15.1501C58.8901 13.7201 56.7601 12.9601 54.6401 13.0701L51.3001 13.2401C50.6201 13.2701 50.1001 13.8501 50.1301 14.5301C50.1601 15.2101 50.7401 15.7201 51.4201 15.7001L51.4301 15.6901Z",fill:"#010101",key:1}),s.createElement("path",{id:"Vector_3",d:"M86.8997 69.11C76.2297 64.11 57.8397 65.32 44.3797 77.23C42.4797 74.99 40.7197 72.48 39.1497 69.71C38.8197 69.12 38.0697 68.92 37.4897 69.25C36.8997 69.58 36.6997 70.33 37.0297 70.91C46.2997 87.33 62.0497 94.79 75.3397 94.79C77.9097 94.79 80.3897 94.51 82.7197 93.96C90.4797 92.13 95.2897 87.4 95.5997 81.31C95.8597 76.26 92.6897 71.81 86.9097 69.1L86.8997 69.11ZM93.1397 81.19C92.8897 86.13 88.7797 90.02 82.1397 91.59C71.2697 94.15 56.7197 90.39 45.9997 79.05C55.7597 70.5 73.0597 65.32 85.8497 71.32C90.7497 73.62 93.3397 77.12 93.1397 81.19Z",fill:"#FA0F00",key:2}),s.createElement("path",{id:"Vector_4",d:"M40.73 80.89C32.82 89.88 28.89 101.99 29.06 116.89C29.06 117.56 29.61 118.1 30.28 118.1H30.29C30.96 118.1 31.5 117.54 31.5 116.87C31.34 102.59 35.06 91.03 42.56 82.51C43.01 82 42.96 81.23 42.45 80.79C41.94 80.35 41.17 80.39 40.73 80.9V80.89Z",fill:"#FA0F00",key:3}),s.createElement("path",{id:"Vector_5",d:"M16.9297 67.27C17.6797 67.9599 18.6397 68.3 19.5797 68.3C20.6397 68.3 21.6997 67.87 22.4697 67.03L32.0997 56.54L42.6597 66.1C43.4097 66.78 44.3497 67.11 45.2897 67.11C46.3597 67.11 47.4297 66.67 48.1997 65.82C49.6497 64.21 49.5297 61.73 47.9197 60.27L37.3997 50.75L46.9897 40.3C48.4597 38.7 48.3497 36.22 46.7497 34.75C45.1497 33.28 42.6697 33.39 41.1997 34.99L31.5697 45.48L21.0097 35.92C19.3997 34.46 16.9197 34.59 15.4597 36.2C14.0097 37.81 14.1297 40.29 15.7397 41.74L26.2597 51.26L16.6697 61.71C15.1997 63.31 15.3097 65.79 16.9097 67.26L16.9297 67.27Z",fill:"#FA0F00",key:4})]))}ErrorIllustrationLight.defaultProps={width:"97",height:"120",viewBox:"0 0 97 120",fill:"none"},e.exports=ErrorIllustrationLight,ErrorIllustrationLight.default=ErrorIllustrationLight}}]);