"use strict";(self["webpackJsonp-desktop-app"]=self["webpackJsonp-desktop-app"]||[]).push([[75154],{OL7S:(e,t,n)=>{n.r(t),n.d(t,{default:()=>DocFirst_MoreOptionsPopup});var o=n("I/yI"),r=n("YWiy"),i=n("lr/L"),a=n.n(i),l=n("j504"),s=n("gvVr"),c=n("plsW"),u=n("duok"),p=n("rrKQ"),d=n("wkOp"),m=n("0rPo"),f=n("Zm2D"),b=n("2koI");const y=(0,f.injectIntl)((e=>{const{intl:t,order:n,recipientIndex:i,isModifiedRef:l,recipientsList:s,setOrder:c}=e;return r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupInputContainer},r.createElement(b.A,{label:t.formatMessage({id:"rsDocFirstMoreOptions.order_label"}),selectedKey:String(n),onSelectionChange:e=>{if(-1!=i&&Number(e)===n)return;l.current=!0;const t=s.findIndex((t=>t.order===Number(e)));-1!==t&&(s[t].order=-1!==i?n:s.length+1),c(Number(e))},UNSAFE_className:a().MoreOptionsPopupPicker},[...Array(-1!==i?s.length:s.length+1).keys()].map((e=>r.createElement(d.Item,{key:String(e+1)},r.createElement(m.Text,null,e+1))))))}));var E=n("Ntb/");const v=(0,f.injectIntl)((e=>{const{intl:t,role:n,isModifiedRef:i,availableRecipientRoles:c,setRole:u}=e;return r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupInputContainer},r.createElement(b.A,{label:t.formatMessage({id:"rsDocFirstMoreOptions.role_label"}),selectedKey:n,defaultSelectedKey:l.vq.SIGNER,onSelectionChange:e=>{e!==n&&(i.current=!0,u(e))},UNSAFE_className:a().MoreOptionsPopupPicker},c.map((e=>r.createElement(d.Item,{key:e},r.createElement(E.Icon,{size:"S"},(0,s.mo)(e)),r.createElement(m.Text,{UNSAFE_style:{marginLeft:"var(--spectrum-global-dimension-size-125)"}},e.toLowerCase().split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")))))))}));var g=n("fQjX"),C=n("im2v"),O=n("kMZW"),I=n.n(O);const x=(0,f.injectIntl)((e=>{const{intl:t,name:n,selectedParticipantId:i,suggestedParticipants:l,isNameComboBoxFocused:s,HandleOnNameChange:c,HandleParticipantSelection:u,HandleOnNameComboBoxBlur:p,onParticipantComboKeyUp:d,onParticipantComboKeyDown:f,setComboBoxMenuOpen:b}=e;return r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupInputContainer},r.createElement(g.a3,{label:t.formatMessage({id:"rsDocFirstMoreOptions.name_label"}),inputValue:n,onInputChange:c,onSelectionChange:u,menuTrigger:"input",selectedKey:i,items:l,onBlur:p,onFocus:()=>{s.current=!0},onKeyUp:d,onKeyDown:f,onOpenChange:e=>{b(e)},UNSAFE_className:a().MoreOptionsPopupComboBox},(e=>r.createElement(C.Item,{key:e.userId},r.createElement(m.Text,{UNSAFE_className:I().comboboxText},e.displayName),r.createElement(m.Text,{UNSAFE_className:I().comboboxDescription,slot:"description"},e.emailId)))))})),N=(0,f.injectIntl)((e=>{const{intl:t,email:n,recipientIndex:i,recipientValid:l,selectedParticipantId:s,suggestedParticipants:c,isEmailComboBoxFocused:u,HandleOnEmailChange:p,HandleParticipantSelection:d,HandleOnEmailComboBoxBlur:f,onParticipantComboKeyUp:b,onParticipantComboKeyDown:y,setComboBoxMenuOpen:E}=e,[v,O]=(0,r.useState)();return(0,r.useEffect)((()=>{void 0!==l&&O(l?void 0:"invalid")}),[l]),r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupInputContainer},r.createElement(g.a3,{label:t.formatMessage({id:"rsDocFirstMoreOptions.email_label"}),isRequired:!0,inputValue:n,UNSAFE_className:a().MoreOptionsPopupComboBox,onInputChange:p,onSelectionChange:d,menuTrigger:"input",selectedKey:s,items:c,autoFocus:0===i,validationState:v,onBlur:f,onFocus:()=>{u.current=!0},onKeyUp:b,onKeyDown:y,onOpenChange:e=>{E(e)}},(e=>r.createElement(C.Item,{key:e.userId},r.createElement(m.Text,{UNSAFE_className:I().comboboxText},e.displayName),r.createElement(m.Text,{UNSAFE_className:I().comboboxDescription,slot:"description"},e.emailId)))))})),S=(0,f.injectIntl)((e=>{const{intl:t}=e;return r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupHeaderContainer},r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupHeaderTextContainer},r.createElement(m.Text,{UNSAFE_className:a().MoreOptionsPopupHeaderText},t.formatMessage({id:"rsDocFirstMoreOptions.header"}))))}));var P=n("lXyy"),__awaiter=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function fulfilled(e){try{step(o.next(e))}catch(e){i(e)}}function rejected(e){try{step(o.throw(e))}catch(e){i(e)}}function step(e){e.done?r(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const DocFirst_MoreOptionsPopup=e=>{const{popupID:t,popupData:n}=e;if(!n)return null;const i=n.recipientsList,d=n.recipientIndex,m=n.availableRecipientRoles,f=n.orderedSigningEnabled,b=i[d].memberInfos[0].email,E=i[d].memberInfos[0].name||"",g=i[d].role,C=i[d].order,O=(0,r.useRef)(i),I=(0,r.useRef)(d),h=(0,r.useRef)(b),F=(0,r.useRef)(E),M=(0,r.useRef)(g),A=(0,r.useRef)(C),R=(0,r.useRef)(!1),k=(0,r.useRef)(!1),[U,B]=r.useState(b),[_,w]=r.useState(E),[T,D]=r.useState(g),[j,K]=r.useState(C),handlePopupClose=()=>__awaiter(void 0,void 0,void 0,(function*(){if(!R.current||!k.current)return;O.current&&I.current<O.current.length&&((0,P.Ay)("RSDocFirstExp","MoreOptionsPopup","RecipientUpdated"),O.current[I.current].memberInfos[0].email=h.current,O.current[I.current].memberInfos[0].name=F.current,O.current[I.current].role=M.current,O.current[I.current].order=A.current);const{embedded:e,pii:t}=(()=>{const e=O.current||[],t=new Array,n=new Array;return e.forEach((e=>{const[o,r]=(0,s.Se)(e);t.push(o),n.push(r)})),{embedded:t,pii:n}})(),n={flag:l.yd.recipientListPopup,embedded:e,pii:t},o=c.providers["native-api"],r=yield o();(yield r.getRNAAPIObject()).invoke("updateDocFirstRSMetadataAPI",n)}));(0,r.useEffect)((()=>((0,P.Ay)("RSDocFirstExp","MoreOptionsPopup","Loaded"),()=>{handlePopupClose()})),[]),(0,r.useEffect)((()=>{h.current=U,F.current=_,M.current=T,A.current=j}),[U,_,T,j]);const H=(0,r.useRef)(!1),L=(0,r.useRef)(!1),W=(0,r.useRef)(null),[V,Q]=(0,r.useState)([]),[X,q]=(0,r.useState)(""),[z,J]=(0,r.useState)(!1),Y=(0,r.useRef)(!1),Z=(0,r.useRef)(!1),$=(0,r.useMemo)((()=>(0,p.A)(U)),[U]),[G,ee]=(0,r.useState)(U.length>0?$:void 0),te=(0,r.useCallback)((e=>{var t;let n=[];return e.data&&(n=null===(t=e.data._embedded)||void 0===t?void 0:t.suggestions.map((e=>({displayName:e.title,emailId:!0===e.synthetic?e.title:e.caption,userId:e.token})))),n||[]}),[]),ne=(0,r.useCallback)((e=>__awaiter(void 0,void 0,void 0,(function*(){try{if(e.length>0){const t=yield(0,u.eW)(e);t.data&&Q(te(t))}}catch(e){console.log("No suggestion")}}))),[]),oe=(0,r.useCallback)(((e,t)=>{t=t.split(/\s*[()\s]+\s*/)[0],B(t),w(e)}),[d,V]),re=(0,r.useCallback)((e=>{const t=V.find((t=>t.userId===e)),n=null==t?void 0:t.emailId;let o=null==t?void 0:t.displayName;V.length>0&&o&&o.length>0&&n&&n.length>0&&(o===n&&(o=""),Q([]),q(t.userId),oe(o,n))}),[d,V]),ie=(0,r.useCallback)((e=>{"Enter"===e.key&&Y.current&&z&&""===X&&re(V[0].userId)}),[z,X,V]),ae=(0,r.useCallback)((e=>{"Enter"===e.key&&(Y.current=z,Z.current=!0)}),[z]),le=(0,r.useCallback)((()=>{L.current=!1,Q([])}),[]),se=(0,r.useCallback)((()=>{H.current=!1,Q([])}),[]);return(0,r.useEffect)((()=>{const e=setTimeout((()=>{$?ee(!0):R.current&&ee(!1)}),500);return()=>clearTimeout(e)}),[U,$]),(0,r.useEffect)((()=>{void 0!==G&&(k.current=G)}),[G]),r.createElement(o.Flex,{UNSAFE_className:a().MoreOptionsPopupContainer},r.createElement(S,null),r.createElement(N,{email:U,recipientIndex:d,recipientValid:G,selectedParticipantId:X,suggestedParticipants:V,isEmailComboBoxFocused:H,HandleOnEmailChange:e=>{null!==W.current&&clearTimeout(W.current),R.current=!0,""!==e?B(e):oe(e,e),q(""),""===e?Q([]):W.current=setTimeout((()=>__awaiter(void 0,void 0,void 0,(function*(){yield ne(e),W.current=null}))),500)},HandleParticipantSelection:re,HandleOnEmailComboBoxBlur:se,onParticipantComboKeyUp:ie,onParticipantComboKeyDown:ae,setComboBoxMenuOpen:J}),r.createElement(x,{name:_,selectedParticipantId:X,suggestedParticipants:V,isNameComboBoxFocused:L,HandleOnNameChange:e=>{null!==W.current&&clearTimeout(W.current),R.current=!0,w(e),q(""),""===e?Q([]):W.current=setTimeout((()=>__awaiter(void 0,void 0,void 0,(function*(){yield ne(e),W.current=null}))),500)},HandleParticipantSelection:re,HandleOnNameComboBoxBlur:le,onParticipantComboKeyUp:ie,onParticipantComboKeyDown:ae,setComboBoxMenuOpen:J}),r.createElement(v,{role:T,isModifiedRef:R,availableRecipientRoles:m,setRole:D}),i&&i.length>1&&f?r.createElement(y,{order:j,recipientIndex:d,isModifiedRef:R,recipientsList:i,setOrder:K}):null)}},"2koI":(e,t,n)=>{n.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=n("YWiy"),r=n("wkOp"),__rest=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};const __WEBPACK_DEFAULT_EXPORT__=(e,t)=>{const{isOpen:n,onBlur:i,onOpenChange:a}=e,l=__rest(e,["isOpen","onBlur","onOpenChange"]),[s,c]=(0,o.useState)(n),u=o.useCallback((e=>{i&&i(e),c(!1)}),[i]),p=o.useCallback((e=>{a&&a(e),c(e)}),[a]);return o.createElement(r.Picker,Object.assign({isOpen:s,onBlur:u,onOpenChange:p,ref:t},l))}},lXyy:(e,t,n)=>{n.d(t,{Ay:()=>i,RW:()=>LogUsageMeasureEx,ct:()=>LogUsageMeasureThrottled});var o=n("plsW"),r=n("QLQe"),__awaiter=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function fulfilled(e){try{step(o.next(e))}catch(e){i(e)}}function rejected(e){try{step(o.throw(e))}catch(e){i(e)}}function step(e){e.done?r(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const LogUsageMeasure=(e,t,n)=>__awaiter(void 0,void 0,void 0,(function*(){if(!o.providers["native-api"])return;const r=yield o.providers["native-api"]();(yield r.analyticsAPI()).logEvent(e,t,n)})),LogUsageMeasureEx=(e,t,n,o)=>__awaiter(void 0,void 0,void 0,(function*(){e?(0,r.mB)(`${t}_${n}`,o):LogUsageMeasure(t,n,o)})),LogUsageMeasureThrottled=(e,t,n)=>__awaiter(void 0,void 0,void 0,(function*(){if(!o.providers["native-api"])return;const r=yield o.providers["native-api"]();(yield r.analyticsAPI()).logThrottledEvent(e,t,n)})),i=LogUsageMeasure}}]);