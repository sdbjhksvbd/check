"use strict";(self["webpackJsonp-dc-desktop-app"]=self["webpackJsonp-dc-desktop-app"]||[]).push([[862],{zSbg:(e,t,s)=>{s.d(t,{Z:()=>i});var a=s("plsW"),r=s("Lk87");const i=new class BaseURIModel{constructor(){this._baseFilesURIs={api:"https://files.acrobat.com/api/aax/",cloud_do_not_use:"https://cloud.acrobat.com/",commenting_uri:"https://comments.adobe.io/",download:"https://files-download2.acrocomcontent.com/api/ddx/",ims:"https://ims-na1.adobelogin.com/",prefs:"https://cloud.acrobat.com/api/aax/",rendition:"https://files.acrobat.com/api/rrx/",send_api:"https://send.acrobat.com/a/api/",ui_helpers:"https://cloud.acrobat.com/api/aax/",upload:"https://upload2.files.acrobat.com/api/uux/",users:"https://cloud.acrobat.com/api/aax/"},this._isBaseFilesURISet=!1,this._baseCreatePdfURIs={api:"https://createpdf.acrobat.com/createpdf/api/",users:"https://createpdf.acrobat.com/createpdf/api/",prefs:"https://createpdf.acrobat.com/createpdf/api/",ims:"https://ims-na1.adobelogin.com/",blueheron:"https://files.acrobat.com/",ipmcontext:"https://createpdf.acrobat.com/createpdf/api/users/me/ipm_context"},this._isBaseCreatePdfURISet=!1,this._durableLinkBaseURI="https://acrobat.adobe.com/id/",this._isDurableLinkBaseURISet=!1,this._invitationBaseURI="https://invitations.adobe.io/api/v4"}get isBaseFilesURISet(){return this._isBaseFilesURISet}get isBaseCreatePdfURISet(){return this._isBaseCreatePdfURISet}get isDurableLinkBaseURISet(){return this._isDurableLinkBaseURISet}async getBaseFilesURIs(){const e=new r.Z;try{if(!this.isBaseFilesURISet){const e=await a.providers["native-api"](),t=await e.ResponseCacheAPI(),s=await t.GetBaseURIs("Files");null!=s&&(this._baseFilesURIs.api=null!=s.api&&""!=s.api?s.api:this._baseFilesURIs.api,this._baseFilesURIs.cloud_do_not_use=null!=s.cloud_do_not_use&&""!=s.cloud_do_not_use?s.cloud_do_not_use:this._baseFilesURIs.cloud_do_not_use,this._baseFilesURIs.commenting_uri=null!=s.commenting_uri&&""!=s.commenting_uri?s.commenting_uri:this._baseFilesURIs.commenting_uri,this._baseFilesURIs.download=null!=s.download&&""!=s.download?s.download:this._baseFilesURIs.download,this._baseFilesURIs.ims=null!=s.ims&&""!=s.ims?s.ims:this._baseFilesURIs.ims,this._baseFilesURIs.prefs=null!=s.prefs&&""!=s.prefs?s.prefs:this._baseFilesURIs.prefs,this._baseFilesURIs.rendition=null!=s.rendition&&""!=s.rendition?s.rendition:this._baseFilesURIs.rendition,this._baseFilesURIs.send_api=null!=s.send_api&&""!=s.send_api?s.send_api:this._baseFilesURIs.send_api,this._baseFilesURIs.ui_helpers=null!=s.ui_helpers&&""!=s.ui_helpers?s.ui_helpers:this._baseFilesURIs.ui_helpers,this._baseFilesURIs.upload=null!=s.upload&&""!=s.upload?s.upload:this._baseFilesURIs.upload,this._baseFilesURIs.users=null!=s.users&&""!=s.users?s.users:this._baseFilesURIs.users),this._isBaseFilesURISet=!0}e.resolve(this._baseFilesURIs)}catch(t){e.resolve(this._baseFilesURIs)}return e.promise}async getBaseCreatePdfURIs(){const e=new r.Z;try{if(!this.isBaseCreatePdfURISet){const e=await a.providers["native-api"](),t=await e.ResponseCacheAPI(),s=await t.GetBaseURIs("CreatePDF");null!=s&&(this._baseCreatePdfURIs.api=null!=s.api&&""!=s.api?s.api:this._baseCreatePdfURIs.api,this._baseCreatePdfURIs.users=null!=s.users&&""!=s.users?s.users:this._baseCreatePdfURIs.users,this._baseCreatePdfURIs.ims=null!=s.ims&&""!=s.ims?s.ims:this._baseCreatePdfURIs.ims,this._baseCreatePdfURIs.prefs=null!=s.prefs&&""!=s.prefs?s.prefs:this._baseCreatePdfURIs.prefs,this._baseCreatePdfURIs.blueheron=null!=s.blueheron&&""!=s.blueheron?s.blueheron:this._baseCreatePdfURIs.blueheron,this._baseCreatePdfURIs.ipmcontext=null!=s.ipmcontext&&""!=s.ipmcontext?s.ipmcontext:this._baseCreatePdfURIs.ipmcontext),this._isBaseCreatePdfURISet=!0}e.resolve(this._baseCreatePdfURIs)}catch(t){e.resolve(this._baseCreatePdfURIs)}return e.promise}async getDurableLinkBaseURI(){const e=new r.Z;try{if(!this.isDurableLinkBaseURISet){const e=await a.providers["native-api"](),t=await e.UnifiedSharePopupAPI(),s=await t.GetDurableLinkBaseURIFromDiscoveryResponse();this._durableLinkBaseURI=null!=s&&""!=s?s:this._durableLinkBaseURI}}catch(e){}return e.resolve(this._durableLinkBaseURI),e.promise}async getInvitationBaseURI(){const e=new r.Z;try{const e=await a.providers["native-api"](),t=await e.UnifiedSharePopupAPI(),s=await t.GetInvitationBaseURIFromDiscoveryResponse();this._invitationBaseURI=null!=s&&""!=s?s:this._invitationBaseURI}catch(e){}return e.resolve(this._invitationBaseURI),e.promise}}},n0hZ:(e,t,s)=>{s.r(t),s.d(t,{default:()=>CollaborationProvider});var a=s("plsW"),r=s("siW8"),i=s("DeC6"),o=s("Lk87"),n=s("A34E");class PublicProfileServiceNetworkCall{constructor(){}async GetPublicProfileServiceHTTPHeaders(e){const t=await a.providers["native-api"](),s=await t.SessionAPI(),r={Accept:"application/json","Content-Type":"application/json","x-api-key":n.Z.isReader()?"AdobeReader9":"AdobeAcrobat9"};if(e){const e=await s.GetAccessToken();r.Authorization="Bearer "+e}return r}async GetPublicProfileInfoDetails(){const e=await a.providers["native-api"](),t=await e.ServicesAPI();return await t.FetchPublicProfileDetailsFromNative()}async PopulatePublicProfileUserDetails(e,t){var s;e.data.users=[],(null===(s=null==t?void 0:t.results)||void 0===s?void 0:s.length)&&t.results.forEach((t=>{const s={adobeId:t.id,firstName:t.first_name,lastName:t.last_name,username:t.nick_name,displayName:t.display_name,hasDefaultImage:t.is_default_image,image_50:t.images[50],image_100:t.images[100],image_115:t.images[115],image_138:t.images[138],image_230:t.images[230],image_276:t.images[276]};e.data.users.push(s)}))}async MakeNetworkCall(e){const t=await a.providers["native-api"](),s=await t.ServicesAPI(),r=await s.isPPSEnabled(),n=new o.Z;let l={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return l.ERR_CODE=i.q.INVALID_PARAMS,n.reject(l),n.promise;const d=await this.GetPublicProfileInfoDetails();if(!d)return l.ERR_CODE=i.q.UNKNOWN_ERROR,n.reject(l),n.promise;var c,u=await this.GetPublicProfileServiceHTTPHeaders(r);const R=e.listOfGUID;var p,h="";if(r){let e=d.queryInit;R.forEach((t=>{t&&t.length&&(e+='"',e+=t,e+='",')})),e=e.substring(0,e.length-1),e+=d.queryEnd,c=d.endpoint+"query="+encodeURIComponent(e),p="GET"}else h=d.queryInit,R.forEach((e=>{e&&e.length&&(h+='\\"',h+=e,h+='\\",')})),h+=d.queryEnd,c=d.endpoint,p="POST";let C={};if(!r)try{C=JSON.parse(h)}catch(e){return l.ERR_CODE=i.q.UNKNOWN_ERROR,n.reject(l),n.promise}const _=await a.providers["network-api"]();var E;E=r?_.GetNetworkQuery(c,{},{method:p,headers:u},{wantsHeaders:!0}):_.GetNetworkMutation(c,{},{method:p,headers:u},{wantsHeaders:!0});const m={onResponse:e=>{if(E.Unsubscribe(m),r){const t=e;this.PopulatePublicProfileUserDetails(l,t)}l.ERR_CODE=i.q.NO_ERROR,l.data=null==e?void 0:e.body,l.headers=null==e?void 0:e.headers,l.status=null==e?void 0:e.status,n.resolve(l)},onStatusChange:()=>{},onError:e=>{E.Unsubscribe(m),l.ERR_CODE=i.q.NETWORK_CALL_FAILED,l.error=null==e?void 0:e.body,l.headers=null==e?void 0:e.headers,l.status=null==e?void 0:e.status,n.reject(l)}};return E.Subscribe(m),r?E.Refresh():E.Mutate(C),n.promise}IsValidRequest(e){return e.command===r.v.PUBLIC_PROFILE_SERVICE&&0!==e.listOfGUID.length}}class BootstrapNetworkCall{constructor(){}async GetBootstrapHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}PopulateBoostrapSharedAssetInfo(e,t){var s,a;(null===(s=null==t?void 0:t.meta_list)||void 0===s?void 0:s.length)&&(t.meta_list[0].asset_urn&&(e.data.asset_id=t.meta_list[0].asset_urn),t.meta_list[0].commenting_urn&&(e.data.commenting_urn=t.meta_list[0].commenting_urn)),e.data.is_original_shared=!1,t.is_original_shared&&(e.data.is_original_shared=t.is_original_shared),t.parcel_data&&(e.data.email_message="",t.parcel_data.email_message&&(e.data.email_message=t.parcel_data.email_message),(null===(a=t.parcel_data.review)||void 0===a?void 0:a.url)&&(e.data.preview_url=t.parcel_data.review.url)),e.data.full_bootstrap_response=t}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r="https://send.acrobat.com/a/preview/"+e.assetId+"/bootstrap";let n={};e.shareInfo&&(n.shareinfo=!0);const l=await this.GetBootstrapHTTPHeaders(),d=(await a.providers["network-api"]()).GetNetworkQuery(r,n,{method:"GET",headers:l}),c={onResponse:e=>{d.Unsubscribe(c);const a=e;this.PopulateBoostrapSharedAssetInfo(s,a),t.resolve(s)},onStatusChange:e=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=e,t.reject(s)}};return d.Subscribe(c),d.Refresh(),t.promise}IsValidRequest(e){return e.command===r.v.BOOTSTRAP&&0!==e.assetId.length}}var l=s("zSbg");class CollaboratorNetworkCall{constructor(){}async GetCollaboratorHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.assetId,n=e.forceUpdate,d=e.shouldIncludeEngagement;let c=(await l.Z.getBaseFilesURIs()).send_api+"assets/"+r+"/collaborators";d&&(c+="?includeStats=true"),n&&(c+="?force=true");const u=await this.GetCollaboratorHTTPHeaders(),R=(await a.providers["network-api"]()).GetNetworkQuery(c,{},{method:"GET",headers:u},{wantsHeaders:!0}),p={onResponse:e=>{R.Unsubscribe(p),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:e=>{},onError:e=>{R.Unsubscribe(p),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return R.Subscribe(p),R.Refresh(),t.promise}IsValidRequest(e){return e.command===r.v.COLLABORATOR&&(0!==e.assetId.length&&"dummyId"!==e.assetId)}}class CreateLinkNetworkCall{constructor(){}async GetPublicLinkHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=(await l.Z.getBaseFilesURIs()).send_api+"invitation/publicLink",n=await this.GetPublicLinkHTTPHeaders(),d=e;let c={content_types:d.contentType,is_review:d.isReview,asset_name:d.assetName};0!==d.assetId.length&&(c.asset_id=d.assetId);const u=(await a.providers["network-api"]()).GetNetworkMutation(r,{},{method:"POST",headers:n},{retries:1,wantsHeaders:!0}),R={onResponse:e=>{u.Unsubscribe(R),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{u.Unsubscribe(R),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return u.Subscribe(R),u.Mutate(c),t.promise}IsValidRequest(e){return e.command===r.v.PUBLIC_LINK&&(0!==e.assetName.length&&0!==e.contentType.length)}}class InvitationNetworkCall{constructor(){}async GetInvitationHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();return{Accept:"application/vnd.adobe.skybox+json;version=2","Content-Type":"application/json","x-api-client-id":t.xApiClientId,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.parcelId,n=e.recipients,d=e.currentAccessControlLevel,c=e.canShareEnabled,u=e.emailSubject,R=e.emailMessage,p=(await l.Z.getBaseFilesURIs()).send_api+"parcels/"+r+"/invitation",h=await this.GetInvitationHTTPHeaders();let C={recipients:n};"legacy"!==d&&(C.canShare=c),C.notification={parameters:{email_subject:u,email_message:R}};const _=(await a.providers["network-api"]()).GetNetworkMutation(p,{},{method:"POST",headers:h},{wantsHeaders:!0}),E={onResponse:e=>{_.Unsubscribe(E),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{_.Unsubscribe(E),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return _.Subscribe(E),_.Mutate(C),t.promise}IsValidRequest(e){const t=e;return t.command===r.v.INVITATION&&0!==t.parcelId.length&&(0!==t.recipients.length&&(0!==t.emailSubject.length&&!0!==t.canShareEnabled))}}class PgcSuggestionsNetworkCall{constructor(){}async GetPgcSuggestionsHTTPHeaders(e){const t=await a.providers["native-api"](),s=await t.SessionAPI(),r=await s.GetAccessToken();s.xApiClientId;return{"Content-Type":"application/json","x-Api-Key":e?"AdobeReader9":"AdobeAcrobat9",authorization:`Bearer ${r}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e,n=await this.GetPgcSuggestionsHTTPHeaders(r.isReaderProduct);let l={};l.query={type:r.type,value:r.searchString},l.relationship=r.relationship,l.resourceType=r.resourceType;const d=(await a.providers["network-api"]()).GetNetworkMutation("https://pgc.adobe.io/api/suggestions",{},{method:"POST",headers:n},{wantsHeaders:!0}),c={onResponse:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return d.Subscribe(c),d.Mutate(l),t.promise}IsValidRequest(e){return e.command===r.v.PGC_SUGGESTIONS&&e.searchString.length>=0}}class ConsentNetworkCall{constructor(){}async GetConsentHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{Accept:"application/vnd.adobe.skybox+json;version=2","Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.invitationId,n=(await l.Z.getBaseFilesURIs()).send_api+"invitation/"+r+"/consent",d=await this.GetConsentHTTPHeaders(),c=(await a.providers["network-api"]()).GetNetworkMutation(n,{},{method:"DELETE",headers:d},{wantsHeaders:!0}),u={onResponse:e=>{c.Unsubscribe(u),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{c.Unsubscribe(u),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return c.Subscribe(u),c.Mutate({value:!1}),t.promise}IsValidRequest(e){return e.command===r.v.CONSENT&&0!==e.invitationId.length}}class UnshareNetworkCall{constructor(){}async GetUnshareHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{Accept:"application/vnd.adobe.skybox+json;version=2","Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.invitationId,n=e.deleteAnnots;let d=(await l.Z.getBaseFilesURIs()).send_api+"parcels/"+r+"/is_active";n&&(d+="?deleteAnnots=true");const c=await this.GetUnshareHTTPHeaders(),u=(await a.providers["network-api"]()).GetNetworkMutation(d,{},{method:"PUT",headers:c},{wantsHeaders:!0}),R={onResponse:e=>{u.Unsubscribe(R),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{u.Unsubscribe(R),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return u.Subscribe(R),u.Mutate({value:!1}),t.promise}IsValidRequest(e){return e.command===r.v.UNSHARE&&0!==e.invitationId.length}}class MergeAnnotsNetworkCall{constructor(){}async GetMergeAnnotsHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{Accept:"application/vnd.adobe.dc+json;version=1","Content-Type":"application/vnd.adobe.dc+json;version=1","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`,"x-api-key":"AdobeAcrobat5"}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.commentingUrn,n=(await l.Z.getBaseFilesURIs()).commenting_uri+"assets/"+r+"?operation=mergeannots",d=await this.GetMergeAnnotsHTTPHeaders(),c=(await a.providers["network-api"]()).GetNetworkMutation(n,{},{method:"POST",headers:d},{wantsHeaders:!0}),u={onResponse:e=>{c.Unsubscribe(u),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{c.Unsubscribe(u),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return c.Subscribe(u),c.MutateStr(""),t.promise}IsValidRequest(e){return e.command===r.v.MERGE_ANNOTS&&0!==e.commentingUrn.length}}class PgcAcceptNetworkCall{constructor(){}async GetPgcAcceptHTTPHeaders(e){const t=await a.providers["native-api"](),s=await t.SessionAPI(),r=await s.GetAccessToken();s.xApiClientId;return{"Content-Type":"application/json","x-Api-Key":e?"AdobeReader9":"AdobeAcrobat9",authorization:`Bearer ${r}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e,n=await this.GetPgcAcceptHTTPHeaders(r.isReaderProduct);let l={};l.tokens=r.tokens;const d=(await a.providers["network-api"]()).GetNetworkMutation("https://pgc.adobe.io/api/accept",{},{method:"POST",headers:n},{wantsHeaders:!0}),c={onResponse:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return d.Subscribe(c),d.Mutate(l),t.promise}IsValidRequest(e){return e.command===r.v.PGC_ACCEPT&&e.tokens.length>0}}class LimtsNetworkCall{constructor(){}async GetLimitsHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();return{Accept:"application/vnd.adobe.dex+json;version=1","Content-Type":"application/json","x-api-client-id":t.xApiClientId,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=(await l.Z.getBaseCreatePdfURIs()).users+"users/me?fields=identity,subscriptions,limits/acrobat,limits/common,limits/conversions,limits/esign,limits/fillsign,limits/send,prefs/comments,prefs/common,prefs/conversions,prefs/files,prefs/fillsign,prefs/send",n=await this.GetLimitsHTTPHeaders(),d=(await a.providers["network-api"]()).GetNetworkQuery(r,{},{method:"GET",headers:n},{wantsHeaders:!0}),c={onResponse:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{d.Unsubscribe(c),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return d.Subscribe(c),d.Refresh(),t.promise}IsValidRequest(e){return e.command===r.v.LIMITS}}class DeleteCollaboratorNetworkCall{constructor(){this.mAllowedCollaborators=new Set,this.mAllowedCollaborators.add("all"),this.mAllowedCollaborators.add("orgEverybody")}async GetDeletionHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.assetId,n=e.recipients.filter((e=>this.mAllowedCollaborators.has(e)));let d=[];n.forEach((e=>d.push({id:e})));const c=(await l.Z.getBaseFilesURIs()).send_api+"assets/"+r+"/collaborators",u=await this.GetDeletionHTTPHeaders(),R={collaborators:d},p=(await a.providers["network-api"]()).GetNetworkMutation(c,{},{method:"DELETE",headers:u},{wantsHeaders:!0}),h={onResponse:e=>{p.Unsubscribe(h),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{p.Unsubscribe(h),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return p.Subscribe(h),p.Mutate(R),t.promise}IsValidRequest(e){if(e.command===r.v.DELETE_COLLABORATOR&&0!==e.assetId.length&&0!==e.recipients.length){return 0!==e.recipients.filter((e=>this.mAllowedCollaborators.has(e))).length}return!1}}class PatchCollaboratorNetworkCall{async GetPatchHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken(),r=t.xApiClientId;return{"Content-Type":"application/json","x-api-app-info":r,"x-api-client-id":r,authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=e.assetId,n=e.addCollaboratorList,d=e.removeCollaboratorList,c=e.updateCollaboratorList,u=(await l.Z.getBaseFilesURIs()).send_api+"v1/assets/"+r+"/collaborators",R=await this.GetPatchHTTPHeaders(),p={};n.length>0&&(p.add=n),d.length>0&&(p.remove=d),c.length>0&&(p.update=c);const h=JSON.stringify(p),C=(await a.providers["network-api"]()).GetNetworkMutation(u,{},{method:"PATCH",headers:R,body:h},{retries:0,wantsHeaders:!0}),_={onResponse:e=>{C.Unsubscribe(_),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{C.Unsubscribe(_),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return C.Subscribe(_),C.Mutate(p),t.promise}IsValidRequest(e){let t=e.nextAccessLevel;if(e.command===r.v.PATCH_COLLABORATOR&&0!==e.assetId.length){let s=!0;return e.addCollaboratorList.forEach((e=>{"private"===e.id?s=!1:"orgEverybody"!==e.id&&"all"!==e.id||!0!==e.canShare||(s=!1)})),e.removeCollaboratorList.forEach((e=>{"private"===e.id&&(s=!1)})),e.updateCollaboratorList.forEach((e=>{"all"!==t&&"orgEverybody"!==t&&"private"!==t||!0!==e.canShare||(s=!1)})),s}return!1}}class PendingAccessReqNetworkCall{constructor(){}async PendingAccessReqHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();t.xApiClientId;return{"Content-Type":"application/json","X-Api-Key":"AdobeAcrobat9",authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=await l.Z.getInvitationBaseURI(),n=await this.PendingAccessReqHTTPHeaders(),d=r+"/accessrequests/"+e.assetId+"?orderBy=-requesttime",c=(await a.providers["network-api"]()).GetNetworkQuery(d,{},{method:"GET",headers:n},{retries:1,wantsHeaders:!0}),u={onResponse:e=>{c.Unsubscribe(u),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{c.Unsubscribe(u),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return c.Subscribe(u),c.Refresh(),t.promise}IsValidRequest(e){return e.command===r.v.PENDING_ACCESS_REQ&&(0!==e.assetId.length&&"dummyId"!==e.assetId)}}class ManageAccessReqNetworkCall{constructor(){}async ManageAccessReqHTTPHeaders(){const e=await a.providers["native-api"](),t=await e.SessionAPI(),s=await t.GetAccessToken();t.xApiClientId;return{"Content-Type":"application/json","X-Api-Key":"AdobeAcrobat9",authorization:`Bearer ${s}`}}async MakeNetworkCall(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidRequest(e))return s.ERR_CODE=i.q.INVALID_PARAMS,t.reject(s),t.promise;const r=await l.Z.getInvitationBaseURI(),n=await this.ManageAccessReqHTTPHeaders(),d=e;let c={resourceUrn:d.assetId,requesterId:d.requesterId,action:d.action,role:d.role,canShare:d.canShare,canComment:d.canComment,notification:d.notification.toJSONFormat()};const u=r+"/accessrequests/ops",R=(await a.providers["network-api"]()).GetNetworkMutation(u,{},{method:"POST",headers:n},{retries:0,wantsHeaders:!0}),p={onResponse:e=>{R.Unsubscribe(p),s.ERR_CODE=i.q.NO_ERROR,s.data=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.resolve(s)},onStatusChange:()=>{},onError:e=>{R.Unsubscribe(p),s.ERR_CODE=i.q.NETWORK_CALL_FAILED,s.error=null==e?void 0:e.body,s.headers=null==e?void 0:e.headers,s.status=null==e?void 0:e.status,t.reject(s)}};return R.Subscribe(p),R.Mutate(c),t.promise}IsValidRequest(e){return e.command===r.v.MANAGE_ACCESS_REQ&&(0!==e.assetId.length&&0!==e.requesterId.length&&0!==e.action.length&&("grant"==e.action||"reject"==e.action)&&0!==e.role.length&&!0!==e.canShare&&void 0!==e.canComment&&void 0!==e.notification)}}class CollaborationProvider{constructor(){this.mCommandToExecutor=new Map,this.initializeCommands()}initializeCommands(){this.mCommandToExecutor.set(r.v.BOOTSTRAP,new BootstrapNetworkCall),this.mCommandToExecutor.set(r.v.COLLABORATOR,new CollaboratorNetworkCall),this.mCommandToExecutor.set(r.v.PUBLIC_PROFILE_SERVICE,new PublicProfileServiceNetworkCall),this.mCommandToExecutor.set(r.v.INVITATION,new InvitationNetworkCall),this.mCommandToExecutor.set(r.v.PUBLIC_LINK,new CreateLinkNetworkCall),this.mCommandToExecutor.set(r.v.CONSENT,new ConsentNetworkCall),this.mCommandToExecutor.set(r.v.PGC_SUGGESTIONS,new PgcSuggestionsNetworkCall),this.mCommandToExecutor.set(r.v.UNSHARE,new UnshareNetworkCall),this.mCommandToExecutor.set(r.v.MERGE_ANNOTS,new MergeAnnotsNetworkCall),this.mCommandToExecutor.set(r.v.PGC_ACCEPT,new PgcAcceptNetworkCall),this.mCommandToExecutor.set(r.v.LIMITS,new LimtsNetworkCall),this.mCommandToExecutor.set(r.v.DELETE_COLLABORATOR,new DeleteCollaboratorNetworkCall),this.mCommandToExecutor.set(r.v.PATCH_COLLABORATOR,new PatchCollaboratorNetworkCall),this.mCommandToExecutor.set(r.v.PENDING_ACCESS_REQ,new PendingAccessReqNetworkCall),this.mCommandToExecutor.set(r.v.MANAGE_ACCESS_REQ,new ManageAccessReqNetworkCall)}ready(){return Promise.resolve(this)}IsValidCommand(e){return this.mCommandToExecutor.has(e.command)}async ExecuteCollabCommand(e){const t=new o.Z;let s={ERR_CODE:i.q.NO_ERROR,data:{},error:{}};if(!this.IsValidCommand(e))return s.ERR_CODE=i.q.INVALID_COMMAND,t.reject(s),t.promise;const r=await a.providers["native-api"](),n=await r.ServicesTestAPI(),l=e.networkCallName(),d="ShareSheet_"+l;""!==l&&await n.logPerformance(d,"start");const c=this.mCommandToExecutor.get(e.command);if(c)try{if(s=await c.MakeNetworkCall(e),void 0!==(null==s?void 0:s.headers)){(await r.UnifiedSharePopupAPI()).LogDCApiMigrationStatus(null==s?void 0:s.headers)}t.resolve(s)}catch(e){if(void 0!==(null==e?void 0:e.headers)){(await r.UnifiedSharePopupAPI()).LogDCApiMigrationStatus(null==e?void 0:e.headers)}t.reject(e)}return""!==l&&await n.logPerformance(d,"end"),t.promise}}CollaborationProvider.getInstance=a.providerUtil.getSingletonFunction(CollaborationProvider)},wmCg:(e,t,s)=>{s.r(t),s.d(t,{default:()=>DCDiscoveryProvider});var a=s("plsW");class DCDiscoveryProvider{constructor(){this.mDiscoveryExpiry=0}ready(){return Promise.resolve(this)}async GetSessionAPI(){const e=await a.providers["native-api"]();return await e.SessionAPI()}HasDiscoveryExpired(){const e=(new Date).getTime()/1e3;return this.mDiscoveryExpiry>0&&e>this.mDiscoveryExpiry}async GetDCDiscoveryReponse(){if(this.mDiscoveryResponse&&!this.HasDiscoveryExpired())return this.mDiscoveryResponse;const e=await a.providers["native-api"](),t=await e.ResponseCacheAPI();return this.mDiscoveryResponse=await t.GetDCDiscoveryResponse(),this.mDiscoveryExpiry=this.mDiscoveryResponse.expiry,this.mDiscoveryResponse}async GetHTTPHeaders(e,t){const s=await this.GetSessionAPI(),a=await s.GetAccessToken(),r=s.xApiClientId;let i={accept:e,authorization:`Bearer ${a}`,"x-api-app-info":r,"x-api-client-id":r};return t&&(i=Object.assign(Object.assign({},i),{"Content-Type":t})),i}async GetUSSHTTPHeaders(){const e=await this.GetSessionAPI();return{accept:"*/*",authorization:`Bearer ${await e.GetAccessToken()}`,"x-api-key":"AdobeAcrobat9","x-product":"acrobat.adobe.com","x-product-location":"uss search input","Content-Type":"application/vnd.adobe.search-request+json"}}async GetNameValidatorHTTPHeaders(){const e=await this.GetSessionAPI();return{accept:"application/vnd.adobe.skybox+json;version=1",authorization:`Bearer ${await e.GetAccessToken()}`,"Content-Type":"application/vnd.adobe.skybox+json;version=1;charset=utf-8"}}ParseDiscoveryUriToFullUri(e,t,s){if(!this.mDiscoveryResponse)return"";const a=/\{\+([^\s}]+)\}/;let r=e.match(a);for(;r&&r.length>0;){const s=r[1];let i=t[s];i||(i=this.mDiscoveryResponse.templates[s]),i&&(i=i.toString(),i.length>0&&(e=e.replace(r[0],i))),r=e.match(a)}const i=/\{([^\s+}]+)\}/;let o=e.match(i);for(;o&&o.length>=2;){let t=o[1][0],a=o[1];t.match(/[\w\d]/)?t="":a=a.substr(1);const r=a.split(",").reduce(((e,t)=>t in s?(e.length>0&&(e+="&"),e+=`${t}=${s[t]}`):e),"");r.length>0&&(e=e.replace(o[0],t+r)),o=e.match(i)}return e}}DCDiscoveryProvider.getInstance=a.providerUtil.getSingletonFunction(DCDiscoveryProvider)},DeC6:(e,t,s)=>{var a;s.d(t,{q:()=>a}),function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_COMMAND=1]="INVALID_COMMAND",e[e.INVALID_PARAMS=2]="INVALID_PARAMS",e[e.NETWORK_CALL_FAILED=3]="NETWORK_CALL_FAILED",e[e.UNKNOWN_ERROR=4]="UNKNOWN_ERROR"}(a||(a={}))},siW8:(e,t,s)=>{var a;s.d(t,{V:()=>CollabRequestCommand,v:()=>a}),function(e){e[e.BOOTSTRAP=0]="BOOTSTRAP",e[e.COLLABORATOR=1]="COLLABORATOR",e[e.INVITATION=2]="INVITATION",e[e.PUBLIC_PROFILE_SERVICE=3]="PUBLIC_PROFILE_SERVICE",e[e.PUBLIC_LINK=4]="PUBLIC_LINK",e[e.CONSENT=5]="CONSENT",e[e.PGC_SUGGESTIONS=6]="PGC_SUGGESTIONS",e[e.UNSHARE=7]="UNSHARE",e[e.MERGE_ANNOTS=8]="MERGE_ANNOTS",e[e.PGC_ACCEPT=9]="PGC_ACCEPT",e[e.LIMITS=10]="LIMITS",e[e.DELETE_COLLABORATOR=11]="DELETE_COLLABORATOR",e[e.PATCH_COLLABORATOR=12]="PATCH_COLLABORATOR",e[e.PENDING_ACCESS_REQ=13]="PENDING_ACCESS_REQ",e[e.MANAGE_ACCESS_REQ=14]="MANAGE_ACCESS_REQ"}(a||(a={}));class CollabRequestCommand{constructor(e){this.mCommand=e}get command(){return this.mCommand}networkCallName(){switch(this.mCommand){case a.BOOTSTRAP:return"BootStrap";case a.COLLABORATOR:return"Collaborator";case a.INVITATION:return"Invitation";case a.PUBLIC_PROFILE_SERVICE:return"PublicProfileService";case a.PUBLIC_LINK:return"CreateLink";case a.CONSENT:return"Consent";case a.PGC_SUGGESTIONS:case a.UNSHARE:return"PGC_Suggestions";case a.MERGE_ANNOTS:return"Merge_Annots";case a.PGC_ACCEPT:return"PGC_Accept";case a.LIMITS:return"limits";case a.DELETE_COLLABORATOR:return"DeleteCollaborators";case a.PATCH_COLLABORATOR:return"PatchCollaborators";case a.PENDING_ACCESS_REQ:return"PendingAccessRequests";case a.MANAGE_ACCESS_REQ:return"ManageAccessRequest";default:return""}return""}}}}]);
//# sourceMappingURL=private/dc-discovery.75f2d16344b0226d6f01.map