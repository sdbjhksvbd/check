/*! For license information please see 867.867.5f6365d9b047786367e5.js.LICENSE.txt */
(self.webpackChunkremote_manage_config_page=self.webpackChunkremote_manage_config_page||[]).push([[867],{23647:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>q});var n=r(30168),o=r(12650),a=r.n(o),s=r(97026),c=r.n(s),l=r(96486),i=r(25947),u=r(97212),m=r(95414),p=r.n(m),d=r(66206),E=r.n(d),g=r(6472),h=r.n(g),O=r(39839);const b="webhook-domain-key",f="webhook-domain-format",R={[b]:e=>{const{isValid:t}=(0,O.TK)(e);return t},[f]:e=>{const{isValid:t}=(0,O.Ft)(e);return t}},_={type:"object",properties:{"webhook-values":{type:"array",items:{type:"object",properties:{name:{type:"string",format:b},value:{type:"string",format:f}}}}}};var v=r(79674);const w={type:"HorizontalLayout",elements:[{type:"FormRows",scope:"#/properties/webhook-values",options:{customComponentProps:{validators:[O.TK,O.Ft],placeholder:["e.g. Webhook_1","e.g. https:\\/\\/(.*\\.|)company.com\\/?.*"],headers:["Name","Value"],labelsForScreenReader:["Webhook name required","Webhook value required"],deleteConfirmationModal:{title:v.X.WEBHOOK_ALLOW_LIST.DELETE_CONFIRMATION_MODAL_TITLE,content:v.X.WEBHOOK_ALLOW_LIST.DELETE_CONFIRMATION_MODAL_CONTENT}},suiComponentProps:{addLabel:v.X.WEBHOOK_ALLOW_LIST.ADD_WEBHOOK_BTN_LABEL}}}]};var L=r(4942),y=r(17673),k=r(956);const T="allowlist.";var S=r(88100);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,L.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}let C={records:[],errors:[]};const P=async e=>{if(200!==e.status)return(async e=>{const t=await e.json();return null!=t&&t.messages.length&&t.messages.filter((e=>"ERROR"===e.type)).forEach((e=>{e.text&&C.errors.push(e.text)})),C})(e);try{const t=await e.json(),{content:r}=null==t?void 0:t.entry[0];return r&&(C={records:[],errors:[]},C.records=(e=>{const t=[];return Object.keys(e).filter((t=>t.startsWith(T)&&""!==e[t])).forEach((r=>{const n=r.split(".")[1];t.push({name:n,value:e[r]})})),t})(r)),C}catch(e){throw new Error(e)}};var j=r(2249),A=r(66070);const x={CONTAINER:"Container",LEARN_MORE_LINK:"LearnmoreLink",WAITSPINNER:"Waitspinner",ERROR_MSG:"ErrorMessage"};(0,j.normalizeDataTestIds)({remoteAppName:A.KH,compName:"WebhookAllowList",testIds:x});const W=x;var F,D,M,K=r(72361);const X=c().div(F||(F=(0,n.Z)(["\n    max-width: 960px;\n    padding: 30px 20px 20px 20px;\n    background-color: ",";\n    box-shadow: ",";\n    margin: 0 auto 20px;\n    display: flex;\n    flex-direction: column;\n"])),(0,i.pick)({enterprise:i.variables.backgroundColor,prisma:i.variables.backgroundColorPopup}),i.variables.overlayShadow),B=c().div(D||(D=(0,n.Z)(["\n    display: flex;\n    justify-content: center;\n    margin-top: 40px;\n    margin-bottom: 40px;\n"]))),H=c()(E())(M||(M=(0,n.Z)(["\n    width: fit-content;\n    padding-right: 5px;\n"]))),q=(0,l.flowRight)([(0,K.ao)(["cloud"]),(0,K.Bv)(["edit_webhook_allow_list"])])((()=>{const[e,t]=(0,o.useState)({"webhook-values":[]}),[r,n]=(0,o.useState)(!0),[s,c]=(0,o.useState)([]);return(0,o.useEffect)((()=>{(async()=>{const{records:e,errors:r}=await(async()=>{const e=await fetch((0,u.createRESTURL)("configs/conf-alert_actions/webhook?output_mode=json",{owner:"admin",app:"alert_webhook"}),I({},k.pX));return await P(e)})();e&&e.length&&t({"webhook-values":e}),r.length&&c(r),n(!1)})()}),[]),a().createElement(a().Fragment,null,!r&&a().createElement(X,{"data-test-name":W.CONTAINER},a().createElement("p",null,v.X.WEBHOOK_ALLOW_LIST.DESCRIPTION," ",a().createElement(H,{to:(0,u.createDocsURL)("learnmore.alert.action.webhook"),openInNewContext:!0,"data-test-name":W.LEARN_MORE_LINK},v.X.COMMON.LEARN_MORE)),s.length>0&&a().createElement(g.Errors,{errorMessages:s}),!s.length&&a().createElement(h(),{schema:_,uischema:w,data:e,onSubmit:async e=>{let{data:r,successCb:n,failureCb:o}=e;const{records:a,errors:s}=await(async e=>{const{added:t,removed:r}=(e=>{let{prevSubnets:t,currSubnets:r}=e;return{added:(0,l.differenceWith)(r,t,l.isEqual),removed:(0,l.differenceWith)(t,r,l.isEqual)}})({prevSubnets:C.records,currSubnets:e["webhook-values"]}),n={},o={};let a=!1;if(r.length&&(a=!0,r.forEach((e=>{n[""+T+e.name]=""})),(0,l.set)(o,"request.remove",r.length)),t.length&&(a=!0,t.forEach((e=>{n[""+T+e.name]=e.value})),(0,l.set)(o,"request.add",t.length)),!a)return Promise.resolve({});try{const e=await fetch((0,u.createRESTURL)("configs/conf-alert_actions/webhook",{owner:"admin",app:"alert_webhook"}),I(I({},k.pX),{},{method:"POST",body:y.encode(I(I({},n),{},{output_mode:"json"}))})),a=await P(e),{errors:s}=a;return s.length||(t.length&&(0,l.set)(o,"response.added",t.length),r.length&&(0,l.set)(o,"response.removed",r.length)),S.TrackingService.trackEvent({type:"manageConfigPage.submitBtnClicked",data:o}),s.length&&S.TrackingService.trackEvent({type:"manageConfigPage.errorOnSubmit",data:{errorUseCases:a.errors.join(", ")}}),a}catch(e){return{records:null,errors:[e.message]}}})(r);(a||null!=s&&s.length)&&(s.length?o(s):(t({"webhook-values":a}),n()))},customValidators:R})),r&&a().createElement(B,{"data-test-name":W.WAITSPINNER},a().createElement(p(),{size:"medium"})))}))},72361:(e,t,r)=>{"use strict";r.d(t,{Bv:()=>g,Nj:()=>b,ZL:()=>O,ao:()=>h});var n,o=r(30168),a=r(12650),s=r.n(a),c=r(97026),l=r.n(c),i=r(95931),u=r(89217),m=r(68937),p=r(79674);const d=l().div(n||(n=(0,o.Z)(["\n    margin: 25px;\n"]))),E=e=>{let{msg:t="Error loading page"}=e;return s().createElement("h2",null,t)},g=function(e){return void 0===e&&(e=[]),t=>{const r=u.o.canReadPage(e);return e=>r?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:p.X.FILTER_HOC.ERRORS.RBAC_FILTER}))}},h=function(e){return void 0===e&&(e=[]),t=>{const r=e.includes(i.N.getSplunkInstanceType());return e=>r?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:p.X.FILTER_HOC.ERRORS.SPLUNK_ENV_FILTER}))}},O=function(e){return void 0===e&&(e=[]),t=>{const r=e.includes(i.N.getOS());return e=>r?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:p.X.FILTER_HOC.ERRORS.OS_FILTER}))}},b=function(e){return void 0===e&&(e=[]),t=>{const r=e.includes(m.D.getExperienceType());return e=>r?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:p.X.FILTER_HOC.ERRORS.SPLUNK_EXPERIENCE_FILTER}))}}},46115:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=867.867.5f6365d9b047786367e5.js.map