/*! For license information please see 617.617.4a78dff269435c2f78fd.js.LICENSE.txt */
(self.webpackChunkremote_manage_config_page=self.webpackChunkremote_manage_config_page||[]).push([[617],{86978:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>K});var o=n(4942),r=n(12650),a=n.n(r),s=n(96486),i=n(6472),l=n(95414),c=n.n(l),p=n(72361),u=n(2249);const m={LOOKUP_HOST:{LABEL:"Choose logs from this host *",DESCRIPTION:"Enter IP address or host name, for example 10.11.39 or foo.ad.yourdomain.com. To collect logs from your local machine, edit the existing entry called 'localhost'.",BUTTON_LABEL:"Find logs..."},ADDITIONAL_HOSTS:{LABEL:"Collect the same set of logs from additional hosts",DESCRIPTION:"Enter a comma-separated list of host names or IP addresses."},TRANSFER_LIST:{LABEL:"Logs",SOURCE_LABEL:"Available log(s)",SOURCE_DESCRIPTION:"Select the Windows Event Logs you want to index from the list.",TARGET_LABEL:"Selected log(s)"},INDEX:{LABEL:"Index",SELECT_LABEL:"Set the destination index for this source"},ERRORS:{FETCH_AVAILABLE_LOGS_NOT_FOUND:e=>"Failed to fetch data: Unable to get wmi classes from host '"+e+"'. This host may not be reachable or WMI may be misconfigured."}};(0,u.localizeMessages)(m);var d=n(39839),E=n(66070);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const y={CONTAINER:"Container",WAITSPINNER:"WaitSpinner",ERROR_MSG:"ErrorMessage"};(0,u.normalizeDataTestIds)({remoteAppName:E.KH,compName:"WinELC",testIds:y});const f=y;var L,b,S,R=n(27626),h=n(30168),w=n(97026),I=n.n(w),T=n(25947);const v=I().div(L||(L=(0,h.Z)(["\n    max-width: 960px;\n    padding: 30px 20px 20px 20px;\n    background-color: ",";\n    box-shadow: ",";\n    margin: 0 auto 20px;\n    display: flex;\n    flex-direction: column;\n"])),(0,T.pick)({enterprise:T.variables.backgroundColor,prisma:T.variables.backgroundColorPopup}),T.variables.overlayShadow),_=I().div(b||(b=(0,h.Z)(["\n    display: flex;\n    justify-content: flex-end;\n    border-top: 1px solid #ccc;\n    padding: 20px;\n"]))),P=I().div(S||(S=(0,h.Z)(["\n    display: flex;\n    justify-content: center;\n    margin-top: 40px;\n    margin-bottom: 40px;\n"])));var N=n(17563),C=n(97212),j=n(956);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const D=(0,C.createRESTURL)("data/inputs/win-event-log-collections"),k=(0,C.createRESTURL)("data/indexes"),H=(0,C.createRESTURL)("admin/win-wmi-enum-eventlogs"),B=(0,C.createRESTURL)("admin/win-alleventlogs"),F={app:"",owner:""},U=async e=>{const t=await fetch(D+"/"+e+"?"+(0,N.stringify)({output_mode:"json"}),x({},j.pX)),n=await t.json();if(200===t.status){const{name:e="",lookup_host:t="",logs:o=[],index:r="default",hosts:a=""}=(0,s.get)(n,"entry[0].content",{}),{app:i,owner:l}=(0,s.get)(n,"entry[0].acl",{});return F.app=i,F.owner=l,{name:e,lookupHost:t,additionalHosts:a,index:{label:r,value:r},logsList:{targetItemsList:o}}}throw new Error((0,d.IG)(n))},G=async()=>{const e=k+"?"+(0,N.stringify)(d.$t),t=await fetch(e,x({},j.pX)),n=await t.json();if(200===t.status)return[{label:"default",value:"default"},...(n.entry||[]).map((e=>({label:e.name,value:e.name})))];throw new Error((0,d.IG)(n))},Z=async e=>{let{entity:t,lookupHost:n}=e;const o={output_mode:"json"};t===E.Np?(o.sort_key="importance",o.sort_dir="asc",o.sort_mode="num"):o.server=n;const r=(t===E.Np?B:H+"/"+n)+"?"+(0,N.stringify)(x({},o)),a=await fetch(r,x({},j.pX)),i=await a.json();if(200===a.status)return t===E.Np?((null==i?void 0:i.entry)||[]).map((e=>e.name)):(0,s.get)(i,"entry[0].content.logs",[]);throw new Error((0,d.IG)(i))};var X=n(8513);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}const K=(0,s.flowRight)([(0,p.ZL)(["Windows"]),(0,p.ao)(["cmp"]),(0,p.Bv)(["edit_win_eventlogs"])])((e=>{let{entity:t}=e;const[n,l]=(0,r.useState)(!0),[p,u]=(0,r.useState)(!1),[g,y]=(0,r.useState)(void 0),[L,b]=(0,r.useState)({}),[S,h]=(0,r.useState)({}),[w,I]=(0,r.useState)([]),T=async(e,n)=>{let{refreshDataSources:o}=n;I([]),u(!0);let r=[];try{r=await Z({entity:t,lookupHost:e})}catch(e){I([e.message])}finally{u(!1),o([["logsList",r]])}};(0,r.useEffect)((()=>{t?(async()=>{let e,n=[],r=[];try{[e,n]=await(async e=>Promise.all([U(e),G()]))(t);try{r=await Z({entity:t,lookupHost:e.lookupHost})}catch(t){throw e.logsList={targetItemsList:[]},t}}catch(e){I([e.message])}finally{y(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:t},e)),b(function(e){return void 0===e&&(e=[]),{type:"object",properties:{name:{type:"string"},lookupHost:{type:"string",description:m.LOOKUP_HOST.DESCRIPTION},logsList:{type:"object"},additionalHosts:{type:"string",description:m.ADDITIONAL_HOSTS.DESCRIPTION},index:e.length?{type:"object",enum:e}:{}},required:["lookupHost"]}}(n)),h((e=>{let{dataSource:t,handleFindLogsButtonClick:n}=e;return{type:"VerticalLayout",elements:[{type:"Control",scope:"#/properties/name",label:"Name",rule:O({},(0,d.LD)()),options:{suiControlGroupProps:O({},(0,d.bY)())}},{type:"InputButtonGroup",scope:"#/properties/lookupHost",label:m.LOOKUP_HOST.LABEL,rule:O({},(0,d.wR)({propertyName:"name",propertyValue:E.Np})),options:{suiControlGroupProps:O({},(0,d.bY)()),customComponentProps:{inputProps:{},buttonProps:{label:m.LOOKUP_HOST.BUTTON_LABEL,onClick:n}}}},{type:"TransferList",scope:"#/properties/logsList",label:m.TRANSFER_LIST.LABEL,options:{suiControlGroupProps:O({},(0,d.bY)()),customComponentProps:{source:{label:m.TRANSFER_LIST.SOURCE_LABEL,description:m.TRANSFER_LIST.SOURCE_DESCRIPTION},target:{label:m.TRANSFER_LIST.TARGET_LABEL},dataSource:t}}},{type:"Control",label:m.ADDITIONAL_HOSTS.LABEL,scope:"#/properties/additionalHosts",rule:O({},(0,d.wR)({propertyName:"name",propertyValue:E.Np})),options:{suiControlGroupProps:O({},(0,d.bY)())}},{type:"Label",text:m.INDEX.LABEL},{type:"Select",scope:"#/properties/index",label:m.INDEX.SELECT_LABEL,options:{suiControlGroupProps:O({},(0,d.bY)()),suiComponentProps:{filter:!1}}}]}})({dataSource:r,handleFindLogsButtonClick:T})),l(!1)}})():window.location.href=E._J[X.iY.WinEventLogCollections]}),[]);const A=!(0,s.isEmpty)(L)&&!(0,s.isEmpty)(S);return a().createElement(a().Fragment,null,!n&&a().createElement(v,{"data-test-name":f.CONTAINER},w.length>0&&a().createElement(i.Errors,{errorMessages:w,onRequestRemove:()=>I([])}),A&&a().createElement(i.SUIFormRendererCompound,null,a().createElement("div",{style:{width:"100%",position:"relative"}},p&&a().createElement(R.Z,null),a().createElement("main",null,a().createElement(i.SUIFormRendererCompound.ErrorView,null),a().createElement(i.SUIFormRendererCompound.Form,{data:g,schema:L,uischema:S})),a().createElement("footer",null,a().createElement(_,null,a().createElement(i.SUIFormRendererCompound.ActionButtons,{onSubmit:async e=>{let{data:n,successCb:o,failureCb:r}=e;I([]),u(!0);try{await(async(e,t)=>{var n;const{app:o,owner:r}=F,a=(0,C.createRESTURL)("data/inputs/win-event-log-collections",{owner:e===E.Np?"nobody":r,app:e===E.Np?"system":o}),s={lookup_host:t.lookupHost,hosts:t.additionalHosts,index:(null==(n=t.index)?void 0:n.value)||"",logs:t.logsList.targetItemsList},i=x(x({},j.pX),{},{method:"POST",body:(0,N.stringify)(x({},s))}),l=await fetch(a+"/"+e+"?"+(0,N.stringify)({output_mode:"json"}),x({},i)),c=await l.json();if(200!==l.status)throw new Error((0,d.IG)(c))})(t,n),o()}catch(e){r([e.message])}finally{u(!1)}}})))))),n&&a().createElement(P,{"data-test-name":f.WAITSPINNER},a().createElement(c(),{size:"medium"})))}))},72361:(e,t,n)=>{"use strict";n.d(t,{Bv:()=>g,Nj:()=>f,ZL:()=>y,ao:()=>O});var o,r=n(30168),a=n(12650),s=n.n(a),i=n(97026),l=n.n(i),c=n(95931),p=n(89217),u=n(68937),m=n(79674);const d=l().div(o||(o=(0,r.Z)(["\n    margin: 25px;\n"]))),E=e=>{let{msg:t="Error loading page"}=e;return s().createElement("h2",null,t)},g=function(e){return void 0===e&&(e=[]),t=>{const n=p.o.canReadPage(e);return e=>n?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:m.X.FILTER_HOC.ERRORS.RBAC_FILTER}))}},O=function(e){return void 0===e&&(e=[]),t=>{const n=e.includes(c.N.getSplunkInstanceType());return e=>n?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:m.X.FILTER_HOC.ERRORS.SPLUNK_ENV_FILTER}))}},y=function(e){return void 0===e&&(e=[]),t=>{const n=e.includes(c.N.getOS());return e=>n?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:m.X.FILTER_HOC.ERRORS.OS_FILTER}))}},f=function(e){return void 0===e&&(e=[]),t=>{const n=e.includes(u.D.getExperienceType());return e=>n?s().createElement(t,e):s().createElement(d,null,s().createElement(E,{msg:m.X.FILTER_HOC.ERRORS.SPLUNK_EXPERIENCE_FILTER}))}}},27626:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var o=n(12650),r=n.n(o),a=n(95414),s=n.n(a),i=n(2249),l=n(66070);const c={LOADING_MSG:"LoadingMessage"};(0,i.normalizeDataTestIds)({remoteAppName:l.KH,compName:"LoadingMessage",testIds:c});const p=c;var u,m,d,E=n(79674),g=n(30168),O=n(97026),y=n.n(O),f=n(47934),L=n.n(f);const b=y().div(u||(u=(0,g.Z)(["\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    background-color: rgba(255, 255, 255, 0.5);\n    z-index: 500;\n"]))),S=y().div(m||(m=(0,g.Z)(["\n    margin: auto;\n    display: flex;\n"]))),R=y()(L())(d||(d=(0,g.Z)(["\n    margin: auto;\n    font-size: 16px;\n    margin-bottom: 4px;\n    margin-left: 2px;\n"]))),h=()=>r().createElement(b,{"data-test-name":p.LOADING_MSG},r().createElement(S,null,r().createElement(s(),{size:"medium"}),r().createElement(R,null,E.X.COMMON.LOADING_MSG)))},46115:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=617.617.4a78dff269435c2f78fd.js.map