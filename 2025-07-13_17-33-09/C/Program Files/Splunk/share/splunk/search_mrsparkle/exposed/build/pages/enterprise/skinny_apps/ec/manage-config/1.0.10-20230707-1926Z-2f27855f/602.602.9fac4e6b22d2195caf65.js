/*! For license information please see 602.602.9fac4e6b22d2195caf65.js.LICENSE.txt */
(self.webpackChunkremote_manage_config_page=self.webpackChunkremote_manage_config_page||[]).push([[602],{87209:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>q});var n=r(30168),a=r(12650),s=r.n(a),o=r(97026),c=r.n(o),l=r(68580),i=r.n(l),d=r(66206),E=r.n(d),u=r(48689),_=r.n(u),m=r(95414),p=r.n(m),R=r(97212),O=r(6472),S=r.n(O),D=r(25947),h=r(96486),b=r(4942),T=r(17673),g=r(956);const N="dashboards.trusted.domains",A="dashboards_trusted_domain.";var f=r(88100);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}let y={records:[],errors:[]};const v=async e=>{if(200!==e.status)return(async e=>{const t=await e.json();return null!=t&&t.messages.length&&t.messages.filter((e=>"ERROR"===e.type)).forEach((e=>{e.text&&y.errors.push(e.text)})),y})(e);try{const t=await e.json(),{content:r}=null==t?void 0:t.entry[0];return r&&(y={records:[],errors:[]}),[y.records,y.dashboardFlags]=(e=>{const t=[],r={enforce_dashboards_csp:null,enable_dashboards_external_content_restriction:null,enable_dashboards_redirection_restriction:null},n=Object.keys(r);return Object.keys(e).forEach((a=>{if(-1!==n.indexOf(a)&&(t=>{const n=e[t];r[t]="1"===n||"true"===n})(a),a.startsWith(A)&&""!==e[a]){const r=a.split(".")[1];t.push({name:r,value:e[a]})}})),[t,r]})(r),y}catch(e){throw new Error(e)}};var C=r(39839);const w="dashboard-url-key",M="dashboard-url-format",x={[w]:e=>{const{isValid:t}=(0,C.EM)(e);return t},[M]:e=>{const{isValid:t}=(0,C.t3)(e);return t}},P={type:"object",properties:{"dashboard-values":{type:"array",items:{type:"object",properties:{name:{type:"string",format:w},value:{type:"string",format:M}}}}}};var j=r(79674);const k={type:"HorizontalLayout",elements:[{type:"FormRows",scope:"#/properties/dashboard-values",options:{customComponentProps:{validators:[C.EM,C.t3],placeholder:["e.g. splunk","e.g. https://www.splunk.com"],headers:[j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.HEADER.NAME,j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.HEADER.VALUE],labelsForScreenReader:[j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.LABEL_SCREEN_READER.NAME,j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.LABEL_SCREEN_READER.VALUE],deleteConfirmationModal:{title:j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.DELETE_CONFIRMATION_MODAL_TITLE,content:j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.DELETE_CONFIRMATION_MODAL_CONTENT}},suiComponentProps:{addLabel:j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.ADD_DOMAIN_BTN_LABEL}}}]};var U=r(2249),F=r(66070);const X={CONTAINER:"Container",LEARN_MORE_LINK:"LearnmoreLink",WAITSPINNER:"Waitspinner"};(0,U.normalizeDataTestIds)({remoteAppName:F.KH,compName:"DashboardsTrustedDomainsList",testIds:X});const B=X;var H,V,W=r(72361);const K=c().div(H||(H=(0,n.Z)(["\n    display: flex;\n    justify-content: center;\n    margin-top: 40px;\n    margin-bottom: 40px;\n"]))),Z=c().div(V||(V=(0,n.Z)(["\n    max-width: 960px;\n    padding: 30px 20px 20px 20px;\n    background-color: ",";\n    box-shadow: ",";\n    margin: 0 auto 20px;\n    display: flex;\n    flex-direction: column;\n"])),(0,D.pick)({enterprise:D.variables.backgroundColor,prisma:D.variables.backgroundColorPopup}),D.variables.overlayShadow),q=(0,h.flowRight)([(0,W.ao)(["cloud"]),(0,W.Bv)(["edit_dashboard_allow_list"])])((()=>{const[e,t]=(0,a.useState)({"dashboard-values":[]}),[r,n]=(0,a.useState)([]),[o,c]=(0,a.useState)(""),[l,d]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(async()=>{const{records:e,errors:r,dashboardFlags:a}=await(async()=>{const e=await fetch((0,R.createRESTURL)("web-features/feature:dashboards_csp?output_mode=json",{owner:"nobody",app:"system"}),L({},g.pX));return await v(e)})();c((e=>{let t="";return!1===e.enable_dashboards_external_content_restriction&&!1===e.enable_dashboards_redirection_restriction?t="LOAD_AND_REDIRECT_NOT_ENFORCED":!1===e.enable_dashboards_external_content_restriction?t="CONTENT_LOAD_NOT_ENFORCED":!1===e.enable_dashboards_redirection_restriction?t="REDIRECT_NOT_ENFORCED":!1===e.enforce_dashboards_csp&&"boolean"!=typeof e.enable_dashboards_external_content_restriction&&(t="CSP_NOT_ENFORCED"),t})(a)),e&&e.length&&t({"dashboard-values":e}),r.length&&n(r),d(!1)})()}),[]),s().createElement(s().Fragment,null,!l&&s().createElement(Z,{"data-test-name":B.CONTAINER},!!o&&s().createElement(_(),{appearance:"fill",type:"warning"},j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST[o],s().createElement(E(),{to:(0,R.createDocsURL)(N),openInNewContext:!0},j.X.COMMON.LEARN_MORE)),s().createElement("p",null,j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.DESCRIPTION,s().createElement(E(),{to:(0,R.createDocsURL)(N),openInNewContext:!0,"data-test-name":B.LEARN_MORE_LINK},j.X.COMMON.LEARN_MORE)),s().createElement(i(),null,j.X.DASHBOARDS_TRUSTED_DOMAINS_LIST.TRUSTED_DOMAINS),r.length>0&&s().createElement(O.Errors,{errorMessages:r}),!r.length&&s().createElement(S(),{schema:P,uischema:k,data:e,onSubmit:async e=>{let{data:r,successCb:n,failureCb:a}=e;const{records:s,errors:o}=await(async e=>{const{added:t,removed:r}=(e=>{let{prevDomains:t,currDomains:r}=e;return{added:(0,h.differenceWith)(r,t,h.isEqual),removed:(0,h.differenceWith)(t,r,h.isEqual)}})({prevDomains:y.records,currDomains:e["dashboard-values"]}),n={},a={};let s=!1;if(r.length&&(s=!0,r.forEach((e=>{n[""+A+e.name]=""})),(0,h.set)(a,"request.remove",r.length)),t.length&&(s=!0,t.forEach((e=>{n[""+A+e.name]=e.value})),(0,h.set)(a,"request.add",t.length)),!s)return Promise.resolve({});try{const e=await fetch((0,R.createRESTURL)("web-features/feature:dashboards_csp",{owner:"nobody",app:"system"}),L(L({},g.pX),{},{method:"POST",body:T.encode(L(L({},n),{},{output_mode:"json"}))})),s=await v(e),{errors:o}=s;return o.length||(t.length&&(0,h.set)(a,"response.added",t.length),r.length&&(0,h.set)(a,"response.removed",r.length)),f.TrackingService.trackEvent({type:"manageConfigPage.submitBtnClicked",data:a}),o.length&&f.TrackingService.trackEvent({type:"manageConfigPage.errorOnSubmit",data:{errorUseCases:s.errors.join(", ")}}),s}catch(e){return{records:null,errors:[e.message]}}})(r);(s||null!=o&&o.length)&&(o.length?a(o):(t({"dashboard-values":s}),n()))},customValidators:x})),l&&s().createElement(K,{"data-test-name":B.WAITSPINNER},s().createElement(p(),{size:"medium"})))}))},72361:(e,t,r)=>{"use strict";r.d(t,{Bv:()=>p,Nj:()=>S,ZL:()=>O,ao:()=>R});var n,a=r(30168),s=r(12650),o=r.n(s),c=r(97026),l=r.n(c),i=r(95931),d=r(89217),E=r(68937),u=r(79674);const _=l().div(n||(n=(0,a.Z)(["\n    margin: 25px;\n"]))),m=e=>{let{msg:t="Error loading page"}=e;return o().createElement("h2",null,t)},p=function(e){return void 0===e&&(e=[]),t=>{const r=d.o.canReadPage(e);return e=>r?o().createElement(t,e):o().createElement(_,null,o().createElement(m,{msg:u.X.FILTER_HOC.ERRORS.RBAC_FILTER}))}},R=function(e){return void 0===e&&(e=[]),t=>{const r=e.includes(i.N.getSplunkInstanceType());return e=>r?o().createElement(t,e):o().createElement(_,null,o().createElement(m,{msg:u.X.FILTER_HOC.ERRORS.SPLUNK_ENV_FILTER}))}},O=function(e){return void 0===e&&(e=[]),t=>{const r=e.includes(i.N.getOS());return e=>r?o().createElement(t,e):o().createElement(_,null,o().createElement(m,{msg:u.X.FILTER_HOC.ERRORS.OS_FILTER}))}},S=function(e){return void 0===e&&(e=[]),t=>{const r=e.includes(E.D.getExperienceType());return e=>r?o().createElement(t,e):o().createElement(_,null,o().createElement(m,{msg:u.X.FILTER_HOC.ERRORS.SPLUNK_EXPERIENCE_FILTER}))}}},46115:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=602.602.9fac4e6b22d2195caf65.js.map