(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{"views/shared/ResultsTableDrillDownPopTart":function(i,e,t){var s,l;s=[t("require/underscore"),t("shim/jquery"),i,t("views/shared/PopTart"),t("models/shared/TimeRange"),t("util/time"),t("shim/splunk.util"),t("stubs/i18n")],void 0===(l=function(i,e,t,s,l,a,n,r){return s.extend({moduleId:t.i,className:"dropdown-menu dropdown-menu-medium",initialize:function(t){s.prototype.initialize.apply(this,arguments),this.model.spanTimeRange=new l,this.constraints={keys:[],values:[]},this.fields=this.model.results.getDataFields(),this.isTimeSpan=i.has(this.options.clickMeta,"_span"),this.fieldClicked=i.has(this.options.clickMeta,"name2")?this.options.clickMeta.name2:this.options.clickMeta.name,this.fieldValueClicked=i.has(this.options.clickMeta,"value2")?this.options.clickMeta.value2:this.options.clickMeta.value,this.fieldMetadataResults=this.convertResultFieldsToMetadata(),this.metaDataHasGroupByOrSplitBy=!i.isUndefined(i.find(this.fieldMetadataResults,(function(i){return i.groupby_rank||i.splitby_field}))),this.fieldClickedMetaData=this.fieldMetadataResults[this.fieldClicked]||{},this.cellDrilldownable=this.isCellDrilldownable(),this.hasRenderedDeferred=e.Deferred(),this.cellDrilldownable&&(this.splitbyField=this.fieldClickedMetaData?this.fieldClickedMetaData.splitby_field:void 0,this.splitbyValue=this.splitbyField?this.fieldClickedMetaData.splitby_value:void 0,!this.isTimeSpan||this.splitbyField||this.splitbyValue||(this.splitbyField=this.fieldClicked,this.splitbyValue=this.fieldValueClicked),this.fieldClickedRank=this.metaDataHasGroupByOrSplitBy?this.fieldClickedMetaData.groupby_rank:this.fields.indexOf(this.fieldClicked).toString()),this.metaDataHasGroupByOrSplitBy?this.buildConstraintsByGroupBy():this.buildConstraintsByFieldIndex(),this.isTimeSpan&&(this.timeSpanDfd=this.model.spanTimeRange.save({earliest:this.options.clickMeta.value,latest:(parseFloat(this.options.clickMeta.value)+this.options.clickMeta._span).toFixed(3)}))},convertResultFieldsToMetadata:function(){var e={},t=this.model.results.get("fields");return i(t).each((function(t){i.isObject(t)&&(e[t.name]=i(t).omit("name"))})),e},stripClickMetaToTimeRange:function(){return i.extend(i(this.options.clickMeta).omit("name2","value2"),{rowContext:i(this.options.clickMeta).pick("row._time")})},stripClickMetaToColumnOnly:function(){var t=this.options.clickMeta;return t.name2?i(t).omit("name","value","_span"):e.extend(!0,{},this.options.clickMeta)},isCellDrilldownable:function(){if("row"===this.options.clickMeta.type||"_time"===this.fieldClicked)return!1;if(this.metaDataHasGroupByOrSplitBy){if(!this.fieldClickedMetaData||!this.fieldClickedMetaData.groupby_rank&&!this.fieldClickedMetaData.splitby_field)return!1}else if(this.fieldClickedMetaData){var i=this.fieldClickedMetaData.type_special;if("count"===i||"percent"===i)return!1}return!0},buildConstraintsByGroupBy:function(){for(var i=0;i<this.fields.length;i++){var e,t=this.fields[i],s=this.fieldMetadataResults[t];if(s&&s.groupby_rank)if(e=parseInt(s.groupby_rank,10),!this.fieldClickedRank||e<this.fieldClickedRank)this.constraints.keys.push(t),this.constraints.values.push(this.options.clickMeta.rowContext["row."+t]);else{if(!this.fieldClickedRank||e!=this.fieldClickedRank)break;this.constraints.keys.push(t),this.constraints.values.push(this.fieldValueClicked)}}},buildConstraintsByFieldIndex:function(){for(var e=i.isUndefined(this.fieldClickedRank)?this.fields.length:this.fieldClickedRank,t=0;t<e;t++){var s=this.fields[t];if(this.fieldMetadataResults&&this.fieldMetadataResults[s]){var l=this.fieldMetadataResults[s].type_special;if("count"===l||"percent"===l)continue}this.constraints.keys.push(s),this.constraints.values.push(this.options.clickMeta.rowContext["row."+s])}t==this.fieldClickedRank&&(this.constraints.keys.push(this.fields[t]),this.constraints.values.push(this.fieldValueClicked))},events:{"click .time_span":function(e){var t=i.extend({},this.options.clickMeta,{type:"row"});this.fieldDrilldown(e,t)},"click .time_span_reporting":function(i){this.fieldDrilldown(i,this.stripClickMetaToTimeRange(),{stripReportsSearch:!1})},"click .splitby_curr_inc_cell":function(i){this.fieldDrilldown(i,this.options.clickMeta)},"click .curr_exc_cell":function(i){this.fieldDrilldown(i,this.stripClickMetaToColumnOnly(),{stripReportsSearch:!1,negate:!0})},"click .curr_inc_val":function(i){var e=this.stripClickMetaToColumnOnly(),t=e.name2||e.name,s=t&&this.fieldMetadataResults[t];s&&s.hasOwnProperty("groupby_rank")||this.cellDrilldownable||(e.type="row"),this.fieldDrilldown(i,e)},"click .curr_exc_val":function(i){var e=this.stripClickMetaToColumnOnly(),t=e.name2||e.name,s=t&&this.fieldMetadataResults[t];s&&s.hasOwnProperty("groupby_rank")||(e.type="row"),this.fieldDrilldown(i,e,{negate:!0})},"click .only_val":function(i){this.fieldDrilldown(i,this.stripClickMetaToColumnOnly(),{newSearch:!0})},"click .curr_inc_con":function(i){this.fieldDrilldown(i,this.options.clickMeta,{fields:this.constraints.keys,values:this.constraints.values})},"click .curr_exc_con":function(i){this.fieldDrilldown(i,this.options.clickMeta,{fields:this.constraints.keys,values:this.constraints.values,negate:!0})}},fieldDrilldown:function(i,t,s){i.preventDefault(),(s=s||{}).drilldownNewTab=e(i.currentTarget).hasClass("secondary-link"),this.trigger("drilldown",t,s),this.hide()},show:function(i,t){e.when(this.hasRenderedDeferred).then(function(){s.prototype.show.call(this,i,t)}.bind(this))},render:function(){return e.when(this.timeSpanDfd).then(function(){this.$el.html(s.prototype.template_menu);var e,t=!this.model.spanTimeRange.isRangeSnappedToSeconds(),l=t?"YYYY-MM-dd HH:mm:ss.TTT":"YYYY-MM-dd HH:mm:ss",o=r.format_date(a.isoToDateObject(this.model.spanTimeRange.get("earliest_iso")),l),c=r.format_date(a.isoToDateObject(this.model.spanTimeRange.get("latest_iso")),l);this.isTimeSpan?(this.$el.addClass("time-span-drilldown"),t&&this.$el.removeClass("dropdown-menu-medium").addClass("dropdown-menu-wide"),e=this.cellDrilldownable?this.splitby_cell_template:this.time_span_row_template):e=this.cellDrilldownable?this.splitbyField?this.splitby_cell_template:this.cell_template:this.row_template;var d=this.compileTemplate(e);this.$el.append(d({_:i,showConstraints:"0"!=this.fieldClickedRank&&!i.isEmpty(this.constraints.keys),constraintKeys:this.constraints.keys,constraintValues:this.constraints.values,earliest:o,latest:c,isTimeSpan:this.isTimeSpan,splitbyField:this.splitbyField,splitbyValue:this.splitbyValue,fieldClicked:this.fieldClicked,fieldValueClicked:this.fieldValueClicked,splunkUtil:n})),this.hasRenderedDeferred.resolve()}.bind(this)),this},time_span_row_template:'                <ul>                    <li class="info">                        <%- splunkUtil.sprintf("%s to %s", earliest, latest) %>                    </li>                    <li>                        <a class="time_span primary-link" href="#"><%- _("View events").t() %></a>                        <a class="time_span secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="time_span_reporting primary-link" href="#"><%- _("Narrow to this time range").t() %></a>                        <a class="time_span_reporting secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                </ul>            ',splitby_cell_template:'                <% var text = splunkUtil.sprintf("%s = %s", splitbyField, splitbyValue); %>                <ul>                    <li class="info">                        <span class="field-value" title="<%- text %>"><%- text %></span>                    </li>                    <li>                        <a class="curr_exc_cell primary-link" href="#"><%- _("Exclude from results").t() %></a>                        <a class="curr_exc_cell secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li class="info">                        <% var splitText; %>                        <% if (isTimeSpan) { %>                            <% splitText = splunkUtil.sprintf("%s to %s", earliest, latest) %>                        <% } else { %>                            <% splitText = splunkUtil.sprintf("%s = %s", constraintKeys[0], constraintValues[0]) %>                        <% } %>                        <span class="field-value" title="<%- splitText %>"><%- splitText %></span>                        <span class="field-value" title="<%- text %>"><%- text %></span>                    </li>                    <li>                        <a class="splitby_curr_inc_cell primary-link" href="#"><%- _("View events").t() %></a>                        <a class="splitby_curr_inc_cell secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                </ul>            ',row_template:'                <ul>                <% if (showConstraints) { %>                    <li class="info">                    <% for(var i = 0; i < constraintKeys.length; i++) { %>                        <%                            var key = constraintKeys[i],                                value = constraintValues[i],                                text = splunkUtil.sprintf("%s = %s", key, _.isArray(value) ? value.join(" | ") : value);                        %>                        <span class="field-value" title="<%- text %>"><%- text %></span>                    <% } %>                    </li>                <% } %>                    <li>                        <a class="curr_inc_val primary-link" href="#"><%- _("View events").t() %></a>                        <a class="curr_inc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                <% if (showConstraints) { %>                    <li>                        <a class="curr_exc_val primary-link" href="#"><%- _("Other events").t() %></a>                        <a class="curr_exc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                <% } %>                </ul>            ',cell_template:'                <ul>                <% if (fieldClicked) { %>                    <li class="info">                        <% var fieldInfoText = splunkUtil.sprintf("%s = %s", fieldClicked, fieldValueClicked); %>                        <span class="field-value" title="<%- fieldInfoText %>"><%- fieldInfoText %>                    </li>                <% } %>                                    <li>                        <a class="curr_inc_val primary-link" href="#"><%- _("View events").t() %></a>                        <a class="curr_inc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="curr_exc_val primary-link" href="#"><%- _("Other events").t() %></a>                        <a class="curr_exc_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="curr_exc_cell primary-link" href="#"><%- _("Exclude from results").t() %></a>                        <a class="curr_exc_cell secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="only_val primary-link" href="#"><%- _("New search").t() %></a>                        <a class="only_val secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                                <% if (showConstraints) { %>                    <li class="info">                    <% for(var i = 0; i < constraintKeys.length; i++) { %>                        <%                            var key = constraintKeys[i],                                value = constraintValues[i],                                text = splunkUtil.sprintf("%s = %s", key, _.isArray(value) ? value.join(" | ") : value);                        %>                        <span class="field-value" title="<%- text %>"><%- text %></span>                    <% } %>                    </li>                    <li>                        <a class="curr_inc_con primary-link" href="#"><%- _("View events").t() %></a>                        <a class="curr_inc_con secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                    <li>                        <a class="curr_exc_con primary-link" href="#"><%- _("Other events").t() %></a>                        <a class="curr_exc_con secondary-link" href="#"><i class="icon-external"></i></a>                    </li>                <% } %>                </ul>            '})}.apply(e,s))||(i.exports=l)},"views/shared/ResultsTableDrilldown":function(i,e,t){var s,l;s=[t("shim/jquery"),t("require/underscore"),i,t("views/shared/results_table/ResultsTableMaster"),t("views/shared/ResultsTableDrillDownPopTart"),t("views/shared/delegates/Modalize"),t("util/keyboard")],void 0===(l=function(i,e,t,s,l,a,n){return s.extend({moduleId:t.i,initialize:function(){this.options.splitHighlight=!1,this.children.modalize=new a({el:this.el,tbody:"tbody"}),this.model.state.set("isModalized",!1),this.pendingUpdate=!1,s.prototype.initialize.call(this,this.options)},events:i.extend({},s.prototype.events,{"keydown tbody tr":function(e){if(e.which===n.KEYS.TAB&&this.model.state.get("isModalized")){var t="row"===this.model.config.get("display.statistics.drilldown");n.handleCircularTabbing(i(e.target).closest("tr"),e,t)}}}),startListening:function(){s.prototype.startListening.apply(this,arguments),this.listenTo(this.children.modalize,"unmodalize",(function(){this.model.state.set("isModalized",!1),this.pendingUpdate&&(this.pendingUpdate=!1,this.invalidate("updateViewPass"))})),this.listenTo(this.model.state,"change:isModalized",(function(i,e){e||(this.children.tableDock&&this.children.tableDock.enable(),this.children.modalize.debouncedCleanup())}))},deactivate:function(i){return this.active?(this.model.state.set("isModalized",!1),this.pendingUpdate=!1,s.prototype.deactivate.apply(this,arguments)):s.prototype.deactivate.apply(this,arguments)},emitDrilldownEvent:function(t){var s,a,n,r=i(t.originalEvent.target),o="row"===t.type,c=!1;if(o?(s=r.closest("tr"),a=r.is("tr")?r.find("td[data-cell-index]").first():r.closest("td")):a=s=r,this.children.resultsTableDrillDownPopTart){var d=this.children.resultsTableDrillDownPopTart.shown;if(this.children.resultsTableDrillDownPopTart.hide(),this.children.resultsTableDrillDownPopTart.remove(),this.stopListening(this.children.resultsTableDrillDownPopTart),delete this.children.resultsTableDrillDownPopTart,d)return}this.model.state.get("isModalized")||(this.model.state.set("isModalized",!0),this.children.tableDock&&this.children.tableDock.disable(),this.children.modalize.debouncedShow(t.rowIndex)),o||(c=(n=i.trim(r.text()))&&!r.children().length),c&&(a.html(i("<span>").text(n)),a=a.find("span")),this.children.resultsTableDrillDownPopTart=new l({clickMeta:t,onHiddenRemove:!0,model:{application:this.model.application,results:this.model.searchData},scrollContainer:a.closest(".results-table"),ignoreToggleMouseDown:!0}),c&&this.listenToOnce(this.children.resultsTableDrillDownPopTart,"hidden",(function(){r.text(n)})),this.children.resultsTableDrillDownPopTart.render().appendTo(i("body")).show(a,{$toggle:s}),this.listenTo(this.children.resultsTableDrillDownPopTart,"drilldown",e.bind(this.trigger,this,"drilldown"))},updateView:function(){this.model.state.get("isModalized")?this.pendingUpdate=!0:s.prototype.updateView.apply(this,arguments)}})}.apply(e,s))||(i.exports=l)}}]);