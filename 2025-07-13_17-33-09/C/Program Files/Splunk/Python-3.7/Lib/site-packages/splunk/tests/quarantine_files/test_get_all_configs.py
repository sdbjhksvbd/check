import unittest
import os
from splunk.quarantine_files.configs import get_all_configs
from splunk.file_writing_utils import write_path, delete_path
try:
    from unittest.mock import patch
    from unittest.mock import MagicMock
except ImportError:
    from mock import patch
    from mock import MagicMock

class TestGetAllConfigs(unittest.TestCase):
    @patch('splunk.rest.splunk_web_requests.get_quarantine_files_settings',
        MagicMock(return_value={ "enable_unsupported_hotlinked_imports": True, "enable_jQuery2": True }))
    def test_configs_count(self):
        configs = get_all_configs.get_all_configs(None)
        self.assertEqual(len(configs), 2)

if __name__ == '__main__':
    unittest.main()
