var WSB;(function(n){function p(n,t){return n===t?!0:n&&t?g(n.attributes,t.attributes)&&w(n.parameters,t.parameters):!1}function w(t,i){return t===i?!0:t&&i?t.placeholderText==i.placeholderText&&t.lightGleamDataOrUrl==i.lightGleamDataOrUrl&&t.darkGleamDataOrUrl==i.darkGleamDataOrUrl&&t.gleamSize==i.gleamSize&&t.win11ShowForMillis==i.win11ShowForMillis&&t.targetSurface==i.targetSurface&&t.gleamAltText==i.gleamAltText&&t.gleamClickEndpoint==i.gleamClickEndpoint&&t.gleamTooltip==i.gleamTooltip&&(!n.config.msbDsbCheckExpireInGleamDeduplicate||d(t.expirationTime,i.expirationTime)):!1}function b(n,t){return n===t?!0:n&&t?(n===null||n===void 0?void 0:n.telemetryId)===(t===null||t===void 0?void 0:t.telemetryId):!1}function d(t,i){const r=t instanceof Date?t.getTime():typeof t=="number"?t:undefined,u=i instanceof Date?i.getTime():typeof i=="number"?i:undefined;if(typeof r=="number"&&typeof u=="number"){const t=Math.abs(r-u);return n.config.msbDsbLogGleamDeduplicate&&_w.bfbWsbTel&&bfbWsbTel.logValue("GleamDedupChecking",t),t<k}return!1}function g(n,t){return n===t?!0:n&&t?n.gleamFormat==t.gleamFormat&&n.contentKey==t.contentKey:!1}function it(n){var i;const r=((i=n===null||n===void 0?void 0:n.toLowerCase())===null||i===void 0?void 0:i.indexOf("/th?"))>=0?tt:nt,t=n===null||n===void 0?void 0:n.match(r);return(t===null||t===void 0?void 0:t.length)>0?t[1]:""}function i(n){let i=undefined,r=undefined;switch(n.dsbSection){case 0:n.isFullWidthDSB?(i=420,r=236):(i=!n.isWindows11?392:424,r=!n.isWindows11?221:240);break;case 1:r=!n.isWindows11?154:96;r=!!n.isWindows11&&!!n.enbFullCta?154:r;n.isTwoCta?n.isFullWidthDSB?i=204:(i=!n.isWindows11?190:206,i=!!n.isWindows11&&!!n.enbFullCta?190:i):n.isFullWidthDSB?i=132:(i=!n.isWindows11?124:134,i=!!n.isWindows11&&!!n.enbFullCta?124:i);break;case 2:switch(n.dsbScenario){case t.NewsAnswer:r=92;i=128;break;case t.TrendingVideo:n.isFullWidthDSB?n.isOnLeftColumn?(i=188,r=110):(i=125,r=75):(i=!n.isWindows11?180:124,r=!n.isWindows11?102:70);break;case t.ShortVideos:i=144;r=152;break;case t.NewsTrendingTopics:i=!n.isWindows11?140:124;r=!n.isWindows11?96:70;break;case t.ArticleCarousel:case t.TrendingStories:i=!n.isWindows11?140:124;r=!n.isWindows11?100:90;break;case t.ImageFeed:case t.CustomContent:case t.CustomContent_Mega:i=!n.isWindows11?140:124;r=!n.isWindows11?170:150;break;case t.TrendingSearch:i=32;r=32;break;case t.RewardsDailySet:r=56;i=56;break;default:n.isFullWidthDSB?(i=80,r=80):(i=!n.isWindows11?86:90,r=!n.isWindows11?86:90)}}return{width:i,height:r}}function u(n,t,i,u,f=1,e=1,o=0){var s=`${t}/th?id=${n}${i?`&w=${i}`:""}${u?`&h=${u}`:""}&c=${f}&rs=${e}&p=${o}`,h=r(s);return h.styledWithDpr?h.bingImageUrl:s}function rt(n,t,u,f=1,e=1,o=0){const{width:s,height:h}=i(t);var c=`${u}/th?id=${n}${s?`&w=${s}`:""}${h?`&h=${h}`:""}&c=${f}&rs=${e}&p=${o}`,l=r(c);return l.styledWithDpr?l.bingImageUrl:c}function ut(n,t){const{width:r,height:u}=i(t);return"https://static-global-s-msn-com.akamaized.net/img-resizer/tenant/amp/entityid/".concat(`${n}?h=${u}&w=${r}&m=6`)}function ft(n){switch(n){case"TrendingSearch":return"SHTRND";case"HeroCardOfTheDay":return"SHHPIH";case"OnThisDay":return"SHODCA";case"Quiz":return"SHQZHO";case"MapIt":return"SHMIHO";case"QuoteOfTheDay":return"SHQTCA";case"WordOfTheDay":return"SHWDCA";case"WholePageTabs":return"SHWPHS";case"KC_HeroCard":return"SHKNCH";case"PersonalizedSports":return"SHSPCA";case"RelatedLocal":case"RelatedLocal_Hero":return"SHLFDH";case"RelatedLocal_CTA":return"SHLRCA";case"RelatedRecipe":return"SHRCCA";case"TrendingVideos":return"SHTVMC";case"ShortVideos":return"SVTVLP";case"TrendingImages":return"SHTIMC";case"AllImages":return"SHAIHO";case"Rewards":return"SHRWCA";case"ExploreMore":return"SHEMMC";default:return"SHDFLT"}}function s(t){return n.setBingUrlLanguageAndRegion(t,n.Host.getRegion(),n.getCurrentLanguage())}function et(n,t,i,r){const f=i.getContext("2d");f.font=r.font||`normal 14px "Segoe UI Variable Text"`;let e=t,u=0,o=0;for(let t of n){const i=f.measureText(t),n=i.width+r.extraWidthPerItem;if(u+n>r.lineWidth&&(u=0,e-=1),u+=n,e===0)break;o+=1}return o}function ot(t){return n.config.enableCopilotStringUpdate&&t==="ChatWithBing"&&(t="AskCopilot"),n.Host.getLocString(t)}function st(n,t,i,r){let u="";return n&&(u+=`${n}: 
 `),t&&(u+=`${t} 
 `),i&&(u+=`[${i}] 
 `),r&&(u+=`${r}`),u}function ht(n,t){if(!n)return"";n=n===null||n===void 0?void 0:n.match(/([^&]*)/)[0];var i=`${t}/th?id=${n}&w=16&h=16&c=1&rs=1&p=0`,u=r(i);return u.styledWithDpr?{backgroundImage:`url(${u.bingImageUrl})`,backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{backgroundImage:`url(${i})`}}function ct(n,t){return!n||n<0?"":n<1e3?`${n}`+` ${t}`:n<1e6?(n/1e3).toFixed(0)+`K ${t}`:(n/1e6).toFixed(1)+`M ${t}`}function lt(t,r,e,o,s=false,h=false,c=false,l=null,a=null,v=true){if(!t)return"";t=t===null||t===void 0?void 0:t.match(/([^&]*)/)[0];const{width:w,height:b}=a>0&&l>0?{width:l,height:a}:i({dsbSection:r,dsbScenario:e,isWindows11:n.config.useCobaltCSS,isTwoCta:s,isFullWidthDSB:c,enbFullCta:n.config.enableWin10CTA&&!c,isOnLeftColumn:v});var y=u(t,o,w,b,h?13:1);let p={backgroundImage:`url(${y})`};return f(y)?Object.assign(Object.assign({},p),{backgroundImage:`url(${y})`,backgroundSize:"cover",backgroundRepeat:"no-repeat"}):p}function at(t,r,e,o,s=false,h=false,c=false){var v,a,k;const y=t===null||t===void 0?void 0:t.ThumbnailUrl,l=t===null||t===void 0?void 0:t.ThumbnailId;if((!y||y.length===0)&&(!l||l.length===0))return"";const p=h?13:1,{width:w,height:b}=i({dsbSection:r,dsbScenario:e,isWindows11:n.config.useCobaltCSS,isTwoCta:s,isFullWidthDSB:c,enbFullCta:n.config.enableWin10CTA&&!c});if(l&&l.length!==0)k=l===null||l===void 0?void 0:l.match(/([^&]*)/)[0],v=u(k,o,w,b,p);else a=new URL(y),a.searchParams.set("w",`${w}`),a.searchParams.set("h",`${b}`),a.searchParams.set("m","5"),a.searchParams.set("c",`${p}`),v=a.toString();let d={backgroundImage:`url(${v})`};return f(v)?Object.assign(Object.assign({},d),{backgroundImage:`url(${v})`,backgroundSize:"cover",backgroundRepeat:"no-repeat"}):d}function vt(t,r,u=false,f=false,e){let o=e!==null&&e!==void 0?e:i({dsbSection:t,dsbScenario:r,isWindows11:n.config.useCobaltCSS,isTwoCta:u,isFullWidthDSB:f}).width;return o||(o=n.config.useCobaltCSS?90:86),o-=44,{maxWidth:o}}function yt(t,r,u=false,f=false,e){let o=e!==null&&e!==void 0?e:i({dsbSection:t,dsbScenario:r,isWindows11:n.config.useCobaltCSS,isTwoCta:u,isFullWidthDSB:f}).width;return o||(o=n.config.useCobaltCSS?90:86),{maxWidth:o}}function o(t,r,u,f,e,o){let s,h;if(t>0&&r>0)s=t,h=r;else{const{width:t,height:r}=i({dsbSection:u,dsbScenario:f,isWindows11:n.config.useCobaltCSS,isTwoCta:e,isFullWidthDSB:o});s=t;h=r}return{finalWidth:s,finalHeight:h}}function pt(n,t,i,e,s=false,h=false,c=false,l,a,v=false){if(!n)return"";const g=n;n=n===null||n===void 0?void 0:n.match(/([^&]*)/)[0];const{finalWidth:y,finalHeight:p}=o(l,a,t,i,s,c),nt=n.startsWith("https:"),tt=n.includes("?")?"&":"?",b=v?0:h?13:1;let w;if(nt){let n=`${g}${tt}w=${y}&h=${p}&m=5&c=${b}`;w=r(n).bingImageUrl}else w=u(n,e,y,p,b);const k=`url(${w})`;let d={backgroundImage:k,maxWidth:`${y}px`,height:`${p}px`};return f(k)?Object.assign(Object.assign({},d),{backgroundSize:"cover",backgroundRepeat:"no-repeat"}):d}function r(t){var i={bingImageUrl:t,styledWithDpr:!1};if(n.config===null||n.config===void 0?void 0:n.config.enableDPRInBingImage){const n=sj_cook.get("SRCHHPGUSR","DPR");i.bingImageUrl=`${t}${n?`&dpr=${n}`:""}`;i.styledWithDpr=!0}return i}function h(){return n.config!==undefined&&n.config.enableDPRInBingImage!==undefined&&n.config.enableDPRInBingImage&&!!sj_cook.get("SRCHHPGUSR","DPR")}function f(n){var t;return h()&&((t=n===null||n===void 0?void 0:n.toLowerCase())===null||t===void 0?void 0:t.includes("dpr="))}function wt(n,t,i,r=false,u=false,f,e){const{finalWidth:s,finalHeight:h}=o(f,e,t,i,r,u);return{backgroundImage:`url(https:${n})`,backgroundSize:`${s}px`,minWidth:`${s}px`,width:`${s}px`,height:`${h}px`}}function c(t,i){return t?i?386:266:n.config.useCobaltCSS?390:368}function bt(t,r,u=false,f=false,e,o,s){let l=n.RuntimeConfiguration.TextScaleFactor;n.config.disbaleWideForLargeTextScale&&(l=1);const v=c(f,o);let h;h=e>0?Number(e):i({dsbSection:t,dsbScenario:r,isWindows11:n.config.useCobaltCSS,isTwoCta:u,isFullWidthDSB:f}).width;let a=s>0?s:2*(n.config.useCobaltCSS?3:8);return h||(h=n.config.useCobaltCSS?90:86),h+=n.config.useCobaltCSS?4:2,Number(((v+a)/(h*l+a)).toFixed(2))}function l(){return e||(e=n.config.enableOfflineWithWeb&&n.config.webHost&&n.isBrowserOnline()?n.config.webHost:location.origin),e}async function kt(t,i,r,u){(i===null||i===void 0?void 0:i.startsWith("/"))&&(i=`${l()}${i}`);let f=n.tryParseUrl(i,!0);f.hostname===n.CMC_URL_PROD&&n.config.enableCopilotNative?(i=await n.getCopilotLaunchUrl(i,"DSBHIB"),n.Host.launchDSBUriAsync(i,r,t)):n.isMsnHost(f)?n.Host.launchDSBUriAsync(i,r,t):n.Host.launchDSBUriAsync(s(i),r,t,u)}function dt(n){return n==0||n==13||n==14||n==15||n==16||n==19}function gt(n){return n=="DSBFlipperChevronleft"||n==="DSBFlipperChevronright"}function a(n,t){if(!n||n<=0)return"";const s=new Date(n*1e3),i=Math.floor((t.valueOf()-s.valueOf())/1e3);if(i<1)return"";if(i==1)return`${i} second ago`;if(i<60)return`${i} seconds ago`;const r=Math.floor(i/60);if(r==1)return`${r} minute ago`;if(r<60)return`${r} minutes ago`;const u=Math.floor(r/60);if(u==1)return`${u} hour ago`;if(u<24)return`${u} hours ago`;const f=Math.floor(u/24);if(f==1)return`${f} day ago`;if(f<=30)return`${f} days ago`;const e=Math.floor(f/30);if(e==1)return`${e} month ago`;if(e<12)return`${e} months ago`;const o=Math.floor(e/12);return o==1?`${o} year ago`:`${o} years ago`}function ni(t,i){let r=a(t,i);if(r==="")return"";let u=r.split(" "),e=u.slice(1).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(""),f=n.Host.getLocString(e);return f?`${u[0]} ${f}`:""}function ti(){if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbMockDateTimeParam){var t=new Date(n.TestHookUrlParameters.dsbMockDateTimeParam);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t}return n.getCurrentDate()}function ii(n,t,i,r,u){SharedLogHelper.LogError(n,t,i,r,u)}function ri(t,i,r){n.LogWSBWarning(t,i,r,"BingTelemetry")}function ui(n){var t;if(!n)return"Not Valid";let i=new URL(n);return(t=i.searchParams.get("id"))!==null&&t!==void 0?t:"Not Valid"}function fi(n){return n?n===0?"30x36":"30x60":"30x36"}function ei(t){var i;const r=new Date(+t.substring(0,4),+t.substring(4,6)-1,+t.substring(6,8));return r.toLocaleDateString((i=n.getCurrentLanguage())===null||i===void 0?void 0:i.substring(0,2),{month:"short",day:"numeric"})}function v(n,t){let i=new Date(n.getTime()-n.getTimezoneOffset()*6e4+864e5*(t!==null&&t!==void 0?t:0));return i.toISOString().substring(0,10).replace(/-/g,"")}function oi(n){return Array.from({length:7},(t,i)=>v(n,-i)).sort()}function si(t){let i={campaign:n.config.moreEdgeProtocolOCID,medium:"DynamicSearchBox"};return t&&t.edgeHubAppId&&(i.hubAppId=t.edgeHubAppId),i}function hi(){if(n.VelocityKeys!==null&&n.VelocityKeys!==void 0)return n.VelocityKeys.isFeatureEnabled(43998261)}function ci(){if(n.VelocityKeys!==null&&n.VelocityKeys!==void 0)return n.VelocityKeys.isFeatureEnabled(46536486)}function li(){if(n.VelocityKeys!==null&&n.VelocityKeys!==void 0)return n.VelocityKeys.isFeatureEnabled(46111200)}function y(){if(n.VelocityKeys!==null&&n.VelocityKeys!==void 0)return n.VelocityKeys.isFeatureEnabled(44533041)}function ai(){return n.config.undocked&&y()&&n.Host.getPofLaunchUrlExist()}function vi(){if(n.VelocityKeys!==null&&n.VelocityKeys!==void 0)return n.VelocityKeys.isFeatureEnabled(48909483)}n.areDynamicSearchBoxContentEqual=p;n.isSearchAppearanceGleamTelemetryIdEqual=b;const k=18e4;const nt=new RegExp("/id/([^/?#$]*)","i"),tt=new RegExp("[?&]id=([^&#$]*)","i");n.extractThumbnailIdFromUrl=it;let t;(function(n){n[n.ImageOfTheDay=0]="ImageOfTheDay";n[n.OnThisDay=1]="OnThisDay";n[n.QuoteOfTheDay=2]="QuoteOfTheDay";n[n.WordOfTheyDay=3]="WordOfTheyDay";n[n.TrendingSearch=4]="TrendingSearch";n[n.TrendingImage=5]="TrendingImage";n[n.TrendingVideo=6]="TrendingVideo";n[n.ExploreMore=7]="ExploreMore";n[n.NewsAnswer=8]="NewsAnswer";n[n.ImageFeed=9]="ImageFeed";n[n.PersonalizedRecipes=10]="PersonalizedRecipes";n[n.RelatedLocal=11]="RelatedLocal";n[n.RelatedRecipe=12]="RelatedRecipe";n[n.RelatedShopping=13]="RelatedShopping";n[n.Rewards=14]="Rewards";n[n.KnowledgeCard=15]="KnowledgeCard";n[n.CustomContent=16]="CustomContent";n[n.ArticleCarousel=17]="ArticleCarousel";n[n.TrendingStories=18]="TrendingStories";n[n.ImageSimpleCTA=19]="ImageSimpleCTA";n[n.Others=20]="Others";n[n.NewsTrendingTopics=21]="NewsTrendingTopics";n[n.ImageAnswers=22]="ImageAnswers";n[n.CustomContent_CTA=23]="CustomContent_CTA";n[n.CustomContent_Mega=24]="CustomContent_Mega";n[n.ShortVideos=25]="ShortVideos";n[n.RewardsDailySet=26]="RewardsDailySet";n[n.CashbackAds=27]="CashbackAds"})(t=n.DSBScenario||(n.DSBScenario={}));n.generateThumbnailDimension=i;n.generateBingThumbnailUrlFromId=u;n.generateBingThumbnailUrlFromIdByScenario=rt;n.generateMsnThumbnailUrlFromId=ut;n.getDSBFormCode=ft;n.generateBingUrlWithLanguageAndRegion=s;n.numberOfItemsToDisplay=et;n.getBtnTitle=ot;n.getTooltips=st;n.getAnswerIconStyle=ht;n.formatNumbers=ct;n.getImageStyle=lt;n.getImageStyleNew=at;n.getItemPublisherStyleMegaExt=vt;n.getItemTitleStyleMegaExt=yt;n.getThumbnailSize=o;n.getImageStyleMegaExt=pt;n.appendDprOnImageUrl=r;n.isDprAvailable=h;n.isDprInUseInUrl=f;n.getImageStyleMegaRewards=wt;n.getDSBContainerWidth=c;n.getTilesToShowCount=bt;n.DEFAULT_DSB_UPDATE_INTERVAL_HOURS=6;n.DEFAULT_DSB_UPDATE_INTERVAL_MINS=n.DEFAULT_DSB_UPDATE_INTERVAL_HOURS*60;n.DEFAULT_DSB_GLEAM_EXPIRY_MINS=4320;n.DEFAULT_3P_GLEAM_CHECK_INTERVAL_MINS=1;n.UPDATE_PLACEHOLDERTEXT_INTERVAL_MINS=15;n.MINS_TO_MILLIS=6e4;n.MIN_SHOWN_UPDATE_MILLIS=((n.config===null||n.config===void 0?void 0:n.config.enableDSB1Hour)?60:(n.config===null||n.config===void 0?void 0:n.config.enableDSB30Min)?30:15)*n.MINS_TO_MILLIS;n.FETCH_DSB_CONTENT_TIMEOUT_IN_MS=3e3;n.DSB_RESET_SECONDS=300;n.DayEndSec=86400;n.DayStartSec=0;n.TelemetryIdXap="telemetryIdXap";n.TelemetryIdSuffix="toggled";n.DateTimeReference=new Date("2010-01-01");n.DefaultGleamData={GleamKey:"",GleamText:"",GleamFormat:"",LightGleamBlob:"",DarkGleamBlob:"",LightGleamUrl:"",DarkGleamUrl:""};n.DefaultSchemaVersionPoF="1.0.0";let e="";n.getCommonBaseUrl=l;n.clickDSBHandler=kt;n.isBingHandoffType=dt;n.keepFoucsOnThisElement=gt;n.formatTimePassed=a;n.localizedTimeAgo=ni;n.getCurrentDateDSB=ti;n.DSBLogError=ii;n.DSBLogWarning=ri;n.getTelemetryIdFromUrl=ui;n.getGleamDimensionFromGleamSize=fi;n.convertMomentDateForRender=ei;n.getDateStringInDSBFormat=v;n.getDSBMomentDatesForFlipper=oi;n.createDSBEdgeLaunchProtocolParameters=si;n.isDSBSearchApiEnabled=hi;n.isSearchFlexibleGleamTooltipText=ci;n.isSearchFlexibleGleamClickEndpoint=li;n.isSearchPointsOfFlexibilityEnabled=y;n.isPofEnabledOnWin11=ai;n.isSearchShowOnHoverAllowedSettingEnabled=vi})(WSB||(WSB={})),function(n){const t=0,f=3,i=1,e={placeholderText:"",lightGleamDataOrUrl:"",darkGleamDataOrUrl:"",expirationTime:0,gleamSize:null,win11ShowForMillis:t,telemetryId:""},o=[0,262144,2048,4096],r=new n.Mutex,u="cdsb-last-refresh";class s{constructor(t,r,u){this._dsbViewModel=t;this._msb_dsbViewModel=r;this.previouslySelectedViewModels=[];SearchAppWrapper.CortanaApp.setDynamicSearchBoxEnablement&&SearchAppWrapper.CortanaApp.setDynamicSearchBoxEnablement(!0);n.Host.bindBootstrapDone(()=>{n.isDynamicSearchContentPossible()&&n.safeSetTimeout(()=>{this.logBackgroundTask("DSBManager_bootstrap"),this.pendRefresh(2,0)},i,"dsbManager::bindBootstrapDone"),!n.isThirdPartyGleamSupported()||n.isBingEnabled()||n.Host.getMru3pAppCache()||n.AccessTokenManager.getWindowsAccountType()==1||(this.previousSearchAppearanceGleamData=undefined,this.setSearchAppearanceContent({gleamData:undefined,contentType:2}))});n.Host.bindDynamicSearchBoxUpdate(()=>n.isDynamicSearchContentPossible()?(this.logBackgroundTask("DSBManager_onBackgroundTask_Start"),new Promise(n=>{this.resolvePromise=n,this.onBackgroundTask(),this.logBackgroundTask("DSBManager_onBackgroundTask_End")})):Promise.resolve());n.Host.bindSearchAppearanceInvoked(async()=>{var r,u,f,e,o,s;let t=this._dsbViewModel;const i=t===null||t===void 0?void 0:t.getSearchAppearanceGleamContent(),h=(o=(e=(f=(u=(r=i===null||i===void 0?void 0:i.gleamData)===null||r===void 0?void 0:r.content)===null||u===void 0?void 0:u.taskbarSearchBox)===null||f===void 0?void 0:f.gleam)===null||e===void 0?void 0:e.invokeAction)===null||o===void 0?void 0:o.uri,c=(s=i===null||i===void 0?void 0:i.gleamData)===null||s===void 0?void 0:s.telemetryId,l=t===null||t===void 0?void 0:t.getUrlHandoffType(h);let a={clickThroughUrl:h,telemetryId:c,handoffType:l};n.InstrumentationHelper.instrumentGleamClickEvent(a)});n.Host.bindDynamicPlaceholderContentRequested(async()=>{n.isDynamicSearchContentPossible()&&(this.previousDynamicSearchBoxContent=undefined,this.previousSearchAppearanceGleamData=undefined,n.logToMC("Bing_QF_DynamicSearchManager","UpdateRequestedByClient","logDynamicSearchManager"),await this.updateDynamicSearchBoxContent("DynamicSearchManager.bindDynamicPlaceholderContentRequested"))});n.Host.bindQueryChangedOrInitialized(t=>{var r,u,f,e,o,s,i,h,c;if(n.isThirdPartyGleamSupported()&&n.AccessTokenManager.getWindowsAccountType()!=1){let l=(r=this.currentQuery)===null||r===void 0?void 0:r.scope,c=t.scope,a=(f=(u=this.currentQuery)===null||u===void 0?void 0:u.thirdPartySearch)===null||f===void 0?void 0:f.applicationUserModelId,v=(e=t.thirdPartySearch)===null||e===void 0?void 0:e.applicationUserModelId;switch(!0){case!n.isBingEnabled()&&c==n.Scope.All:this.previousSearchAppearanceGleamData=undefined;this.setSearchAppearanceContent({gleamData:undefined,contentType:2});break;case n.isBingEnabled()&&c==n.Scope.All&&this.previousSearchAppearanceGleamData==undefined:case l==n.Scope.ThirdPartyWeb&&c!=n.Scope.ThirdPartyWeb:this.pendRefresh(3,3);this.previousSearchAppearanceGleamData=(s=(o=this._dsbViewModel)===null||o===void 0?void 0:o.getSearchAppearanceGleamContent())===null||s===void 0?void 0:s.gleamData;break;case l!=n.Scope.ThirdPartyWeb&&c==n.Scope.ThirdPartyWeb:case l==n.Scope.ThirdPartyWeb&&c==n.Scope.ThirdPartyWeb&&a!=v:(h=(i=this._dsbViewModel)===null||i===void 0?void 0:i.set3pSearchAppearance)===null||h===void 0?void 0:h.call(i,t.thirdPartySearch)}}this.currentQuery=t;((c=this._dsbViewModel)===null||c===void 0?void 0:c.isDwellStarted())&&(this._dsbViewModel.instrumentDSBDwellTime(),this._dsbViewModel.resetDwellTime())});n.Host.bindShown(()=>{var t,r;n.Host.setBindShownTime(n.getCurrentTime());n.isDynamicSearchContentPossible()&&(this.appShown=!0,n.safeSetTimeout(()=>{this.pendRefresh(7,2)},i,"dsbManager::bindShown"),n.isDSBAllowedInEntryPoint()&&n.config.enableDSBMobileAppUpsellCard&&this.setMobileAppUpsellCardTriggerLogic());this.dynamicSearchBoxContentKeyAtShown=(r=(t=this.previousDynamicSearchBoxContent)===null||t===void 0?void 0:t.attributes)===null||r===void 0?void 0:r.contentKey});n.Host.bindDismissed(()=>{var t;n.Host.setBindDimissTime(n.getCurrentTime());this.appShown=!1;((t=this._dsbViewModel)===null||t===void 0?void 0:t.isDwellStarted())&&(this._dsbViewModel.instrumentDSBDwellTime(),this._dsbViewModel.resetDwellTime())});n.Host.bindBeforeWebViewReload(()=>{this.allowSuspension()});n.UrlParameters&&(n.Host.bindKeyDown((t,i)=>{i.ctrlKey&&t==115&&((n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbUiError)&&(n.TestHookUrlParameters.msbDsbUiError=undefined),this.forceRefresh())}),n.Host.bindKeyDown((n,t)=>{t.ctrlKey&&n==113&&this.forceRefreshFlipper()}),n.Host.bindKeyDown((n,t)=>{t.ctrlKey&&n==114&&this.forceRenderOnlyRefresh()}));u.bindAccountTypesChanged(async()=>{const t=n.AccessTokenManager.getWindowsAccountType();t===0&&await this.setViewModelDynamicSearchBoxContent(null,"DynamicSearchManager.bindAccountTypesChanged");this.flushPendingRefresh()});const f=()=>{this.pendRefresh(3,3)};n.Host.bindAccountChanged(()=>{this.setViewModelDynamicSearchBoxContent(null,"DynamicSearchManager.bindAccountChanged").then(()=>f()).catch(()=>f())})}allowSuspension(){this.resolvePromise&&(this.resolvePromise(),this.resolvePromise=null);n.Host.setIsReloadSuppressedBgTask(!1)}forceRefresh(){if(!n.isDynamicSearchContentPossible()){n.log("Can't force DSB refresh. DSB is not enabled.");return}n.log("DSB: forceBackgroundRefresh");this.pendRefresh(3,5)}forceRefreshFlipper(){n.isDynamicSearchContentPossible()?(n.log("DSB: forceBackgroundRefreshFlipper"),this.pendRefresh(3,6)):n.log("Can't force DSB refresh. DSB is not enabled.")}forceRenderOnlyRefresh(){n.isDynamicSearchContentPossible()?(n.log("DSB: forceRenderOnlyRefresh"),this.pendRefresh(2,5)):n.log("Can't force DSB render-only refresh. DSB is not enabled.")}getSelectableItemsByGroup(){var i,r,u;if(!n.shouldShowDSBLayout(this.currentQuery))return[];let t=[];if(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled()){(n.msbDsbSwitchHost===null||n.msbDsbSwitchHost===void 0?void 0:n.msbDsbSwitchHost.shouldShow())&&t.push(...n.msbDsbSwitchHost.getSelectableItemsByGroup());const r=this.selectDsbViewModels();r.length===1?t.push(...r[0].getSelectableItemsByGroup()):r.length===2&&(n.config.msbDsbDynamicBlend?(t.push(...((i=this._msb_dsbViewModel.getTopRegionSelectableItemsByGroup())!==null&&i!==void 0?i:[])),t.push(...this._dsbViewModel.getSelectableItemsByGroup()),t.push(...this._msb_dsbViewModel.getSelectableItemsByGroup())):(t.push(...r[1].getSelectableItemsByGroup()),t.push(...r[0].getSelectableItemsByGroup())))}else t.push(...((u=(r=this.selectDsbViewModel())===null||r===void 0?void 0:r.getSelectableItemsByGroup())!==null&&u!==void 0?u:[]));return t}getSelectableItems(){var i,r,u,f,e,o;if(!n.shouldShowDSBLayout(this.currentQuery))return[];let t=[];if(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled()){(n.msbDsbSwitchHost===null||n.msbDsbSwitchHost===void 0?void 0:n.msbDsbSwitchHost.shouldShow())&&t.push(...n.msbDsbSwitchHost.getSelectableItems());const e=this.selectDsbViewModels();e.length===1?t.push(...(i=e[0].getSelectableItems())!==null&&i!==void 0?i:[]):e.length===2&&(n.config.msbDsbDynamicBlend?(t.push(...((r=this._msb_dsbViewModel.getTopRegionSelectableItems())!==null&&r!==void 0?r:[])),t.push(...this._dsbViewModel.getSelectableItems()),t.push(...this._msb_dsbViewModel.getSelectableItems())):(t.push(...(u=e[1].getSelectableItems())!==null&&u!==void 0?u:[]),t.push(...(f=e[0].getSelectableItems())!==null&&f!==void 0?f:[])))}else t.push(...((o=(e=this.selectDsbViewModel())===null||e===void 0?void 0:e.getSelectableItems())!==null&&o!==void 0?o:[]));return t}async updateDynamicSearchBoxContent(t,i){var f,e;let r="DSBNotPossible",u;n.isDynamicSearchContentPossible()&&(n.msbHost&&n.msbDsbHost&&n.msbHost.features.isMsbDsbBlendFeatureEnabled()?n.msbDsbHost.isInBlendedMode()?(u=n.config.msbDsbUseAadGleamInBlendedMode?this._msb_dsbViewModel:n.config.msbDsbUseMsaGleamInBlendedMode||n.msbDsbHost.isCurrentTimeInOffWorkHour()?this._dsbViewModel:this._msb_dsbViewModel,r="BlendedMode"):(u=i&&((f=this.previouslySelectedViewModels[0])===null||f===void 0?void 0:f.getName())===i?this.previouslySelectedViewModels[0]:this.selectDsbViewModels()[0],r="NonBlendedMode"):(u=i&&((e=this.previouslySelectedViewModel)===null||e===void 0?void 0:e.getName())===i?this.previouslySelectedViewModel:this.selectDsbViewModel(),r="DsbNormal"));await this.setViewModelDynamicSearchBoxContent(u,t+" updateDynamicSearchBoxContent."+r)}async update3pDynamicSearchBoxContent(n){let t=this._dsbViewModel;await this.setViewModelDynamicSearchBoxContent(t,n+" updateDynamicSearchBoxContent.DSBNotPossible")}isDSBVisible(){var n,t,i;return((n=this._msb_dsbViewModel)===null||n===void 0?void 0:n.isEnabled())?(t=this._msb_dsbViewModel)===null||t===void 0?void 0:t.getVisibility():(i=this._dsbViewModel)===null||i===void 0?void 0:i.getVisibility()}async trySetDynamicSearchBoxContentWithRetry(t,i,r,u,e,s,h){let v=0,a=!1,c;const l=[];do c=await n.Async.safePromise("setDynamicSearchBoxContentWithResultAsync_url",()=>SearchAppWrapper.CortanaApp.setDynamicSearchBoxContentWithResultAsync(t,i,r,u,e,s,h,!1)),l.push(c),a=!o.includes(c);while(a&&++v<f);c==262144?n.logToMC("Bing_QF_DynamicSearchManager","SkipSettingDynamicContent","logDynamicSearchManager"):c==0?l.length>1&&n.DSBLogWarning("DynamicSearchManager",`Succeeded to set gleam after failure: ${JSON.stringify({lightGleamValue:i,darkGleamValue:r,results:l,isUrl:s})}`):n.DSBLogError("DynamicSearchManager",`Failed to set gleam: ${JSON.stringify({lightGleamValue:i,darkGleamValue:r,results:l,isUrl:s})}`)}async setDynamicSearchBoxContentByJson(t,i,r,u,f,e,o,s,h,c,l,a){var p;let v=h.toISOString();v=v.slice(0,-5)+v.slice(-1);let b={gleamAltText:i!==null&&i!==void 0?i:"",lightGleamUrl:r?u:undefined,darkGleamUrl:r?f:undefined,lightGleamData:r?undefined:u,darkGleamData:r?undefined:f,gleamDimensionEnum:(p=e===null||e===void 0?void 0:e.toString())!==null&&p!==void 0?p:"30x36".toString(),placeholderText:t,expirationTime:v!==null&&v!==void 0?v:"",targetSurface:o?Number(o):undefined,telemetryId:s,showTimeoutInMilliseconds:c,gleamClickEndpoint:l,gleamTooltip:a},w=JSON.stringify(b),y;try{if(y=await n.Async.safePromise("setDynamicContentAsync",()=>SearchAppWrapper.CortanaApp.setDynamicContentAsync(w)),y==262144)n.logToMC("Bing_QF_DynamicSearchManager","SkipSettingDynamicContent","logDynamicSearchManager");else if(y!=0)throw new Error(y.toString());}catch(k){n.DSBLogError("SetDynamicSearchBoxContentResult",`failed to set gleamdata ${k}
 GleamJson:${w}`)}return y}async setDynamicSearchBoxContentUrl(i){let{placeholderText:o,win11ShowForMillis:r,targetSurface:u}=i,{lightGleamDataOrUrl:f,darkGleamDataOrUrl:s,expirationTime:l,gleamSize:h,gleamDimension:a,telemetryId:e,gleamAltText:v,gleamClickEndpoint:y,gleamTooltip:p}=i;r=r!==null&&r!==void 0?r:t;u=u!==null&&u!==void 0?u:0;e||(e=n.getTelemetryIdFromUrl(f));a||(a=n.getGleamDimensionFromGleamSize(h));let c=typeof l=="number"?new Date(l):l;if(n.isDSBSearchApiEnabled())this.setDynamicSearchBoxContentByJson(o,v,!0,f,s,a,u,e,c,r,y,p);else if(n.config.responsiveDynamicSearchAPI)await this.trySetDynamicSearchBoxContentWithRetry(o,f,s,c,h,!0,e);else{if(n.config.targetedDynamicSearchAPI)return n.Async.safePromise("setDynamicContentURLTargeted",()=>SearchAppWrapper.CortanaApp.setDynamicContentURLTargeted(o,f,s,c,h,e,r,u));if(n.config.extendedDynamicSearchAPI)return n.Async.safePromise("setDynamicContentUrl",()=>SearchAppWrapper.CortanaApp.setDynamicContentURL(o,f,s,c,h,e,r));if(SearchAppWrapper.CortanaApp.setDynamicSearchBoxContentURL)return n.Async.safePromise("setDynamicSearchBoxContentUrl",()=>SearchAppWrapper.CortanaApp.setDynamicSearchBoxContentURL(o,f,s,c,h==1));n.log("CortanaApp.setDynamicSearchBoxContent not supported")}}async setDynamicSearchBoxContentRawData(i){let{placeholderText:e,win11ShowForMillis:u,targetSurface:f}=i,{lightGleamDataOrUrl:o,darkGleamDataOrUrl:s,expirationTime:a,gleamSize:h,gleamDimension:c,telemetryId:r,gleamAltText:v,gleamClickEndpoint:y,gleamTooltip:p}=i;u=u!==null&&u!==void 0?u:t;f=f!==null&&f!==void 0?f:0;r=r!==null&&r!==void 0?r:"Not Implemented";c=c!==null&&c!==void 0?c:n.getGleamDimensionFromGleamSize(h);let l=typeof a=="number"?new Date(a):a;if(n.isDSBSearchApiEnabled())this.setDynamicSearchBoxContentByJson(e,v,!1,o,s,c,f,r,l,u,y,p);else if(n.config.responsiveDynamicSearchAPI)await this.trySetDynamicSearchBoxContentWithRetry(e,o,s,l,h,!1,r);else{if(n.config.targetedDynamicSearchAPI)return n.Async.safePromise("setDynamicContentRawDataTargeted",()=>SearchAppWrapper.CortanaApp.setDynamicContentRawDataTargeted(e,o,s,l,h,r,u,f));if(n.config.extendedDynamicSearchAPI)return n.Async.safePromise("setDynamicContentRawData",()=>SearchAppWrapper.CortanaApp.setDynamicContentRawData(e,o,s,l,h,r,u));if(SearchAppWrapper.CortanaApp.setDynamicSearchBoxContentRawData)return n.Async.safePromise("setDynamicSearchBoxContentRawData",()=>SearchAppWrapper.CortanaApp.setDynamicSearchBoxContentRawData(e,o,s,l,h==1));n.log("CortanaApp.setDynamicSearchBoxContentRawData not supported")}}async setSearchAppearanceContent(t){var u,f,e;let r,o=t===null||t===void 0?void 0:t.contentType,i=JSON.stringify(t===null||t===void 0?void 0:t.gleamData);try{if(n.isThirdPartyGleamSupported()){o=2;const s=n.Host.get1pSearchApps(),h=(e=(f=(u=t===null||t===void 0?void 0:t.gleamData)===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.taskbarSearchBox)===null||e===void 0?void 0:e.gleam;s&&h||(i="");r=await n.Async.safePromise("setSearchAppearanceForWebProviderAsync",()=>SearchAppWrapper.CortanaApp.setSearchAppearanceForWebProviderAsync(o,i,s))}else r=await n.Async.safePromise("setSearchAppearanceAsync",()=>SearchAppWrapper.CortanaApp.setSearchAppearanceAsync(o,i));if(r.state==262144)n.logToMC("Bing_QF_DynamicSearchManager","SkipSettingSearchAppearanceContent","logDynamicSearchManager");else if(r.state!=0)throw new Error(JSON.stringify(r));else n.logToMC("Bing_QF_DynamicSearchManager","SearchAppearanceContentUpdated","logDynamicSearchManager",i)}catch(s){n.logToMC("Bing_QF_DynamicSearchManager","FailedToSetGleamdata","logDynamicSearchManager",i);n.DSBLogError("SetSearchAppearanceResult",`failed to set gleamdata ${s}
 GleamJson:${i}`)}}async setSearchAppearanceContentFor3p(t,i){let r,f=t===null||t===void 0?void 0:t.contentType,u=(t===null||t===void 0?void 0:t.gleamData)?JSON.stringify(t.gleamData):"";try{let t=i!==null&&i!==void 0?i:n.Host.getThirdPartyMRUSearhApp();if(!t)throw new Error("3p app extenstion is not provided for 3p SearchAppearance");if(r=await n.Async.safePromise("setSearchAppearanceForWebProviderAsync",()=>SearchAppWrapper.CortanaApp.setSearchAppearanceForWebProviderAsync(f,u,t)),r.state==262144)n.logToMC("Bing_QF_DynamicSearchManager","SkipSettingSearchAppearanceForWebProvider","logDynamicSearchManager");else if(r.state!=0)throw new Error(JSON.stringify(r));}catch(e){n.DSBLogError("SetSearchAppearanceResult",`failed to set gleamdata ${e}
 GleamJson:${u}`)}}setDynamicSearchBoxUpdateInterval(t){return SearchAppWrapper.CortanaApp.updateDynamicSearchBoxUpdateInterval?SearchAppWrapper.CortanaApp.updateDynamicSearchBoxUpdateInterval(t):(n.log("CortanaApp.updateDynamicSearchBoxUpdateInterval not supported"),!1)}hasContent(t){if(this.previouslySelectedViewModel)return this.previouslySelectedViewModel.hasContent(t);if(this.previouslySelectedViewModels[0])return this.previouslySelectedViewModels[0].hasContent(t);if(n.config.enableSSHUnshownFix){let n=this.selectDsbViewModel();return n?n.hasContent():!1}return!0}setDsbPanesVisibility(t){var i,r;n.shouldShowDSBLayout(t)?(this.adjustDsbWrapper(!0),(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled())?this.selectDsbViewModels(!0):this.selectDsbViewModel(!0)):(this.adjustDsbWrapper(!1),(i=this._msb_dsbViewModel)===null||i===void 0?void 0:i.setVisibility(!1),(r=this._dsbViewModel)===null||r===void 0?void 0:r.setVisibility(!1))}setDsbVisibility(){var t,i,r,u,f,e;if((t=this._msb_dsbViewModel)===null||t===void 0?void 0:t.isEnabled())this._msb_dsbViewModel.setVisibility(!0),(i=this._dsbViewModel)===null||i===void 0?void 0:i.setVisibility(!!(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())&&!n.shouldDisplayMsbDsbInWorkScope((r=this.currentQuery)===null||r===void 0?void 0:r.isWorkScopeZI),this.appShown);else if((u=this._dsbViewModel)===null||u===void 0?void 0:u.setVisibility(!0,this.appShown),(f=this._msb_dsbViewModel)===null||f===void 0?void 0:f.setVisibility(!1),n.config.MsbDsbClearEnterpriseGleam){const t=(e=n.getAccessTokenManager())===null||e===void 0?void 0:e.getSelectedAccountInfo();(n.AccessTokenManager.getWindowsAccountType()===1||(t===null||t===void 0?void 0:t.accountProviderAuthority)==="organizations")&&(SearchAppWrapper.CortanaApp.clearDynamicContent&&SearchAppWrapper.CortanaApp.clearDynamicContent(),SearchAppWrapper.CortanaApp.removeDynamicSearchBoxContent&&SearchAppWrapper.CortanaApp.removeDynamicSearchBoxContent())}}adjustDsbWrapper(t){t&&!n.shouldShowDSBFullWidth()&&((n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())||(n.msbDsbSwitchHost===null||n.msbDsbSwitchHost===void 0?void 0:n.msbDsbSwitchHost.shouldShow()))?this.moveDsbPanesIntoWrapper():this.moveDsbPanesOutOfWrapper()}moveDsbPanesIntoWrapper(){n.StaticHtmlElements.dynamicPaneWrapper&&(n.StaticHtmlElements.msbDsbRoot.parentElement!==n.StaticHtmlElements.dynamicPaneWrapper&&(n.StaticHtmlElements.dynamicPaneWrapper.appendChild(n.StaticHtmlElements.dynamicPane),n.StaticHtmlElements.dynamicPaneWrapper.appendChild(n.StaticHtmlElements.msbDsbRoot)),n.setVisibility(n.StaticHtmlElements.dynamicPaneWrapper,!0))}moveDsbPanesOutOfWrapper(){n.StaticHtmlElements.dynamicPaneWrapper&&(n.setVisibility(n.StaticHtmlElements.dynamicPaneWrapper,!1),n.StaticHtmlElements.msbDsbRoot.parentElement===n.StaticHtmlElements.dynamicPaneWrapper&&(n.StaticHtmlElements.dynamicPaneWrapper.parentElement.insertBefore(n.StaticHtmlElements.dynamicPane,n.StaticHtmlElements.dynamicPaneWrapper),n.StaticHtmlElements.dynamicPaneWrapper.parentElement.insertBefore(n.StaticHtmlElements.msbDsbRoot,n.StaticHtmlElements.dynamicPaneWrapper)))}pendRefresh(t,i){var r,f;const e=n.AccessTokenManager.getWindowsAccountType();if(this.logBackgroundTask(`DsbManager_pendRefresh_Start_${t}_reason_${i}`),e!=0){if(e!=1||n.isDsbEnabledForEnterprise())if(n.config.msbDsbMoveIntervalTime)this.refreshViewModels(t,i);else if(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled()){const f=this.selectDsbViewModels(!1,i);this.shouldUpdateConsumerDsbInBlendedMode()||i!==1?(f===null||f===void 0?void 0:f.forEach(n=>n.refresh(t,i)),(t==3||t==7)&&n.LightweightStorage.setItem(u,n.getCurrentTime().toString())):(r=f[0])===null||r===void 0?void 0:r.refresh(t,i)}else(f=this.selectDsbViewModel(!1,i))===null||f===void 0?void 0:f.refresh(t,i)}else this.mergePendingRefresh(t,i);this.logBackgroundTask(`DsbManager_pendRefresh_End_${t}_reason_${i}`)}mergePendingRefresh(n,t){if(this.logBackgroundTask("DsbManager_mergePendingRefresh_Start"),this.pendingRefreshParameters){const{strategy:i,reason:r}=this.pendingRefreshParameters;i&1&&(n|=1,t==2&&(t=r));(i&6)==2&&(n=n&-7|2)}this.pendingRefreshParameters={strategy:n,reason:t};this.logBackgroundTask("DsbManager_mergePendingRefresh_End")}flushPendingRefresh(){var t,i;const r=n.AccessTokenManager.getWindowsAccountType();if(r!=0&&this.pendingRefreshParameters){const{strategy:f,reason:u}=this.pendingRefreshParameters;this.pendingRefreshParameters=null;n.config.msbDsbMoveIntervalTime?this.refreshViewModels(f,u):(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled())?(t=this.selectDsbViewModels(!1,u))===null||t===void 0?void 0:t.forEach(n=>n.refresh(f,u)):(i=this.selectDsbViewModel(!1,u))===null||i===void 0?void 0:i.refresh(f,u)}}selectDsbViewModels(t,i){var u,f;let r=[];const e=n.AccessTokenManager.getWindowsAccountType();return e==1||n.config.msbMockToken?((u=this._msb_dsbViewModel)===null||u===void 0?void 0:u.isEnabled())||n.config.msbMockToken?(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())&&!n.shouldDisplayMsbDsbInWorkScope((f=this.currentQuery)===null||f===void 0?void 0:f.isWorkScopeZI)?(r.push(this._msb_dsbViewModel),r.push(this._dsbViewModel)):r.push(this._msb_dsbViewModel):n.isConsumerDsbEnabledForEnterprise()&&(i===0&&(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.shouldForceEnterprise())?r.push(this._msb_dsbViewModel):r.push(this._dsbViewModel)):e!=0&&r.push(this._dsbViewModel),this.handleViewModelsChange(r,t),r}handleViewModelsChange(n,t){const i=this.getViewModelMode(n),r=this.getViewModelMode(this.previouslySelectedViewModels);if(i!=r){this.previouslySelectedViewModels=n;this.onViewModelChanged(n[0])}t&&this.setDsbVisibility()}getViewModelMode(n){if(n.length==2)return"Blended";if(n.length==1){if(n[0]==this._msb_dsbViewModel)return"Enterprise";if(n[0]==this._dsbViewModel)return"Consumer"}return"None"}selectDsbViewModel(t,i){var u;let r;const f=n.AccessTokenManager.getWindowsAccountType();return f==1||n.config.msbMockToken?((u=this._msb_dsbViewModel)===null||u===void 0?void 0:u.isEnabled())||n.config.msbMockToken?r=this._msb_dsbViewModel:n.isConsumerDsbEnabledForEnterprise()&&(r=i===0&&(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.shouldForceEnterprise())?this._msb_dsbViewModel:this._dsbViewModel):f!=0&&(r=this._dsbViewModel),this.handleViewModelChange(r,t),r}handleViewModelChange(n,t){if(this.previouslySelectedViewModel!==n){this.previouslySelectedViewModel=n;this.onViewModelChanged(n)}t&&this.setDsbVisibility()}onViewModelChanged(t){if(this.setDsbVisibility(),t===null||t===void 0?void 0:t.shouldUpdateGleamAndTimeInterval()){this.updateDynamicSearchBoxContent(`DynamicSearchManager.onViewModelChanged`,t===null||t===void 0?void 0:t.getName());let i=t===null||t===void 0?void 0:t.getUpdateIntervalMins();this.shouldOverwriteInterval(t)&&(i=(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.getRemainingTimeToWorkStartHour())+1);this.setViewModelUpdateInterval(i)}}onBackgroundTask(){n.isTSInSearchBoxAvailable()&&!this.shouldRefreshDSBContent()?this.appShown||this.pendRefresh(0,7):this.pendRefresh(this.appShown?7:3,1)}setViewModelUpdateInterval(n){let t;n!=null&&(t=this.setDynamicSearchBoxUpdateInterval(n))}refreshViewModels(t,i){if(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled()){const r=this.selectDsbViewModels(!1,i);if(i===1&&this.shouldOverwriteInterval(r[0])){const t=(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.getRemainingTimeToWorkStartHour())+1;this.setViewModelUpdateInterval(t)}r.forEach(n=>n.refresh(t,i))}else{const r=this.selectDsbViewModel(!1,i);if(i===1&&this.shouldOverwriteInterval(r)){const t=(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.getRemainingTimeToWorkStartHour())+1;this.setViewModelUpdateInterval(t)}r===null||r===void 0?void 0:r.refresh(t,i)}}shouldOverwriteInterval(t){if(t===this._dsbViewModel&&((n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isOffWorkHourDisabledAad())||(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())||(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInDiscoverMode()))){const t=n.getCurrentDate(),i=new Date(t);return i.setHours(t.getHours()+n.DEFAULT_DSB_UPDATE_INTERVAL_HOURS),n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInNextWorkTimePeriod(i)}return!1}shouldRefreshDSBContent(){var t;let i=!0;const r=n.AccessTokenManager.getWindowsAccountType();return r!=1&&(i=(t=this._dsbViewModel)===null||t===void 0?void 0:t.isDSBContentExpired()),i}async setViewModelDynamicSearchBoxContent(t,i){var v,u,y,f,o,s,p,h,w,c,b,l,k,a;if(n.config.msbDsbEmptyGleamInvestigation&&(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.logGleamSetup("FunctionEntry",t,i)),n.isBingGleamDisabledByRegionalPolicy()){n.config.msbDsbEmptyGleamInvestigation&&(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.logGleamSetup("ClearedByRegionalPolicy",t,i+" GleamDisabledByRegionalPolicy"));await((u=(v=SearchAppWrapper.CortanaApp).clearDynamicContent)===null||u===void 0?void 0:u.call(v));await((f=(y=SearchAppWrapper.CortanaApp).removeDynamicSearchBoxContent)===null||f===void 0?void 0:f.call(y));this.previousSearchAppearanceGleamData=undefined;this.previousDynamicSearchBoxContent=undefined;return}await r.lock();this.logBackgroundTask("DsbManager_setViewModelDynamicSearchBoxContent_Start");try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBSearchBoxContent){this.logBackgroundTask("DsbManager_disableDSBSearchBoxContent");return}if(n.isSearchPointsOfFlexibilityEnabled()&&t!==this._msb_dsbViewModel){const r=(o=t===null||t===void 0?void 0:t.getSearchAppearanceGleamContent)===null||o===void 0?void 0:o.call(t);if(n.isSearchAppearanceGleamTelemetryIdEqual(r===null||r===void 0?void 0:r.gleamData,this.previousSearchAppearanceGleamData)){this.logBackgroundTask("DsbManager_gleamTelemetryIdNotUpdated");return}if(this.logBackgroundTask("DsbManager_setSearchAppearanceContentPof_Start"),this.previousSearchAppearanceGleamData=r===null||r===void 0?void 0:r.gleamData,this.previousDynamicSearchBoxContent=undefined,r){let n=r.contentType;n==1?(await this.setSearchAppearanceContent(r),this.logBackgroundTask("DsbManager_setSearchAppearanceContentPof_End")):n==2&&(await this.setSearchAppearanceContentFor3p(r,(s=this.currentQuery)===null||s===void 0?void 0:s.thirdPartySearch),this.logBackgroundTask("DsbManager_setSearchAppearanceContentPof_3p_End"))}else this.logBackgroundTask("DsbManager_no_vm_selected"),n.config.msbDsbEmptyGleamInvestigation&&(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.logGleamSetup("ClearedByNullContent",t,i+" NoVmSelected")),await((h=(p=SearchAppWrapper.CortanaApp).clearDynamicContent)===null||h===void 0?void 0:h.call(p)),await((c=(w=SearchAppWrapper.CortanaApp).removeDynamicSearchBoxContent)===null||c===void 0?void 0:c.call(w)),this.previousDynamicSearchBoxContent=undefined,this.logBackgroundTask("DsbManager_clearDSBcontent")}else{this.logBackgroundTask("DsbManager_setViewModelDSBContentOldApi");const r=t===null||t===void 0?void 0:t.getDynamicSearchBoxContent();if(n.areDynamicSearchBoxContentEqual(r,this.previousDynamicSearchBoxContent)){n.config.msbDsbEmptyGleamInvestigation&&(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.logGleamSetup("DedupEarlyReturn",t,i+" DynamicSearchBoxContentEqual"));return}if(this.previousDynamicSearchBoxContent=r,this.previousSearchAppearanceGleamData=undefined,r){const{attributes:n,parameters:t}=r,i=n===null||n===void 0?void 0:n.gleamFormat;switch(i){case 0:await this.setDynamicSearchBoxContentRawData(t);break;case 1:await this.setDynamicSearchBoxContentUrl(t);break;default:await this.setDynamicSearchBoxContentUrl(e)}}else this.logBackgroundTask("DsbManager_no_vm_selected"),n.config.msbDsbEmptyGleamInvestigation&&(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.logGleamSetup("ClearedByNullContent",t,i+" NoVmSelected")),await((l=(b=SearchAppWrapper.CortanaApp).clearDynamicContent)===null||l===void 0?void 0:l.call(b)),await((a=(k=SearchAppWrapper.CortanaApp).removeDynamicSearchBoxContent)===null||a===void 0?void 0:a.call(k)),this.previousDynamicSearchBoxContent=undefined}this.logBackgroundTask("DsbManager_setViewModelDynamicSearchBoxContent_End")}finally{r.release()}}getDynamicSearchBoxContentKeyAtShown(){return this.dynamicSearchBoxContentKeyAtShown}getInstrumentedProps(){var i,r;let t=[];return(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isMsbDsbBlendFeatureEnabled())?(t=this.selectDsbViewModels().map(n=>{var t;return(t=n.getInstrumentProps())!==null&&t!==void 0?t:[]}).reduce((n,t)=>n.concat(t),[]),(n.msbDsbSwitchHost===null||n.msbDsbSwitchHost===void 0?void 0:n.msbDsbSwitchHost.shouldShow())&&(t=t.concat(n.msbDsbSwitchHost.getDsbInstrumentProps()))):t=(r=(i=this.selectDsbViewModel())===null||i===void 0?void 0:i.getInstrumentProps())!==null&&r!==void 0?r:[],t}logBackgroundTask(t){n.logToMC("Bing_QF_BackgroundTask_lifecycle",t,"logBackgroundTask")}focus(){var n;if((n=this._dsbViewModel)!==null&&n!==void 0)return n.focus()}shouldUpdateConsumerDsbInBlendedMode(){if(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())try{const t=n.LightweightStorage.getItem(u);if(t){const i=Date.now()-parseInt(t);return i>=n.DEFAULT_DSB_UPDATE_INTERVAL_MINS*n.MINS_TO_MILLIS}return!0}catch(t){return!0}else return!0}updateGleamDataPofSchema(n){var i,r,u,f,e,o;let t=(r=(i=this===null||this===void 0?void 0:this._dsbViewModel)===null||i===void 0?void 0:i.getSearchAppearanceGleamContent())===null||r===void 0?void 0:r.gleamData;const s=(o=(e=(f=(u=t===null||t===void 0?void 0:t.content)===null||u===void 0?void 0:u.taskbarSearchBox)===null||f===void 0?void 0:f.gleam)===null||e===void 0?void 0:e.hoverAction)===null||o===void 0?void 0:o.type;let h=s=="searchHome"&&!n||s=="showTooltip"&&n;t&&h&&this._dsbViewModel.setGleamDataPoFSchema(t,h)}setMobileAppUpsellCardTriggerLogic(){var t;const u="MobileAppUpsellCard-ExpiryDate",i="MobileAppUpsellCard-CardShown",r=parseInt(localStorage.getItem(u))||null,f=parseInt(localStorage.getItem("MobileAppUpsellCard-ExpiryCount"))+1||1,e=JSON.parse(localStorage.getItem(i))||!1;if(f<=2&&(!r||r&&Date.now()>r)){if(!n.shouldShowDSBFullWidth()&&!n.config.useCobaltCSS){const n=localStorage.getItem("CodexUpsellDismissed"),t=localStorage.getItem("CodexUpsellLaunched");if(!n&&!t)return}localStorage.setItem(u,(Date.now()+3456e5).toString());localStorage.setItem(i,"true");this.pendRefresh(3,3)}else e&&(localStorage.setItem(i,"false"),(t=this===null||this===void 0?void 0:this._dsbViewModel)===null||t===void 0?void 0:t.hideMobileAppUpsellCard())}getCurrentQuery(){if(this!==null&&this!==void 0)return this.currentQuery}}n.DynamicSearchManager=s}(WSB||(WSB={})),function(n){class t{constructor(t){this._page=t;this.pastMomentsContentCache={cacheTime:0,response:null};this.multiMomentsContentCache={cacheTime:0,response:null};this.dismissedMomentsContentCache={};this.DSBV2ContentCache={cacheTime:0,response:null};this.instrumentedBlendedProps=[];this.hasPendingGleamUpdate=!1;this.kValueC=n.InstrumentationCommon.KVALUE_DSB_CURRENT_DAY_CONTENT;this.kValueP=n.InstrumentationCommon.KVALUE_DSB_PAST_DAYS_CONTENT;this.kValueV2=n.InstrumentationCommon.KVALUE_DSB_V2_CONTENT;this.kValueM=n.InstrumentationCommon.KVALUE_DSB_MERGED_CONTENT;this.isVisible=!1;this.isDSBMergedCallSuccess=0;this.dwellStartTime=-1;this.dwellEndTime=-1;this.dwellTime=-1;this.DataModelStorageKey=n.config.dsbCacheKey;this.PastMomentsDataModelStorageKey=n.config.dsbFlipperCacheKey;this.DismissedMomentsStorageKey=n.config.dsbDismissCacheKey;this.DSBV2DataModelStorageKey=n.config.dsbV2CacheKey;this.codexStatusCacheKey="userCodexStatus";this.currentUserIDCacheKey="currentDSBUserId";this.serverIG="";this.DSBSearchCallStatusCacheKey="DSBSearchCallStatus";this.DSBSearchCallStatus="None";this.dsbUser=null;this.DSBGleamBlobCacheKey="wsbGleamBlobCacheMap";this.resetActiveStatus();this.loadDynamicSearchContentFromCache();this.dsbBaseUrl="/DSB";this.dsbV2BaseUrl="/DSB/search";n.config.enableOfflineWithWeb&&n.config.webHost&&n.isBrowserOnline()&&(this.dsbBaseUrl=n.config.webHost+this.dsbBaseUrl,this.dsbV2BaseUrl=n.config.webHost+this.dsbV2BaseUrl);n.Host.bindDismissed(()=>{var t,i;this.renderOnDismissReason!=null&&(this.render(),this.renderOnDismissReason==1&&n.dsbManager.allowSuspension(),this.renderOnDismissReason=null);const r=document===null||document===void 0?void 0:document.activeElement;r&&r.blur();(t=_qs("#dynamic-pane .dsb-moment-content"))===null||t===void 0?void 0:t.classList.add("b_hide");n.shouldShowDSBFullWidth()&&((i=_qs("#dynamic-pane-full .dsbFullWidth"))===null||i===void 0?void 0:i.classList.add("b_hide"));n.placeholdertextNeedUpdate&&n.isTSInSearchBoxAvailable()&&this.updateTSInSearchBox()});n.Host.bindShown(()=>{var t,i;(t=_qs("#dynamic-pane .dsb-moment-content"))===null||t===void 0?void 0:t.classList.remove("b_hide");n.shouldShowDSBFullWidth()&&((i=_qs("#dynamic-pane-full .dsbFullWidth"))===null||i===void 0?void 0:i.classList.remove("b_hide"))});n.Host.bindAccountChanged(()=>{var t;if(this.shouldShowBingGleam()){const i=(t=n.Host.getConnectedAccountInfo(0))===null||t===void 0?void 0:t.accountId;if(i){const t=n.LightweightStorage.getItem(this.currentUserIDCacheKey);i!=t&&n.LightweightStorage.setItem(this.currentUserIDCacheKey,i)}}})}getName(){return"DynamicSearchViewModel"}isEnabled(){return!0}getUpdateIntervalMins(t){return n.isTSInSearchBoxAvailable()?t?this.getDSBContentUpdateIntervalMins():n.UPDATE_PLACEHOLDERTEXT_INTERVAL_MINS:this.getDSBContentUpdateIntervalMins()}getDSBContentUpdateIntervalMins(){var t;return n.TestHookUrlParameters?(t=n.TestHookUrlParameters.dsbUpdateInterval)!==null&&t!==void 0?t:n.DEFAULT_DSB_UPDATE_INTERVAL_MINS:n.DEFAULT_DSB_UPDATE_INTERVAL_MINS}getDSBGleamExpiryInMins(){var t;return n.TestHookUrlParameters?(t=n.TestHookUrlParameters.dsbGleamExpiryMins)!==null&&t!==void 0?t:n.DEFAULT_DSB_GLEAM_EXPIRY_MINS:n.DEFAULT_DSB_GLEAM_EXPIRY_MINS}getDynamicSearchBoxContent(){return this.dynamicSearchBoxContent}getSearchAppearanceGleamContent(){return this.searchAppearanceGleamContent}hideMobileAppUpsellCard(){this._page.hideMobileAppUpsellCard()}resetActiveStatus(){const t=n.getCurrentDateDSB();this.activeMomentsIndexMap={};const i=n.getDateStringInDSBFormat(t);this.activeMomentDate=i;this.currentDateDSBStr=i;this.momentDatesFlipper=n.getDSBMomentDatesForFlipper(t);this.previousMomentDate=this.momentDatesFlipper[this.momentDatesFlipper.length-2];this.nextMomentDate=this.momentDatesFlipper[0]}loadDynamicSearchContentFromCache(){(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||(this.resetInstrumentation(2),n.config.enableDSBMergedRefactor&&this.loadDSBSearchFallbackStatus(),this.loadDismissedMomentsFromCache(),this.loadCurrentDayContentFromCache(),n.config.disableDSBFlipper||this.loadPastDaysContentFromCache(),n.config.enableDSBMergedRefactor||this.isDSBMergedCallSuccess<0&&n.isDSBFullWidthFlightEnabled()&&this.loadDSBV2ContentFromCache())}loadDSBV2ContentFromCache(){const t=n.LightweightStorage.getItem(this.DSBV2DataModelStorageKey);if(t&&n.isDSBFullWidthFlightEnabled()){this.DSBV2ContentCache=JSON.parse(t);const{cacheTime:i,response:r}=this.DSBV2ContentCache,u=i+this.getDSBGleamExpiryInMins()*n.MINS_TO_MILLIS;n.getCurrentTime()<u&&(this.DSBMiniserpDataModel=this.parseMultiMomentsResponse(r,3,undefined),this.DSBMiniserpDataModel||this.instrumentDSBFallback(13,3,null,t))}}loadCurrentDayContentFromCache(){var t,i,r;const u=n.LightweightStorage.getItem(this.DataModelStorageKey);if(u){this.multiMomentsContentCache=JSON.parse(u);const{cacheTime:e,response:c}=this.multiMomentsContentCache;this.gleamDataCacheTime=e;const l=e+this.getDSBGleamExpiryInMins()*n.MINS_TO_MILLIS;if(n.getCurrentTime()<l){let t=n.isDSBV2EnabledMarket()&&this.DSBSearchCallStatus!=="FallbacktoV2"?5:1;this.multiMomentsDataModel=this.parseMultiMomentsResponse(c,t,!0,n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode());this.multiMomentsDataModel||this.instrumentDSBFallback(13,t,null,u)}this.resetStatusBasedOnDismissedMoment();const f=(t=this.multiMomentsDataModel)===null||t===void 0?void 0:t.moments[(i=this.activeMomentsIndexMap[this.currentDateDSBStr])!==null&&i!==void 0?i:0];let o=this.getGleamDataFromMoment(f),s=(r=f===null||f===void 0?void 0:f.momentMetadata)===null||r===void 0?void 0:r.MomentType,h=this.getGleamSetReason(f);if(this.shouldShowBingGleam()){let n=this.loadBingGleamFromCache("loadCurrentDayContentFromCache");n&&(o=n,s=undefined,h=4)}n.isSearchPointsOfFlexibilityEnabled()?this.setGleamDataPoFSchema(o,!1,h,s):this.setGleamData(o,e,!1,h,s);this.hasPendingGleamUpdate=!0}}updateTSInSearchBox(){var i,r,u;const t=(i=this.multiMomentsDataModel)===null||i===void 0?void 0:i.moments[(r=this.activeMomentsIndexMap[this.currentDateDSBStr])!==null&&r!==void 0?r:0];let f=this.getGleamDataFromMoment(t);if(f){const n=(u=t===null||t===void 0?void 0:t.momentMetadata)===null||u===void 0?void 0:u.MomentType;this.setGleamData(f,this.gleamDataCacheTime,!0,6,n)}n.placeholdertextNeedUpdate=!1}getGleamDataFromMoment(t){var i,r,u,f,e;let o=(r=(i=t===null||t===void 0?void 0:t.sectionGroups)===null||i===void 0?void 0:i.find(n=>n.cardType==="Hero"))===null||r===void 0?void 0:r.sections;if(o){let t=(f=(u=o[0])===null||u===void 0?void 0:u.gleamData)!==null&&f!==void 0?f:null;if(t&&"LightGleamUrl"in t&&n.isTSInSearchBoxAvailable()){const u=t.PlaceHolderText;let r;if(r=n.isTSFallbackToANA||n.isUserDisableTSInSearchBox()?"":(e=n.loadFirstTSQueryFromWSBCache())!==null&&e!==void 0?e:"",u===r&&n.placeholdertextNeedUpdate)return null;t.PlaceHolderText=r;const i=this.transformGleamData(t);if(i[t===null||t===void 0?void 0:t.LightGleamUrl]&&i[t===null||t===void 0?void 0:t.DarkGleamUrl]){const n=n=>{const t=Math.floor(Math.random()*4294967295).toString(16).padStart(8,"0"),i=Math.floor(Math.random()*4294967295).toString(16).padStart(8,"0");return`${n}${t}-${i}`};t.TelemetryId=n("ODSWG.");t.LightGleamBlob=i[t.LightGleamUrl];t.DarkGleamBlob=i[t.DarkGleamUrl]}}return t}return null}shouldShowBingGleam(){if(!n.config.useCobaltCSS||!n.config.enableCodexGleam||!n.VelocityKeys||!n.isCodexEligible())return!1;const t=n.VelocityKeys.getFeatureStatus(43349158);return t!=="0"?t==="1":n.VelocityKeys.isFeatureEnabled(43572857)}loadPastDaysContentFromCache(){const t=n.LightweightStorage.getItem(this.PastMomentsDataModelStorageKey);if(t){this.pastMomentsContentCache=JSON.parse(t);const{response:i}=this.pastMomentsContentCache;this.isPastMomentsDataExpired()||(this.pastMomentsDataModel=this.parseMultiMomentsResponse(i,2,undefined,n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode()))}}loadDismissedMomentsFromCache(){const t=n.LightweightStorage.getItem(this.DismissedMomentsStorageKey);if(t){this.dismissedMomentsContentCache=JSON.parse(t);let n=!1;const i=this.getValidDismissKeys();for(let t in this.dismissedMomentsContentCache)i.indexOf(t)===-1&&(delete this.dismissedMomentsContentCache[t],n=!0);n&&this.setDismissedMomentsContentToCache(this.dismissedMomentsContentCache)}}setDynamicSearchMultiMomentsContentToCache(t){(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||n.LightweightStorage.setItem(this.DataModelStorageKey,JSON.stringify(t))}setDSBV2MultiMomentsContentToCache(t){(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||n.LightweightStorage.setItem(this.DSBV2DataModelStorageKey,JSON.stringify(t))}setDSBPastMomentsContentToCache(t){(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||n.LightweightStorage.setItem(this.PastMomentsDataModelStorageKey,JSON.stringify(t))}setDismissedMomentsContentToCache(t){(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||n.LightweightStorage.setItem(this.DismissedMomentsStorageKey,JSON.stringify(t))}setBingGleamToCache(t,i){var r,u;if((n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?!void 0:!n.TestHookUrlParameters.disableDSBCache)&&((r=i===null||i===void 0?void 0:i.LightGleamUrl)===null||r===void 0?void 0:r.indexOf("BingChatNavigation"))>-1){let f={user:t,gleam:i,cacheTime:n.getCurrentTime()},r=(u=n.getAccessTokenManager())===null||u===void 0?void 0:u.getSelectedAccountId();r&&(n.LightweightStorage.setItem(this.currentUserIDCacheKey,r),n.LightweightStorage.setItem(this.codexStatusCacheKey+r,JSON.stringify(f)));this.bingGleam=i}}loadBingGleamFromCache(){var i,r,u,f;if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)return undefined;try{if(this.bingGleam)return this.bingGleam;let t=(u=(r=(i=n.getAccessTokenManager())===null||i===void 0?void 0:i.getSelectedAccountId())!==null&&r!==void 0?r:n.LightweightStorage.getItem(this.currentUserIDCacheKey))!==null&&u!==void 0?u:(f=this.dsbUser)===null||f===void 0?void 0:f.Id;if(t){let i=JSON.parse(n.LightweightStorage.getItem(this.codexStatusCacheKey+t));if(i===null||i===void 0?void 0:i.gleam)return this.bingGleam=i.gleam,this.bingGleam}}catch(t){t instanceof Error?n.DSBLogError("loadCodexStatusFromCache",`Name: ${t.name}, message: ${t.message}`,`stackTrace: ${t.stack}`):n.DSBLogError("loadCodexStatusFromCache",`failed to load codex status from cache. ex: ${JSON.stringify(t)}`)}return undefined}async set3pSearchAppearance(t){if(n.isThirdPartyGleamSupported()&&t){const i=this.get3pGleamCache(t);if(i&&(i===null||i===void 0?void 0:i.telemetryId)){await this.setGleamDataFromThirdParty(i.gleam,!0);const t=i.cacheTime+n.DEFAULT_3P_GLEAM_CHECK_INTERVAL_MINS*n.MINS_TO_MILLIS;if(n.getCurrentTime()<t)return}this.set3pGleamToCache(t,i===null||i===void 0?void 0:i.gleam);const u=await this.fetch3pGleamSchema(t);u||this.set3pGleamToCache(t,undefined);const r=this.get3pGleamCache(t);((r===null||r===void 0?void 0:r.telemetryId)!==(i===null||i===void 0?void 0:i.telemetryId)||(r===null||r===void 0?void 0:r.gleam)==undefined)&&await this.setGleamDataFromThirdParty(r===null||r===void 0?void 0:r.gleam,!0)}}shouldUpdateGleamAndTimeInterval(){return!0}set3pGleamToCache(t,i){if((n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?!void 0:!n.TestHookUrlParameters.disableDSBCache)&&n.isThirdPartyGleamSupported()&&t){const r=t.applicationUserModelId;let u={telemetryId:i===null||i===void 0?void 0:i.telemetryId,gleam:i,cacheTime:n.getCurrentTime()};n.LightweightStorage.setItem(r,JSON.stringify(u))}}get3pGleamCache(t){if((n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||!n.isThirdPartyGleamSupported()||!t)return undefined;try{let u=t.applicationUserModelId,i=n.LightweightStorage.getItem(u),r;return i&&(r=JSON.parse(i)),r}catch(i){i instanceof Error?n.DSBLogError("load3pGleamFromCache",`Name: ${i.name}, message: ${i.message}`,`stackTrace: ${i.stack}`):n.DSBLogError("load3pGleamFromCache",`failed to load 3p gleam from cache. ex: ${JSON.stringify(i)}`)}return undefined}updateDismissedMomentsContentToCache(n,t){const i=this.createDismissKeyForMoment(n);this.dismissedMomentsContentCache.hasOwnProperty(i)?this.dismissedMomentsContentCache[i].push(t):this.dismissedMomentsContentCache[i]=[t];this.setDismissedMomentsContentToCache(this.dismissedMomentsContentCache)}resetDynamicSearchContent(){this.multiMomentsDataModel=null;this.DSBMiniserpDataModel=null;!n.config.disableDSBFlipper&&this.isPastMomentsDataExpired()&&(this.pastMomentsDataModel=null);this.selectableElementGroups=[];this.dynamicSearchBoxContent=null}loadDSBSearchFallbackStatus(){this.DSBSearchCallStatus=n.LightweightStorage.getItem(this.DSBSearchCallStatusCacheKey)}setDSBSearchFallbackStatus(t){n.config.enableDSBMergedRefactor&&(this.DSBSearchCallStatus=t,n.LightweightStorage.setItem(this.DSBSearchCallStatusCacheKey,this.DSBSearchCallStatus))}getInstrumentProps(){var t,i,r,u;if(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())return this.instrumentedBlendedProps;if(n.config.enableRenderMomentDataSource){const n=this.activeMomentsIndexMap[this.activeMomentDate];if(this.activeMomentDate==this.currentDateDSBStr){if((t=this.instrumentedPropsCI)===null||t===void 0?void 0:t.hasOwnProperty(n!==null&&n!==void 0?n:0))return(i=this.instrumentedPropsCI)===null||i===void 0?void 0:i[n!==null&&n!==void 0?n:0]}else if((r=this.instrumentedPropsPI)===null||r===void 0?void 0:r.hasOwnProperty(n!==null&&n!==void 0?n:0))return(u=this.instrumentedPropsPI)===null||u===void 0?void 0:u[n!==null&&n!==void 0?n:0];return null}return this.instrumentedPropsC&&this.instrumentedPropsP?this.instrumentedPropsC.concat(this.instrumentedPropsP):this.instrumentedPropsC||this.instrumentedPropsP}updateInstrumentProps(t,i,r){n.config.enableRenderMomentDataSource&&r>=0?this.activeMomentDate==this.currentDateDSBStr?(this.instrumentedPropsCI||(this.instrumentedPropsCI=[]),this.instrumentedPropsCI[r]=this.instrumentedPropsCI[r]?this.instrumentedPropsCI[r].concat(t):t):(this.instrumentedPropsPI||(this.instrumentedPropsPI=[]),this.instrumentedPropsPI[r]=this.instrumentedPropsPI[r]?this.instrumentedPropsPI[r].concat(t):t):i==2?this.instrumentedPropsP=this.instrumentedPropsP?this.instrumentedPropsP.concat(t):t:this.instrumentedPropsC=this.instrumentedPropsC?this.instrumentedPropsC.concat(t):t}getValidDismissKeys(){return this.momentDatesFlipper.map(n=>this.createDismissKeyForMoment(n))}createDismissKeyForMoment(t){return`${t}-${n.Host.getRegion()}-${n.Host.getLanguage()}`}resetInstrumentation(t){this.kValueC=n.InstrumentationCommon.KVALUE_DSB_CURRENT_DAY_CONTENT;this.kValueV2=n.InstrumentationCommon.KVALUE_DSB_V2_CONTENT;this.kValueM=n.InstrumentationCommon.KVALUE_DSB_MERGED_CONTENT;this.instrumentedBlendedProps=[];this.instrumentedPropsC=null;this.instrumentedPropsCI=null;t==2&&(this.kValueP=n.InstrumentationCommon.KVALUE_DSB_PAST_DAYS_CONTENT,this.instrumentedPropsP=null,this.instrumentedPropsPI=null)}getKValue(n){switch(n){case 2:return this.kValueP++;case 3:return this.kValueV2++;case 5:return this.kValueM++;default:return this.kValueC++}}getUrlHandoffType(t){let i=n.tryParseUrl(t,!0);return i?n.isBingHost(i)?0:n.isMsnHost(i)?20:1:0}composeDSBUrlParams(t){n.TestHookUrlParameters&&(t=n.UrlParameters.copyTestParametersTo(t),n.TestHookUrlParameters.dsbBag&&(t=ThresholdUtilities.setUrlParameter(t,"bag",encodeURIComponent(n.TestHookUrlParameters.dsbBag))),n.TestHookUrlParameters.dsbMockDateTimeParam&&(t=ThresholdUtilities.setUrlParameter(t,"dsbMockDateTime",encodeURIComponent(n.TestHookUrlParameters.dsbMockDateTimeParam))),(n.MockUrlParameters===null||n.MockUrlParameters===void 0?void 0:n.MockUrlParameters.isTest)&&(n.TestHookUrlParameters.dsbBag||(t=ThresholdUtilities.setUrlParameter(t,"bag",encodeURIComponent("VP_WindowsSearchBox.WSB.DSB.dsb_default"))),n.TestHookUrlParameters.dsbMockDateTimeParam||(n.TestHookUrlParameters.dsbMockDateTimeParam="2023-01-10")),n.TestHookUrlParameters.dsbScenario&&(t=ThresholdUtilities.setUrlParameter(t,"dsbScenario",encodeURIComponent(n.TestHookUrlParameters.dsbScenario))),n.TestHookUrlParameters.utcnow&&(t=ThresholdUtilities.setUrlParameter(t,"utcnow",encodeURIComponent(n.TestHookUrlParameters.utcnow))));const i=n.getCurrentDateDSB();let r=i.toLocaleString("en-US");return i<n.DateTimeReference&&n.log(`getCurrentDateDSB() return incorrect time! getCurrentDateDSB(): '${r}' `),t=ThresholdUtilities.setUrlParameter(t,"clientDateTime",encodeURIComponent(r)),t=ThresholdUtilities.setUrlParameter(t,"cc",n.Host.getRegion()),t=ThresholdUtilities.setUrlParameter(t,"setlang",n.getCurrentLanguage()),ThresholdUtilities.setUrlParameter(t,"dsbschemaversion","1.1")}composeDSBPastMomentsUrlParams(n){return n=this.composeDSBUrlParams(n),ThresholdUtilities.setUrlParameter(n,"pastMomentsInDays","6")}composeDSBMiniserpUrlParams(t,i){if(n.TestHookUrlParameters){n.TestHookUrlParameters.dsbMockDateTimeParam&&(t=ThresholdUtilities.setUrlParameter(t,"dsbMockDateTime",encodeURIComponent(n.TestHookUrlParameters.dsbMockDateTimeParam)));let r=ThresholdUtilities.getUrlParameter(t,"addfeaturesnoexpansion"),i;t=n.UrlParameters.copyTestParametersTo(t);t=ThresholdUtilities.setUrlParameter(t,"client","windowsminiserp");i=ThresholdUtilities.getUrlParameter(t,"addfeaturesnoexpansion");i&&r&&(i+=","+r);t=ThresholdUtilities.setUrlParameter(t,"addfeaturesnoexpansion",i);n.TestHookUrlParameters.miniSerpBag&&(t=ThresholdUtilities.setUrlParameter(t,"bag",encodeURIComponent(n.TestHookUrlParameters.miniSerpBag)))}t=ThresholdUtilities.setUrlParameter(t,"q",i);t=ThresholdUtilities.setUrlParameter(t,"format","dsbjson");t=ThresholdUtilities.setUrlParameter(t,"client","windowsminiserp");t=ThresholdUtilities.setUrlParameter(t,"dsbschemaversion","1.1");t=ThresholdUtilities.setUrlParameter(t,"dsbminiserp","1");t=ThresholdUtilities.setUrlParameter(t,"cc",n.Host.getRegion());t=ThresholdUtilities.setUrlParameter(t,"setlang",n.getCurrentLanguage());const r=n.getCurrentDateDSB();let u=r.toLocaleString("en-US");return r<n.DateTimeReference&&n.log(`getCurrentDateDSB() return incorrect time! getCurrentDateDSB(): '${u}' `),t=ThresholdUtilities.setUrlParameter(t,"clientDateTime",encodeURIComponent(u))}composeDSBMergedUrlParams(t,i){if(n.TestHookUrlParameters){n.TestHookUrlParameters.dsbMockDateTimeParam&&(t=ThresholdUtilities.setUrlParameter(t,"dsbMockDateTime",encodeURIComponent(n.TestHookUrlParameters.dsbMockDateTimeParam)));let r=ThresholdUtilities.getUrlParameter(t,"addfeaturesnoexpansion"),i;t=n.UrlParameters.copyTestParametersTo(t);t=ThresholdUtilities.setUrlParameter(t,"client","windowsminiserp");i=ThresholdUtilities.getUrlParameter(t,"addfeaturesnoexpansion");i&&r&&(i+=","+r);t=ThresholdUtilities.setUrlParameter(t,"addfeaturesnoexpansion",i);n.TestHookUrlParameters.miniSerpBag&&(t=ThresholdUtilities.setUrlParameter(t,"bag",encodeURIComponent(n.TestHookUrlParameters.miniSerpBag)));n.TestHookUrlParameters.clientversion&&(t=ThresholdUtilities.setUrlParameter(t,"clientversion",encodeURIComponent(n.TestHookUrlParameters.clientversion)))}t=ThresholdUtilities.setUrlParameter(t,"dsbmr","1");t=ThresholdUtilities.setUrlParameter(t,"format","dsbjson");t=ThresholdUtilities.setUrlParameter(t,"client","windowsminiserp");t=ThresholdUtilities.setUrlParameter(t,"dsbschemaversion","1.1");t=ThresholdUtilities.setUrlParameter(t,"dsbminiserp","1");t=ThresholdUtilities.setUrlParameter(t,"q","q");i&&!n.config.disableDSBFlipper&&(t=ThresholdUtilities.setUrlParameter(t,"pastMomentsInDays","6"));t=ThresholdUtilities.setUrlParameter(t,"cc",n.Host.getRegion());t=ThresholdUtilities.setUrlParameter(t,"setlang",n.getCurrentLanguage());const r=n.getCurrentDateDSB();let u=r.toLocaleString("en-US");return r<n.DateTimeReference&&n.log(`getCurrentDateDSB() return incorrect time! getCurrentDateDSB(): '${u}' `),t=ThresholdUtilities.setUrlParameter(t,"clientDateTime",encodeURIComponent(u))}isValidDSBMultiMomentsContent(t){if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.isTest)return!0;if(!t||!t.ContentCollection||t.ContentCollection.length==0)return!1;let i=0;return t.ContentCollection.forEach(t=>{t.Data&&t.Data.length!=0?i++:n.DSBLogWarning("MultiMomentResponseValidation",`Moment ${t.Order} at Date ${t.Date} has empty data field.`)}),i>0}getUXTemplateName(t,i){var u,f;let r=(u=t===null||t===void 0?void 0:t.FieldsStore)===null||u===void 0?void 0:u.UXTemplateList;if((n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbMockUXTemplateList)&&i==(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbMockUXTemplateCardType)&&(r=n.TestHookUrlParameters.dsbMockUXTemplateList.split(",")),r)for(let t=0;t<r.length;t++)if(n.View.DSB.Templates[r[t]])return n.View.DSB.Templates[r[t]];return((f=t===null||t===void 0?void 0:t.FieldsStore)===null||f===void 0?void 0:f.UXTemplateName)?n.View.DSB.Templates[t.FieldsStore.UXTemplateName]:(t===null||t===void 0?void 0:t.UXTemplateName)?n.View.DSB.Templates[t.UXTemplateName]:undefined}getDSBOcidOrFormInstrumentedItem(t,i,r,u,f){let e=n.InstrumentedItem.createInstrumentedItemKvalueOverride(this.getKValue(u),f!==null&&f!==void 0?f:t===null||t===void 0?void 0:t.Scenario,i,u);return i==20?e.setProperty("ocid",r):n.isBingHandoffType(i)&&e.setProperty("form",r),e}setInstrumentationProperties(n,t){return Object.keys(t).forEach(i=>{let r=t[i];r&&typeof r!="string"&&(r=r.toString());i!=="momentDate"&&i!=="workflow"&&i!=="scenario"&&n.setProperty(i,r)}),n}dsbSubInstrumentationItems(t,i,r=[],u){const{scenario:f,workflow:e}=u;t===null||t===void 0?void 0:t.forEach(t=>{var s,h;let c=(s=t===null||t===void 0?void 0:t.HandOffType)!==null&&s!==void 0?s:this.getUrlHandoffType(t===null||t===void 0?void 0:t.ClickThroughUrl),l=(h=t===null||t===void 0?void 0:t.QSCode)!==null&&h!==void 0?h:n.getDSBFormCode(i===null||i===void 0?void 0:i.Scenario),o=this.getDSBOcidOrFormInstrumentedItem(i,c,l,e,f);t.instrumentedItem=o;o=this.setInstrumentationProperties(o,u);r.push(o)})}createDSBInstrumentation(t,i){let e=[];const{HandOffType:s,Items:u,MegaLink:h,QSCode:o,OverlayButtons:c,WholePageTabs:r}=t===null||t===void 0?void 0:t.FieldsStore;o&&(t.QSCode=o);t.HandOffType=s;let f=this.getDSBOcidOrFormInstrumentedItem(t,s,o,i.workflow);if(f=this.setInstrumentationProperties(f,i),(u!==null&&u!==void 0?u:r===null||r===void 0?void 0:r.Items)&&(r&&(i.scenario=r===null||r===void 0?void 0:r.Scenario),this.dsbSubInstrumentationItems(u!==null&&u!==void 0?u:r===null||r===void 0?void 0:r.Items,t,e,i)),c&&(i.scenario="OverlayButton",this.dsbSubInstrumentationItems(c,t,e,i)),h&&(i.scenario=i.scenario+"MegaLink",this.dsbSubInstrumentationItems([h],t,e,i,"-999"),t.FieldsStore.MegaLink.Id=`mega-link`+Math.random().toString(16).substring(2)),n.config.enableUserEngagementLog){f.setUserEngagementContent({engagementType:"Click",engagementSurface:"ZI",dataSource:t.Scenario,suggestionType:f.getQsCode(),zeroInputExperienceType:"DSB",zeroInputItemType:"Other"});for(let n of e)n.setUserEngagementContent({engagementType:"Click",engagementSurface:"ZI",dataSource:t.Scenario,suggestionType:f.getQsCode(),zeroInputExperienceType:"DSB",zeroInputItemType:"Other"})}return{instrumentedItem:f,subItemInstrumentedItems:e}}parseDSBCards(t,i,r,u,f,e,o,s){var v;let y=[],h,p=[],c=null;const{cardType:a,momentDate:w,workflow:l}=i;return t===null||t===void 0?void 0:t.forEach(t=>{var v,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot;let st=this.getUXTemplateName(t,a);if(!st)return n.DSBLogError("Exception",`No UXTemplate Found for Card ${t===null||t===void 0?void 0:t.Scenario}`+` UXTemplateList field: ${(v=t===null||t===void 0?void 0:t.FieldsStore)===null||v===void 0?void 0:v.UXTemplateList}.`+` UXTemplateName field: ${t===null||t===void 0?void 0:t.UXTemplateName}`),null;const ht=(b=t===null||t===void 0?void 0:t.FieldsStore)===null||b===void 0?void 0:b.EdgeHubAppId;ht&&(i.edgeHubAppId=ht);i.scenario=(k=t===null||t===void 0?void 0:t.Scenario)!==null&&k!==void 0?k:(d=t===null||t===void 0?void 0:t.FieldsStore)===null||d===void 0?void 0:d.Scenario;const{instrumentedItem:ct,subItemInstrumentedItems:lt}=this.createDSBInstrumentation(t,i);if(h={FieldsStore:t.FieldsStore,Scenario:t.Scenario,id:t.Scenario+Math.random().toString(16).substring(2),instrumentedItem:ct,subItemInstrumentedItems:lt,imageHostName:r,momentMetadata:f,user:u},y.push(h),a=="Hero"){let i;if(l==3){const n=(tt=(nt=(g=this.multiMomentsDataModel)===null||g===void 0?void 0:g.moments[0])===null||nt===void 0?void 0:nt.sectionGroups)===null||tt===void 0?void 0:tt.find(n=>(n===null||n===void 0?void 0:n.cardType)=="Hero");i=(rt=(it=n===null||n===void 0?void 0:n.sections[0])===null||it===void 0?void 0:it.props)===null||rt===void 0?void 0:rt.showDismissIcon}else i=l==2||l==1||l==5?!o:!1;h.showDismissIcon=i;h.onDismissHandler=()=>{l==3?this.onDismissV2MomentHandler(e):this.onDismissMomentHandler(e,w)};s&&((ut=t.FieldsStore)===null||ut===void 0?void 0:ut.GleamData)&&n.isTSInSearchBoxEnabled()&&this.transformGleamData((ft=t.FieldsStore)===null||ft===void 0?void 0:ft.GleamData)}if(t.Scenario=="MobileAppUpsellCard"){const n="MobileAppUpsellCard-CardShown",i=JSON.parse(localStorage.getItem(n))||!1;if(!i)return;const r="MobileAppUpsellCard-ExpiryDate",t="MobileAppUpsellCard-ExpiryCount",u=12096e5,f=parseInt(localStorage.getItem(t))+1||1;h.onDismissHandler=()=>{localStorage.setItem(r,(Date.now()+u).toString()),localStorage.setItem(t,f.toString()),localStorage.setItem(n,"false"),this.hideMobileAppUpsellCard()}}c=a=="Hero"&&((et=t.FieldsStore)===null||et===void 0?void 0:et.GleamData)?(ot=t.FieldsStore)===null||ot===void 0?void 0:ot.GleamData:c;p.push({sectionView:st,props:h,cardType:a,gleamData:c})}),u&&(this.dsbUser=u,this.dsbUser.Id=(v=n.Host.getConnectedAccountInfo(0))===null||v===void 0?void 0:v.accountId,c&&this.setBingGleamToCache(u,c),u.IsBirthday&&this.logUserBirthday()),{sections:p,instrumentedProps:y}}isSectionGroupSupportedInMsbDsbBlendedMode(t){var i,r,u,f;return((i=n.config.msbDsbBlendedMsaCards)!==null&&i!==void 0?i:[]).includes(t.CardType)?t.CardType==="Mega"&&((u=(r=t.Cards)===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.Scenario)?((f=n.config.msbDsbBlendedMsaMegaScenarios)!==null&&f!==void 0?f:[]).includes(t.Cards[0].Scenario):!0:!1}parseMoment(t,i,r,u,f,e,o,s){var h,c,l,a,v;t.MomentMetadata.StartTime=(c=(h=t.MomentMetadata)===null||h===void 0?void 0:h.StartTime)!==null&&c!==void 0?c:n.DayStartSec;t.MomentMetadata.EndTime=(a=(l=t.MomentMetadata)===null||l===void 0?void 0:l.EndTime)!==null&&a!==void 0?a:n.DayEndSec;let y=[];(v=t===null||t===void 0?void 0:t.Data)===null||v===void 0?void 0:v.forEach(n=>{let h,c={};c.cardType=n.CardType;c.workflow=u;c.momentDate=t===null||t===void 0?void 0:t.Date;h=this.parseDSBCards(n.Cards,c,i,r,t===null||t===void 0?void 0:t.MomentMetadata,f,e,s);h.sections.length>0&&(o?this.isSectionGroupSupportedInMsbDsbBlendedMode(n)&&(this.instrumentedBlendedProps=this.instrumentedBlendedProps.concat(h.instrumentedProps)):this.updateInstrumentProps(h.instrumentedProps,u,f),(!o||this.isSectionGroupSupportedInMsbDsbBlendedMode(n))&&y.push({cardType:n.CardType,UXOrder:n.UXOrder,placement:n.Placement,sections:h.sections,id:n.CardType+Math.random().toString(16).substring(2)}))});const p=this.createDismissKeyForMoment(t.Date),w=this.dismissedMomentsContentCache.hasOwnProperty(p)?this.dismissedMomentsContentCache[p]:[];return{date:t.Date,order:t.Order,momentMetadata:t===null||t===void 0?void 0:t.MomentMetadata,sectionGroups:y.sort((n,t)=>n.UXOrder-t.UXOrder),isDismissed:w.indexOf(t.Order)!==-1,isMainColumnInLeft:t.IsMainColumnInLeft,onFlipHandler:(n,t)=>{this.onFlipHandler(n,t)}}}getDateToLastMomentIndexMap(t,i,r){var u,f,e,o;const s={};if(t==2||t==1||t==5)if(r){let t=(i===null||i===void 0?void 0:i.length)-1;while(t>=0){let r=i[t];const h=((f=(u=r.MomentMetadata)===null||u===void 0?void 0:u.EndTime)!==null&&f!==void 0?f:n.DayEndSec)-((o=(e=r.MomentMetadata)===null||e===void 0?void 0:e.StartTime)!==null&&o!==void 0?o:n.DayStartSec);if(h==n.DayEndSec-n.DayStartSec){s[r.Date]=t;break}t--}}else i.forEach((n,t)=>{s[n.Date]=t});return s}parseMultiMomentsResponse(t,i,r,u){let f=[];i!=2&&t.ContentCollection.sort((n,t)=>n.Order-t.Order);const o=this.getDateToLastMomentIndexMap(i,t.ContentCollection,r);let e=n.DayEndSec+1;return t.ContentCollection.forEach((n,s)=>{var c,l;let a;(i==2||i==1||i==5)&&(a=s==o[n.Date]);const h=this.parseMoment(n,t.ImageHostName,t.User,i,s,a,u,r);if(r){if(this.isMomentAvaiable(h)){let n=((c=h.momentMetadata)===null||c===void 0?void 0:c.EndTime)-((l=h.momentMetadata)===null||l===void 0?void 0:l.StartTime);n<e&&(this.activeMomentsIndexMap[h.date]=s,e=n)}}else i!=3&&this.isMomentAvaiable(h)&&!this.activeMomentsIndexMap.hasOwnProperty(h.date)&&(this.activeMomentsIndexMap[h.date]=s);f.push(h)}),{moments:f,imageHostName:t.ImageHostName}}handleMultiMomentsFetched(t,i,r){var f,e,o;this.resetInstrumentation(r);const v=n.getCurrentDateDSB(),l=v.getTime();this.serverIG=t.ServerImpressionGuid;this.nonBlendedMomentsDataModel=this.parseMultiMomentsResponse(t,r,!0);(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())&&(this.blendedMomentsDataModel=this.parseMultiMomentsResponse(t,r,!0,!0));this.multiMomentsDataModel=this.selectMultiMomentsDataModel();this.multiMomentsContentCache={cacheTime:l,response:t};this.setDynamicSearchMultiMomentsContentToCache(this.multiMomentsContentCache);this.resetStatusBasedOnDismissedMoment();const u=(f=this.multiMomentsDataModel)===null||f===void 0?void 0:f.moments[(e=this.activeMomentsIndexMap[this.currentDateDSBStr])!==null&&e!==void 0?e:0];this.gleamDataCacheTime=n.getCurrentTime();let s=this.getGleamDataFromMoment(u),h=(o=u===null||u===void 0?void 0:u.momentMetadata)===null||o===void 0?void 0:o.MomentType,c=this.getGleamSetReason(u);if(this.shouldShowBingGleam()){let n=this.loadBingGleamFromCache("handleMultiMomentsFetched");n&&(s=n,h=undefined,c=4)}let a=l-i;n.isSearchPointsOfFlexibilityEnabled()?this.setGleamDataPoFSchema(s,!0,c,h,a,r):this.setGleamData(s,this.gleamDataCacheTime,!0,c,h,a,r);this.hasPendingGleamUpdate=!1}handlePastMomentsFetched(t,i){const{currentMomentsResponse:u,pastMomentsResponse:r}=this.splitPastMomentsResponse(t);this.handleMultiMomentsFetched(u,i,2);this.pastMomentsDataModel=this.parseMultiMomentsResponse(r,2,undefined,n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode());const f=n.getCurrentTime();let e=n.Host.getRegion(),o=n.Host.getLanguage();this.pastMomentsContentCache={cacheTime:f,region:e,lang:o,response:Object.assign(Object.assign({},t),{ContentCollection:r.ContentCollection})};this.setDSBPastMomentsContentToCache(this.pastMomentsContentCache)}handleDSBMiniserpFetched(t){var u;let r=this.parseMultiMomentsResponse(t,3,undefined),i=(u=r===null||r===void 0?void 0:r.moments[0])===null||u===void 0?void 0:u.sectionGroups.find(n=>n.cardType==="Hero"),f=(i===null||i===void 0?void 0:i.sections)&&(i===null||i===void 0?void 0:i.sections[0]);if(f){this.DSBMiniserpDataModel=r;const i=n.getCurrentTime();this.DSBV2ContentCache={cacheTime:i,response:t};this.setDSBV2MultiMomentsContentToCache(this.DSBV2ContentCache)}else this.DSBMiniserpDataModel=null,n.DSBLogError("fetchDSBMiniserpDataMissing","miniserp response missing DSB content.")}getMiniserpQuery(){var u,f,e,o,s,h,c,l,a,v,y,p,w,b;if(!this.isDifferentDay(new Date((f=(u=this.cachedMiniserpQuery)===null||u===void 0?void 0:u.cacheTime)!==null&&f!==void 0?f:0),n.getCurrentDateDSB()))return this.cachedMiniserpQuery.query;let r,k=(e=this.multiMomentsDataModel)===null||e===void 0?void 0:e.moments[0],i=(o=k===null||k===void 0?void 0:k.sectionGroups)===null||o===void 0?void 0:o.find(n=>n.cardType==="Hero"),t=(i===null||i===void 0?void 0:i.sections)&&(i===null||i===void 0?void 0:i.sections[0]);return r=((h=(s=t===null||t===void 0?void 0:t.props)===null||s===void 0?void 0:s.FieldsStore)===null||h===void 0?void 0:h.MiniSerpQuery)?(l=(c=t===null||t===void 0?void 0:t.props)===null||c===void 0?void 0:c.FieldsStore)===null||l===void 0?void 0:l.MiniSerpQuery:((v=(a=t===null||t===void 0?void 0:t.props)===null||a===void 0?void 0:a.FieldsStore)===null||v===void 0?void 0:v.GleamText)?(p=(y=t===null||t===void 0?void 0:t.props)===null||y===void 0?void 0:y.FieldsStore)===null||p===void 0?void 0:p.GleamText:(b=(w=t===null||t===void 0?void 0:t.props)===null||w===void 0?void 0:w.FieldsStore)===null||b===void 0?void 0:b.Title,r&&(this.cachedMiniserpQuery={cacheTime:n.getCurrentTime(),query:r}),r}async fetchDSBMiniserp(){var r;let f=this.getMiniserpQuery(),t=this.dsbV2BaseUrl;t=this.composeDSBMiniserpUrlParams(t,f);let e=n.getCurrentTime(),u,i;try{u=this.getDSBHeaders(!0);let f=await fetch(t,{headers:u});if(f.ok){n.config.enableDSBFallbackLogs&&(i=(r=f===null||f===void 0?void 0:f.headers)===null||r===void 0?void 0:r.get("x-eventid"));let u,o;try{o=await f.json();u=o}catch(s){return this.instrumentDSBFallback(8,3,u),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToRead_DSBMiniserp","Request Url: "+t+"; TraceID: "+i+"; StatusCode: "+(f===null||f===void 0?void 0:f.status)+"; Response Json: "+JSON.stringify(o)+"; Exception: "+s),!1}return this.isValidDSBMultiMomentsContent(u)||(this.instrumentDSBFallback(9,3,u,u.ServerImpressionGuid),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_InvalidDSBContent_DSBMiniserp","Request Url: "+t+"; TraceID: "+i+"; StatusCode: "+(f===null||f===void 0?void 0:f.status)+"; Data: "+JSON.stringify(u))),this.handleDSBMiniserpFetched(u),n.config.enableDsbFetchNRenderTelemetry||this.instrumentFetch(e,n.getCurrentTime(),3,u.ServerImpressionGuid),!0}this.instrumentDSBFallback(4,3);n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToFetch_DSBMiniserp","Request Url: "+t+"; TraceID: "+i+"; StatusCode: "+(f===null||f===void 0?void 0:f.status))}catch(o){return this.instrumentDSBFallback(5,3),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToParse_DSBMiniserp","Request Url: "+t+"; Headers: "+JSON.stringify(u)+"; Exception: "+o+"; Is Browser Online: "+n.isBrowserOnline()),!1}return!1}isNewDay(){return n.config.disableDSBFlipper?this.isCurrentMomentDataExpired():this.isCurrentMomentDataExpired()||this.isPastMomentsDataExpired()}async fetch(t){var o,s;let i=this.dsbBaseUrl;i=t&&!n.config.disableDSBFlipper?this.composeDSBPastMomentsUrlParams(i):this.composeDSBUrlParams(i);this.isDSBMergedCallSuccess=0;this.DSBSearchCallStatus="None";n.isDSBV2EnabledMarket()&&(this.isDSBMergedCallSuccess=1,this.setDSBSearchFallbackStatus("InitMergedCall"),i=this.composeDSBMergedUrlParams(this.dsbV2BaseUrl,t));let r=t?2:1;n.isDSBV2EnabledMarket()&&(r=t?2:5);let e=n.getCurrentTime(),f=null,u;try{f=this.getDSBHeaders(n.isDSBV2EnabledMarket());let h=await fetch(i,{headers:f}),c,l;if(h.ok){if(n.shouldLogFlightAssignmentsToWindows()){let n=h===null||h===void 0?void 0:h.headers.get("X-FlightsTelemetry-IG"),t=h===null||h===void 0?void 0:h.headers.get("X-FlightsTelemetry-Flight");t&&n&&((o=SearchAppWrapper===null||SearchAppWrapper===void 0?void 0:SearchAppWrapper.CortanaApp)===null||o===void 0?void 0:o.logCriticalFlightsTelemetry(t,n))}n.config.enableDSBFallbackLogs&&(u=(s=h===null||h===void 0?void 0:h.headers)===null||s===void 0?void 0:s.get("x-eventid"));try{l=await h.json();c=l}catch(a){return this.instrumentDSBFallback(8,r,c,c===null||c===void 0?void 0:c.ServerImpressionGuid),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToRead_InitialRequest","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status)+"; Response Json: "+JSON.stringify(l)+"; Exception: "+a),!1}if(!this.isValidDSBMultiMomentsContent(c))if(n.isDSBV2EnabledMarket()){n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBMergedFallbackToV1V2_InvalidDSBContent","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status)+"; Data: "+JSON.stringify(c));this.isDSBMergedCallSuccess=-1;this.setDSBSearchFallbackStatus("FallbacktoV2");i=this.dsbBaseUrl;i=t&&!n.config.disableDSBFlipper?this.composeDSBPastMomentsUrlParams(i):this.composeDSBUrlParams(i);r=t?2:1;f=this.getDSBHeaders();try{if(h=await fetch(i,{headers:f}),h.ok){try{l=await h.json();c=l}catch(a){return this.instrumentDSBFallback(8,r,c),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToRead_FallbackRequest","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status)+"; Response Json: "+JSON.stringify(l)+"; Exception: "+a),!1}return(this.isValidDSBMultiMomentsContent(c)||(this.instrumentDSBFallback(9,r,c,c===null||c===void 0?void 0:c.ServerImpressionGuid),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_InvalidDSBContent_FallbackRequest","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status)+"; Data: "+JSON.stringify(c))),t&&!n.config.disableDSBFlipper?this.handlePastMomentsFetched(c,e):this.handleMultiMomentsFetched(c,e,1),n.isDSBFullWidthFlightEnabled()&&(n.config.enableDsbFetchNRenderTelemetry&&(r=3),await this.fetchDSBMiniserp()),!this.multiMomentsDataModel)?(n.DSBLogError("fetchDSBDataMissing",`Missing DSB content in response from workflow ${r} `),!1):!0}return this.instrumentDSBFallback(4,r),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToFetch_FallbackRequest","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status)),!1}catch(a){return this.instrumentDSBFallback(5,r),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToParse_FallbackRequest","Request Url: "+i+"; Headers: "+JSON.stringify(f)+"; TraceID: "+u+"; Exception: "+a+"; Is Browser Online: "+n.isBrowserOnline()),!1}}else this.instrumentDSBFallback(9,r,c,c===null||c===void 0?void 0:c.ServerImpressionGuid),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_InvalidDSBContent_InitialRequest","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status)+"; Data: "+JSON.stringify(c));return(t&&!n.config.disableDSBFlipper?this.handlePastMomentsFetched(c,e):this.handleMultiMomentsFetched(c,e,r),!this.multiMomentsDataModel)?(n.DSBLogError("fetchDSBDataMissing",`Missing DSB content in response from workflow ${r} `),!1):!0}this.instrumentDSBFallback(4,r);n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToFetch_InitialRequest","Request Url: "+i+"; TraceID: "+u+"; StatusCode: "+(h===null||h===void 0?void 0:h.status))}catch(h){return this.instrumentDSBFallback(5,r),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToParse_InitialRequest","Request Url: "+i+"; Headers: "+JSON.stringify(f)+"; TraceID: "+u+"; Exception: "+h+"; Is Browser Online: "+n.isBrowserOnline()),!1}finally{n.config.enableDsbFetchNRenderTelemetry&&this.instrumentFetch(e,n.getCurrentTime(),r)}return!1}async fetch3pGleamSchema(t){var r;let i=t.dynamicContentEndpoint;if(!i)return!1;const u=n.getCurrentDateDSB();let f=u.toLocaleString("en-US");const e=[{key:"cc",value:n.Host.getRegion()},{key:"setlang",value:n.getCurrentLanguage()},{key:"dateTime",value:encodeURIComponent(f)},{key:"deviceOs",value:n.config.useCobaltCSS?"windows11":"windows10"},{key:"schemaversion",value:n.Host.get3pGleamSchemaVersion()},{key:"gleam",value:"1"}];e.forEach(n=>{i=ThresholdUtilities.setUrlParameter(i,n.key,n.value)});try{let u=await fetch(i),f,e;if(u.ok)try{e=await u.json();f=e;let n=this.get3pGleamCache(t);return n&&(n===null||n===void 0?void 0:n.telemetryId)===(f===null||f===void 0?void 0:f.telemetryId)?!0:(this.set3pGleamToCache(t,f),!0)}catch(o){if(n.config.disableWSBServerTelemetry)return!1;if(this.instrumentDSBFallback(4),n.config.enableDSBFallbackLogs){let t=(r=u===null||u===void 0?void 0:u.headers)===null||r===void 0?void 0:r.get("x-eventid");n.DSBLogError("DSBFallback_FailedToFetch_Gleam","Request Url: "+i+"; TraceID: "+t+"; StatusCode: "+(u===null||u===void 0?void 0:u.status)+"; Response Json: "+JSON.stringify(e)+"; Exception: "+o)}return!1}}catch(o){return n.config.disableWSBServerTelemetry?!1:(this.instrumentDSBFallback(5),n.config.enableDSBFallbackLogs&&n.DSBLogError("DSBFallback_FailedToParse_Gleam","Request Url: "+i+"; Exception: "+o+"; Is Browser Online: "+n.isBrowserOnline()),!1)}return!1}logUserBirthday(){const t=(new Date).getFullYear().toString();n.LightweightStorage.getItem("lastUserBirthday")!=t&&(n.InstrumentationHelper.logClientInstEvent("Select","isBirthday",null,null,"BingTelemetry"),n.LightweightStorage.setItem("lastUserBirthday",t))}async fetchDSBWithTimeout(t){let i=!1,r=!1;const u=new Promise(t=>{n.safeSetTimeout(()=>{if(!i){r=!0;t();return}},n.FETCH_DSB_CONTENT_TIMEOUT_IN_MS,"fetchDSBTimer")}),f=new Promise(async r=>{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbFetchTimeoutSec){const t=n=>new Promise(t=>setTimeout(t,n));await t(n.TestHookUrlParameters.dsbFetchTimeoutSec*1e3)}i=await this.fetch(t);r();return});return Promise.race([u,f]).then(()=>({isFetchDSBSucceed:i,isFetchDSBSucceedWithinRenderTimeout:!r}))}splitPastMomentsResponse(n){let t=null,i=null,r=[];n.ContentCollection.sort((n,t)=>n.Date==t.Date?n.Order>t.Order?1:-1:n.Date>t.Date?1:-1);const u=n.ContentCollection[n.ContentCollection.length-1].Date;return t=Object.assign(Object.assign({},n),{ContentCollection:n.ContentCollection.filter(n=>n.Date===u)}),r=n.ContentCollection.filter(n=>n.Date!==u),i=Object.assign(Object.assign({},n),{ContentCollection:r}),{currentMomentsResponse:t,pastMomentsResponse:i}}isValidPastMoments(){var t,i;let r=0,u="";return((i=(t=this.pastMomentsDataModel)===null||t===void 0?void 0:t.moments)===null||i===void 0?void 0:i.forEach(n=>{n.date!=u&&(r++,u=n.date)}),n.config.disableDSBFlipper||n.config.disableDSBPastMoments)?!1:r!=6&&!(n.MockUrlParameters===null||n.MockUrlParameters===void 0?void 0:n.MockUrlParameters.isTest)?(n.DSBLogWarning("MultiMomentResponseValidation","Past moment is missing"),!1):!0}getSelectableItems(){const t=[];if(n.shouldShowDSBFullWidth()){if(!this.selectableElementGroupsFullWidth)return[];for(const n of this.selectableElementGroupsFullWidth)t.push(...n)}else{if(!this.selectableElementGroups)return[];for(const n of this.selectableElementGroups)t.push(...n)}return t}getSelectableItemsByGroup(){var t,i;return n.shouldShowDSBFullWidth()?(n.isCurrentDayMainMomentDismissed&&this.buildInteractionModel(),(t=this.selectableElementGroupsFullWidth)!==null&&t!==void 0?t:[]):(this.buildInteractionModel(),(i=this.selectableElementGroups)!==null&&i!==void 0?i:[])}createOnClickHandler(t){return i=>{i.keyCode==13&&(i.preventDefault(),t.click(),n.keepFoucsOnThisElement(t===null||t===void 0?void 0:t.id)||n.Host.setFocusInSearchBox(null,"DSB_KeyToClick"))}}buildInteractionModel(){var i,r,u,f,e,o,s,h,c,l;this.selectableElementGroups=[];this.selectableElementGroupsFullWidth=[];let a=[],t=[];if(n.isDSBFullWidthFlightEnabled()&&n.StaticHtmlElements.dynamicPaneFullWidth){let o=(u=(r=(i=n.StaticHtmlElements.dynamicPaneFullWidth.children[0])===null||i===void 0?void 0:i.children[0])===null||r===void 0?void 0:r.children[0])===null||u===void 0?void 0:u.children,s=(f=_qs("#codex-upsell-module",n.StaticHtmlElements.dynamicPaneFullWidth))===null||f===void 0?void 0:f.children,h=(e=_qs("#dsb-fwp-right-content",n.StaticHtmlElements.dynamicPaneFullWidth))===null||e===void 0?void 0:e.children;t.push(o);t.push(s);t.push(h);this.selectableElementGroupsFullWidth=this.getSelectableElements(t)}a.push((s=(o=n.StaticHtmlElements.dynamicPane.children[0])===null||o===void 0?void 0:o.children[0])===null||s===void 0?void 0:s.children);a.push((l=(c=(h=n.StaticHtmlElements.dynamicPane.children[0])===null||h===void 0?void 0:h.children[1])===null||c===void 0?void 0:c.children[0])===null||l===void 0?void 0:l.children);this.selectableElementGroups=this.getSelectableElements(a)}getSelectableElements(n){let t=[];for(let i=0;i<n.length;++i){let r=n[i];if(r)for(let n=0;n<r.length;++n){const u=[],i=r.item(n);i.getAttribute("tabindex")=="-1"&&(u.push({id:i.id,selected:!1,text:null,dsb:!0}),i.onkeypress||(i.onkeypress=this.createOnClickHandler(i)));const f=document.evaluate(`//*[@id='${i.id}']//*[@tabindex='-1']`,i,null,XPathResult.ANY_TYPE,null);for(let n=f.iterateNext();n;n=f.iterateNext())u.push({id:n.id,selected:!1,text:null,dsb:!0}),n.onkeypress||(n.onkeypress=this.createOnClickHandler(n));u.length>0&&t.push(u)}}return t}setGleamData(t,i,r,u,f,e,o){var h;const s=i+this.getDSBGleamExpiryInMins()*n.MINS_TO_MILLIS;if((t===null||t===void 0?void 0:t.LaunchParameter)!==undefined&&((h=t===null||t===void 0?void 0:t.LaunchParameter)===null||h===void 0?void 0:h.length)!==0&&n.Host.setPofLaunchUrlExist(!0),t){let{GleamFormat:nt,GleamText:i,LightGleamUrl:a,DarkGleamUrl:v,LightGleamBlob:c,DarkGleamBlob:l,GleamSize:y,TargetSurface:p,GleamDimension:w,TelemetryId:b,PlaceHolderText:h,LaunchParameter:k,GleamAltText:d,GleamTooltip:g}=t;if(n.config.undocked||(i="",n.config.enablePHT&&(i=n.Host.getLocString(n.config.wsbPHTContent))),n.isDSBSearchApiEnabled()||n.isSearchPointsOfFlexibilityEnabled()||n.isTSInSearchBoxEnabled()||(h=i),n.isSearchFlexibleGleamTooltipText()&&d&&(i=d),nt==="png")this.dynamicSearchBoxContent={attributes:{gleamFormat:0},parameters:{placeholderText:h,lightGleamDataOrUrl:c,darkGleamDataOrUrl:l,expirationTime:s,gleamSize:y,targetSurface:p,gleamDimension:w,telemetryId:b,gleamAltText:i,gleamClickEndpoint:k,gleamTooltip:g}};else if(a&&v){let t=!1;n.isTSInSearchBoxAvailable()&&(t=!!c&&!!l);this.dynamicSearchBoxContent={attributes:{gleamFormat:t?0:1},parameters:{placeholderText:h,lightGleamDataOrUrl:t?c:a,darkGleamDataOrUrl:t?l:v,expirationTime:s,gleamSize:y,targetSurface:p,gleamDimension:w,telemetryId:b,gleamAltText:i,gleamClickEndpoint:k,gleamTooltip:g}}}else this.setDefaultGleamContent(s,h);r&&u!==6&&(e?this.instrumentGleam(t,u,f,!0,e,o,this.serverIG):this.instrumentGleam(t,u,f))}else this.setDefaultGleamContent(s),r&&u!==6&&this.instrumentGleam(n.DefaultGleamData,u);r&&(n.logToMC("Bing_QF_DynamicSearchViewModel","SetGleamData","logDynamicSearchViewModel"),n.dsbManager.updateDynamicSearchBoxContent("DynamicSearchViewModel.SetGleamData",this.getName()))}setGleamDataPoFSchema(t,i,r,u,f,e){var o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st;if(((c=(h=(s=(o=t===null||t===void 0?void 0:t.content)===null||o===void 0?void 0:o.taskbarSearchBox)===null||s===void 0?void 0:s.gleam)===null||h===void 0?void 0:h.invokeAction)===null||c===void 0?void 0:c.uri)!==undefined&&((p=(y=(v=(a=(l=t===null||t===void 0?void 0:t.content)===null||l===void 0?void 0:l.taskbarSearchBox)===null||a===void 0?void 0:a.gleam)===null||v===void 0?void 0:v.invokeAction)===null||y===void 0?void 0:y.uri)===null||p===void 0?void 0:p.length)!==0&&(n.Host.setPofLaunchUrlExist(!0),t.content.taskbarSearchBox.gleam.invokeAction.uri=n.Host.setGleamClickUriParameters(t.content.taskbarSearchBox.gleam.invokeAction.uri)),t){if((t===null||t===void 0?void 0:t.telemetryId)&&n.isSearchHoverSettingsEnabled()){const i=n.getSearchContentLocalStorageItem();i||((d=(k=(b=(w=t===null||t===void 0?void 0:t.content)===null||w===void 0?void 0:w.taskbarSearchBox)===null||b===void 0?void 0:b.gleam)===null||k===void 0?void 0:k.hoverAction)===null||d===void 0?void 0:d.type)!="searchHome"?i&&((g=t===null||t===void 0?void 0:t.telemetryId)===null||g===void 0?void 0:g.includes(n.TelemetryIdSuffix))&&(t.content.taskbarSearchBox.gleam.hoverAction.type="searchHome",t.telemetryId=localStorage.getItem(n.TelemetryIdXap)):(t.content.taskbarSearchBox.gleam.hoverAction.type="showTooltip",localStorage.setItem(n.TelemetryIdXap,t===null||t===void 0?void 0:t.telemetryId),t.telemetryId=(t===null||t===void 0?void 0:t.telemetryId)+n.TelemetryIdSuffix)}n.config.enablePofPht&&((it=(tt=(nt=t===null||t===void 0?void 0:t.content)===null||nt===void 0?void 0:nt.taskbarSearchBox)===null||tt===void 0?void 0:tt.input)===null||it===void 0?void 0:it.placeholderText)!==undefined&&(t.content.taskbarSearchBox.input.placeholderText=n.Host.getLocString(n.config.pofPlaceHolderText,`&`));((ft=(ut=(rt=t===null||t===void 0?void 0:t.content)===null||rt===void 0?void 0:rt.taskbarSearchBox)===null||ut===void 0?void 0:ut.gleam)===null||ft===void 0?void 0:ft.iconUrl)||((st=(ot=(et=t===null||t===void 0?void 0:t.content)===null||et===void 0?void 0:et.taskbarSearchBox)===null||ot===void 0?void 0:ot.gleam)===null||st===void 0?void 0:st.iconData)?this.searchAppearanceGleamContent={gleamData:t,contentType:1}:this.setDefaultGleamContentPoFSchema(t===null||t===void 0?void 0:t.expirationTime);i&&(f?this.instrumentGleam(t,r,u,!0,f,e,this.serverIG):this.instrumentGleam(t,r,u))}else{const u=new Date(n.getCurrentTime()+this.getDSBGleamExpiryInMins()*n.MINS_TO_MILLIS);let t=u.toISOString();t=t.slice(0,-5)+t.slice(-1);this.setDefaultGleamContentPoFSchema(t);i&&(n.logToMC("Bing_QF_DynamicSearchViewModel","setGleamDataPoFSchemaDefaultGleam","logDynamicSearchViewModel"),this.instrumentGleam(n.DefaultGleamData,r))}i&&(n.logToMC("Bing_QF_DynamicSearchViewModel","setGleamDataPoFSchema","logDynamicSearchViewModel"),n.dsbManager.updateDynamicSearchBoxContent("DynamicSearchViewModel.setGleamDataPoFSchema",this.getName()))}async setGleamDataFromThirdParty(t,i){this.searchAppearanceGleamContent={gleamData:t,contentType:2};i&&(n.logToMC("Bing_QF_DynamicSearchViewModel","setGleamDataFromThirdParty","logDynamicSearchViewModel"),await n.dsbManager.update3pDynamicSearchBoxContent("DynamicSearchViewModel.setGleamDataFromThirdParty"))}setDefaultGleamContent(t,i){this.dynamicSearchBoxContent={attributes:{gleamFormat:1},parameters:{placeholderText:i!==null&&i!==void 0?i:n.DefaultGleamData.GleamText,lightGleamDataOrUrl:n.DefaultGleamData.LightGleamUrl,darkGleamDataOrUrl:n.DefaultGleamData.DarkGleamUrl,expirationTime:t,telemetryId:n.getTelemetryIdFromUrl(n.DefaultGleamData.LightGleamUrl)}}}setDefaultGleamContentPoFSchema(t){const i={schemaVersion:n.DefaultSchemaVersionPoF,expirationTime:t,telemetryId:n.getTelemetryIdFromUrl(n.DefaultGleamData.LightGleamUrl),content:{taskbarSearchBox:{input:{placeholderText:""}}}};this.searchAppearanceGleamContent={gleamData:i,contentType:1}}render(){var r,u,f,e;let h=n.getCurrentTime();const t=this.getMomentToRender();let s=(t===null||t===void 0?void 0:t.date)!==this.currentDateDSBStr,i=this.getV2MomentToRender(),o=null;if(o=n.config.enableDSBMergedRefactor?i!==null&&i!==void 0?i:n.isDSBV2EnabledMarket()&&this.DSBSearchCallStatus==="InitMergedCall"?(r=this.multiMomentsDataModel)===null||r===void 0?void 0:r.moments[0]:(u=this.DSBMiniserpDataModel)===null||u===void 0?void 0:u.moments[0]:i!==null&&i!==void 0?i:n.isDSBV2EnabledMarket()&&this.isDSBMergedCallSuccess>0?(f=this.multiMomentsDataModel)===null||f===void 0?void 0:f.moments[0]:(e=this.DSBMiniserpDataModel)===null||e===void 0?void 0:e.moments[0],n.config.disableDSBFlipper&&t)this._page.updateDynamicSearchView(t,o);else{n.config.enableSSHUnshownFix&&(s=t?t.date!==this.currentDateDSBStr:!1);const i=!!this.pastMomentsDataModel&&this.isValidPastMoments();this._page.updateDynamicSearchView(t,o,i,s,i?this.previousMomentDate:undefined,i?this.nextMomentDate:undefined)}this.buildInteractionModel();n.config.enableDsbFetchNRenderTelemetry&&this.instrumentRender(h,n.getCurrentTime())}getMomentToRender(){var i,r,u,f;const t=this.activeMomentsIndexMap[this.activeMomentDate];return this.activeMomentDate==this.currentDateDSBStr?(i=this.multiMomentsDataModel)===null||i===void 0?void 0:i.moments[t!==null&&t!==void 0?t:0]:n.config.enableDSBEmptyPaneFix&&typeof t=="undefined"?(n.DSBLogError("activeMomentMissing",`No momentIndex found for date ${this.activeMomentDate}`),(u=(r=this.pastMomentsDataModel)===null||r===void 0?void 0:r.moments)===null||u===void 0?void 0:u.filter(n=>n.date==this.activeMomentDate)[0]):(f=this.pastMomentsDataModel)===null||f===void 0?void 0:f.moments[t]}getV2MomentToRender(){let t=null;if(n.isCurrentDayMainMomentDismissed){const n=this.activeMomentsIndexMap[this.currentDateDSBStr];t=this.multiMomentsDataModel.moments[n]}return t}getCurrentMomentContentCache(){var t,i,r;return n.isDSBFullWidthFlightEnabled()?((t=this.DSBV2ContentCache)===null||t===void 0?void 0:t.cacheTime)>0&&((i=this.DSBV2ContentCache)===null||i===void 0?void 0:i.cacheTime)<((r=this.multiMomentsContentCache)===null||r===void 0?void 0:r.cacheTime)?this.DSBV2ContentCache:this.multiMomentsContentCache:this.multiMomentsContentCache}shouldUpdateCurrentMoment(){var t;if(!!this.pastMomentsDataModel){let t=n.Host.getBindDimissTime(),i=n.Host.getBindShownTime();if((i-t)/1e3>n.DSB_RESET_SECONDS&&(!n.config.skipInitFlipReset||t>0))return!0}if((t=this.multiMomentsDataModel)===null||t===void 0?void 0:t.moments){const n=this.getNextMomentIndex(this.currentDateDSBStr,this.multiMomentsDataModel);return this.activeMomentsIndexMap[this.currentDateDSBStr]==n?!1:(this.activeMomentsIndexMap[this.currentDateDSBStr]=n,this.updateGleamOnCurrentDayMomentChange(n),!0)}return!1}shouldFetchDSBContent(t,i,r){var u,f,e;if(n.config.enableDSBMergedRefactor){if(r||!this.multiMomentsDataModel)return!0}else if(!this.multiMomentsDataModel||!this.DSBMiniserpDataModel&&n.shouldShowDSBFullWidth())return!0;if(this.isWindowsActivationStateEnabled()){const t=this.loadWindowsActivationStateFromCache(),n=SearchAppWrapper.CortanaApp.systemInfo.isWindowsGenuine();if(t!==n)return this.setWindowsActivationStateToCache(n),!0}const o=this.getCurrentMomentContentCache(),s=n.getCurrentTime()>((u=o.cacheTime)!==null&&u!==void 0?u:0)+n.MIN_SHOWN_UPDATE_MILLIS;let h=n.config.disableDSBFlipper?!1:this.isRegionOrLangChanged((f=this.pastMomentsContentCache)===null||f===void 0?void 0:f.region,(e=this.pastMomentsContentCache)===null||e===void 0?void 0:e.lang);const c=t&1,l=i!=2;return c&&(l||s||h||this.isPastMomentsDataExpired())}shouldResetDSBContent(){const t=this.getCurrentMomentContentCache();return(t===null||t===void 0?void 0:t.cacheTime)!=null?n.getCurrentTime()>=t.cacheTime+this.getUpdateIntervalMins(!0)*n.MINS_TO_MILLIS:!0}isDSBContentExpired(){let i=!0;const t=this.getCurrentMomentContentCache();if((t===null||t===void 0?void 0:t.cacheTime)!=null){const r=n.getCurrentTime(),u=t.cacheTime,f=this.getUpdateIntervalMins(!0)*n.MINS_TO_MILLIS-30*n.MINS_TO_MILLIS;i=r>=u+f}return i||this.isNewDay()}async refresh(t,i){var e,o;if(this.instrumentShownToNonActWindows(i),i==7&&t==0&&n.isTSInSearchBoxAvailable()){n.isUserDisableTSInSearchBox()||(n.updateTrendingsearchCacheSort(),this.updateTSInSearchBox());n.dsbManager.allowSuspension();return}let u=!1,f=(t&6)==6;if(this.shouldResetDSBContent()&&(this.resetDynamicSearchContent(),u=!0),this.hasPendingGleamUpdate&&(this.hasPendingGleamUpdate=!1,u=!0),n.isThirdPartyGleamSupported()){(i==1||i==0)&&await n.Host.prefetchAllWebSearchExtensions();const t=n.Host.getMru3pAppCache();if(t){await this.set3pSearchAppearance(t);n.dsbManager.allowSuspension();return}}let r=this.isNewDay();if(r=r||!n.config.disableDSBFlipper&&this.isRegionOrLangChanged((e=this.pastMomentsContentCache)===null||e===void 0?void 0:e.region,(o=this.pastMomentsContentCache)===null||o===void 0?void 0:o.lang),n.TestHookUrlParameters&&(r=r||i==6),r&&this.resetActiveStatus(),this.shouldFetchDSBContent(t,i,r)){this.instrumentDSBRequest(t,i);const{isFetchDSBSucceed:n,isFetchDSBSucceedWithinRenderTimeout:e}=await this.fetchDSBWithTimeout(r);u=!n;f&&r&&(f=!(n&&e))}this.shouldUpdateCurrentMoment()&&(f=!1,this.activeMomentDate=this.currentDateDSBStr);f?this.renderOnDismissReason=i:t&2&&(this.render(),r&&(this.renderOnDismissReason=i));u&&(n.logToMC("Bing_QF_DynamicSearchViewModel","DsbViewModel_trigger_update","logDynamicSearchViewModel"),await n.dsbManager.updateDynamicSearchBoxContent("DynamicSearchViewModel.refresh",this.getName()));i==1&&(n.logToMC("Bing_QF_DynamicSearchViewModel","DsbViewModel_allowSuspension_called","logDynamicSearchViewModel"),n.dsbManager.allowSuspension());n.logToMC("Bing_QF_DynamicSearchViewModel","DsbViewModel_refresh_completed.","logDynamicSearchViewModel")}selectMultiMomentsDataModel(){return(n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode())?this.blendedMomentsDataModel:this.nonBlendedMomentsDataModel}setVisibility(t,i){this.isVisible=t;this.isVisible?n.shouldShowDSBFullWidth()&&!n.canEnableDsbWebMruInWebScope(n.dsbManager===null||n.dsbManager===void 0?void 0:n.dsbManager.getCurrentQuery())?(n.setVisibility(n.StaticHtmlElements.dynamicPaneFullWidth,!0),n.setVisibility(n.StaticHtmlElements.dynamicPane,!1)):(n.setVisibility(n.StaticHtmlElements.dynamicPane,!0),n.setVisibility(n.StaticHtmlElements.dynamicPaneFullWidth,!1)):(n.setVisibility(n.StaticHtmlElements.dynamicPane,!1),n.setVisibility(n.StaticHtmlElements.dynamicPaneFullWidth,!1));n.config.useCobaltCSS&&(n.setFixHeight(n.StaticHtmlElements.dynamicPane,t),n.setFixHeight(n.StaticHtmlElements.qfContainer,t));const r=n.shouldShowDSBFullWidth()?n.StaticHtmlElements.dynamicPaneFullWidth:n.StaticHtmlElements.dynamicPane;n.setAdaptiveWidth(r,t,n.shouldShowDSBFullWidth());this.isVisible&&this.dwellStartTime==-1&&i&&this.setDwellStartTime(n.getCurrentTime())}isDifferentDay(n,t){return n.getDate()!=t.getDate()||n.getMonth()!=t.getMonth()||n.getFullYear()!=t.getFullYear()}isCurrentMomentDataExpired(){const t=this.getCurrentMomentContentCache();return(t===null||t===void 0?void 0:t.cacheTime)==null?!0:this.isDifferentDay(new Date(t.cacheTime),n.getCurrentDateDSB())}isPastMomentsDataExpired(){var t;return n.config.disableDSBFlipper?!1:((t=this.pastMomentsContentCache)===null||t===void 0?void 0:t.cacheTime)==null?!0:this.isDifferentDay(new Date(this.pastMomentsContentCache.cacheTime),n.getCurrentDateDSB())}setDwellStartTime(n){this.dwellStartTime=n}setDwellEndTime(n){this.dwellEndTime=n}getDwellStartTime(){return this.dwellStartTime}getDwellEndTime(){return this.dwellEndTime}isDwellStarted(){return this.getDwellStartTime()!=-1}resetDwellTime(){this.dwellStartTime=-1;this.dwellEndTime=-1;this.dwellTime=-1}setDwellTime(n){this.dwellTime=n}getDwellTime(){return this.dwellTime}instrumentDSBDwellTime(){this.setDwellEndTime(n.getCurrentTime());this.setDwellTime(this.getDwellEndTime()-this.getDwellStartTime());n.InstrumentationHelper.logClientInstEvent("ClientInst","DwellTime",n.SequenceNumberManager.getSequenceNumber(),{DSBDwellTime:this.getDwellTime().toString()},"WindowsTelemetry")}getVisibility(){return this.isVisible}hasContent(t){var r,u,f,e,o,s,h,c,l,a,v,y;let i=!1;if(t?n.config.enableDSBMergedRefactor?this.DSBSearchCallStatus==="FallbacktoV2"?this.DSBMiniserpDataModel&&(i=((e=(f=this.DSBMiniserpDataModel)===null||f===void 0?void 0:f.moments)===null||e===void 0?void 0:e.length)>0):this.multiMomentsDataModel&&(i=((s=(o=this.multiMomentsDataModel)===null||o===void 0?void 0:o.moments)===null||s===void 0?void 0:s.length)>0):this.isDSBMergedCallSuccess<0?this.DSBMiniserpDataModel&&(i=((c=(h=this.DSBMiniserpDataModel)===null||h===void 0?void 0:h.moments)===null||c===void 0?void 0:c.length)>0):this.multiMomentsDataModel&&(i=((a=(l=this.multiMomentsDataModel)===null||l===void 0?void 0:l.moments)===null||a===void 0?void 0:a.length)>0):this.multiMomentsDataModel&&(i=((u=(r=this.multiMomentsDataModel)===null||r===void 0?void 0:r.moments)===null||u===void 0?void 0:u.length)>0),n.config.enableSSHUnshownFix){if(n.config.disableDSBFlipper)return i;let t=!1;return this.pastMomentsDataModel&&(t=((y=(v=this.pastMomentsDataModel)===null||v===void 0?void 0:v.moments)===null||y===void 0?void 0:y.length)>=6),i&&t}return i}getCodexStatus(){var n,t;return(t=(n=this.dsbUser)===null||n===void 0?void 0:n.UserCodexStatus)!==null&&t!==void 0?t:""}instrumentGleam(t,i,r,u,f,e,o){let s={gleamData:{darkGleamFormat:!t||t.DarkGleamFormat==""?"":t.DarkGleamFormat,lightGleamFormat:!t||t.LightGleamFormat==""?"":t.LightGleamFormat,targetSurface:!t||t.TargetSurface==null?"":t.TargetSurface,text:!t||t.GleamText==""?"":t.GleamText,thumbnailDark:!t||t.DarkGleamThumbnailId==""?"":t.DarkGleamThumbnailId,thumbnailLight:!t||t.LightGleamThumbnailId==""?"":t.LightGleamThumbnailId,gleamSetReason:i===null||i===void 0?void 0:i.toString(),momentType:r},isNewDSBContentFetched:u};f&&(s.DSBFetchDelay={timeDifference:f.toString(),workflow:e===null||e===void 0?void 0:e.toString()});s.ImpressionGuid=o;n.InstrumentationHelper.instrumentDSBEvent(s)}instrumentDSBFallback(t,i,r,u){let f={DSBFallback:{errorType:t.toString(),workflow:i,response:r?JSON.stringify(r):u}};n.InstrumentationHelper.instrumentDSBEvent(f)}instrumentFetch(t,i,r){let u=i-t,f={};f=n.config.enableDsbFetchNRenderTelemetry?{DSBFetchLatency:{timeDifference:u.toString(),workflow:r.toString()}}:{DSBFetchDelay:{timeDifference:u.toString(),workflow:r.toString()}};n.InstrumentationHelper.instrumentDSBEvent(f)}instrumentRender(t,i){let r=i-t,u={DSBRenderLatency:{timeDifference:r.toString()}};n.InstrumentationHelper.instrumentDSBEvent(u)}resetStatusBasedOnDismissedMoment(){var t;n.isCurrentDayMainMomentDismissed=!1;const i=this.createDismissKeyForMoment(this.currentDateDSBStr);((t=this.dismissedMomentsContentCache)===null||t===void 0?void 0:t.hasOwnProperty(i))&&(n.isCurrentDayMainMomentDismissed=!0)}updateGleamOnCurrentDayMomentChange(t){var r,u;const i=(r=this.multiMomentsDataModel)===null||r===void 0?void 0:r.moments[t],f=this.getGleamDataFromMoment(i),e=(u=i===null||i===void 0?void 0:i.momentMetadata)===null||u===void 0?void 0:u.MomentType;n.isSearchPointsOfFlexibilityEnabled()?this.setGleamDataPoFSchema(f,!0,2,e):this.setGleamData(f,this.gleamDataCacheTime,!0,2,e);this.hasPendingGleamUpdate=!1}onDismissMomentHandler(t,i){var o,s,h,c,l,a,v,y;const b=i==this.currentDateDSBStr;let p=b?this.multiMomentsDataModel:this.pastMomentsDataModel;const r=p.moments[t];r.isDismissed=!0;const e=this.getNextMomentIndex(r.date,p),u=(o=p.moments[e])!==null&&o!==void 0?o:null,k=r===null||r===void 0?void 0:r.order,f=(h=(s=r===null||r===void 0?void 0:r.sectionGroups)===null||s===void 0?void 0:s.find(n=>(n===null||n===void 0?void 0:n.cardType)=="Hero"))===null||h===void 0?void 0:h.sections[0];let w;b?(this.activeMomentsIndexMap[i]=e,this.updateGleamOnCurrentDayMomentChange(e),n.isCurrentDayMainMomentDismissed=!0,w="DSBDismissCurrentDayMoment"):(w="DSBDismissPastDayMoment",this.activeMomentsIndexMap[i]=e);this.updateDismissedMomentsContentToCache(i,k);let d={momentDate:i,momentOrder:k.toString(),momentType:(c=r===null||r===void 0?void 0:r.momentMetadata)===null||c===void 0?void 0:c.MomentType,heroTitle:(l=f===null||f===void 0?void 0:f.props.FieldsStore)===null||l===void 0?void 0:l.Title,scenario:(a=f===null||f===void 0?void 0:f.props)===null||a===void 0?void 0:a.scenario,nextmomentDate:u===null||u===void 0?void 0:u.date,nextmomentOrder:(v=u===null||u===void 0?void 0:u.order)===null||v===void 0?void 0:v.toString(),nextmomentType:(y=u===null||u===void 0?void 0:u.momentMetadata)===null||y===void 0?void 0:y.MomentType};n.InstrumentationHelper.logClientInstEvent("Select",w,n.SequenceNumberManager.getSequenceNumber(),d,"BingTelemetry");n.config.enableRenderMomentDataSource&&n.InstrumentationHelper.instrumentDSB();this.render()}onDismissV2MomentHandler(t){var f,e,o,s,h,c,l,a,v,y,p;n.isCurrentDayMainMomentDismissed=!0;const i=(f=this.multiMomentsDataModel)===null||f===void 0?void 0:f.moments[t];i.isDismissed=!0;const w=this.getNextMomentIndex(this.currentDateDSBStr,this.multiMomentsDataModel),r=(o=(e=this.multiMomentsDataModel)===null||e===void 0?void 0:e.moments[w])!==null&&o!==void 0?o:null,b=i===null||i===void 0?void 0:i.order,u=(h=(s=i===null||i===void 0?void 0:i.sectionGroups)===null||s===void 0?void 0:s.find(n=>(n===null||n===void 0?void 0:n.cardType)=="Hero"))===null||h===void 0?void 0:h.sections[0];this.activeMomentsIndexMap[this.currentDateDSBStr]=w;this.updateGleamOnCurrentDayMomentChange(w);this.updateDismissedMomentsContentToCache(this.currentDateDSBStr,b);let k={momentDate:this.currentDateDSBStr,momentOrder:b.toString(),momentType:(c=i===null||i===void 0?void 0:i.momentMetadata)===null||c===void 0?void 0:c.MomentType,heroTitle:(a=(l=u===null||u===void 0?void 0:u.props)===null||l===void 0?void 0:l.FieldsStore)===null||a===void 0?void 0:a.Title,scenario:(v=u===null||u===void 0?void 0:u.props)===null||v===void 0?void 0:v.scenario,nextmomentDate:r===null||r===void 0?void 0:r.date,nextmomentOrder:(y=r===null||r===void 0?void 0:r.order)===null||y===void 0?void 0:y.toString(),nextmomentType:(p=r===null||r===void 0?void 0:r.momentMetadata)===null||p===void 0?void 0:p.MomentType};n.InstrumentationHelper.logClientInstEvent("Select","DSBDismissCurrentDayMoment",n.SequenceNumberManager.getSequenceNumber(),k,"BingTelemetry");n.config.enableRenderMomentDataSource&&n.InstrumentationHelper.instrumentDSB();this.render()}onFlipHandler(t,i){const r=this.momentDatesFlipper.length;let u=Math.max(this.momentDatesFlipper.indexOf(t),0);this.activeMomentDate=this.momentDatesFlipper[(u+i+r)%r];this.previousMomentDate=this.momentDatesFlipper[(u+i-1+r)%r];this.nextMomentDate=this.momentDatesFlipper[(u+i+1+r)%r];n.config.enableRenderMomentDataSource&&n.InstrumentationHelper.instrumentDSB();this.render()}getNextMomentIndex(t,i){var u,f,r;let e=0,o=n.DayEndSec+1;for(r=0;r<i.moments.length;r++){const n=i.moments[r];if(n.date==t&&this.isMomentAvaiable(n)){let t=((u=n.momentMetadata)===null||u===void 0?void 0:u.EndTime)-((f=n.momentMetadata)===null||f===void 0?void 0:f.StartTime);t<o&&(e=r,o=t)}}return e}isMomentAvailableInTimeRange(t){var i,r;let u=n.getCurrentTimeInSeconds();return u>=((i=t.momentMetadata)===null||i===void 0?void 0:i.StartTime)&&u<=((r=t.momentMetadata)===null||r===void 0?void 0:r.EndTime)}isMomentAvaiable(n){var t;let i=(t=n===null||n===void 0?void 0:n.isDismissed)!==null&&t!==void 0?t:!1;return!i&&this.isMomentAvailableInTimeRange(n)}getDSBHeaders(t){var r;let i=n.Host.getCustomHeaders(null);if(this.isWindowsActivationStateEnabled()&&!i["X-WindowsActivated"]){const n=SearchAppWrapper.CortanaApp.systemInfo.isWindowsGenuine();i["X-WindowsActivated"]=n.toString();this.loadWindowsActivationStateFromCache()!==n&&this.setWindowsActivationStateToCache(n)}return t&&(n.config.restrictedAPIHeaderChange?i["X-RestrictedAPI"]="1":i["User-Agent"]=n.getUserAgent()+" RestrictedAPI"),((r=n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.getFeatures())===null||r===void 0?void 0:r.length)>0&&(i["X-BM-SearchFeatures"]=n.VelocityKeys.getFeatures()),i}isWindowsActivationStateEnabled(){return n.config.enableWindowsActivated&&(n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.isFeatureEnabled(49428468))&&typeof SearchAppWrapper.CortanaApp.systemInfo.isWindowsGenuine=="function"&&n.isEligibleWindowsActivationOsSKU}loadWindowsActivationStateFromCache(){const t=n.LightweightStorage.getItem(n.config.windowsActivationStateCacheKey);return t?(t===null||t===void 0?void 0:t.toLowerCase())==="true":undefined}setWindowsActivationStateToCache(t){(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.disableDSBCache)||n.LightweightStorage.setItem(n.config.windowsActivationStateCacheKey,t.toString())}getGleamSetReason(t){var i;const r=(i=t===null||t===void 0?void 0:t.momentMetadata)===null||i===void 0?void 0:i.MomentType;return r=="Afternoon"||r=="AfternoonBreak"?3:n.isCurrentDayMainMomentDismissed?2:1}isRegionOrLangChanged(t,i){return n.Host.getRegion()!==t||n.Host.getLanguage()!==i?!0:!1}transformGleamData(t){if(!(t===null||t===void 0?void 0:t.LightGleamUrl)||!(t===null||t===void 0?void 0:t.DarkGleamUrl))return null;let r=n.LightweightStorage.getItem(this.DSBGleamBlobCacheKey),i=r?JSON.parse(r):{};return Object.keys(i).length>=4&&!i[t===null||t===void 0?void 0:t.LightGleamUrl]&&!i[t===null||t===void 0?void 0:t.DarkGleamUrl]&&(i={},n.LightweightStorage.setItem(this.DSBGleamBlobCacheKey,JSON.stringify({}))),i&&i[t===null||t===void 0?void 0:t.LightGleamUrl]||this.transformGleamUrlToBlob(t===null||t===void 0?void 0:t.LightGleamUrl,i),i&&i[t===null||t===void 0?void 0:t.DarkGleamUrl]||this.transformGleamUrlToBlob(t===null||t===void 0?void 0:t.DarkGleamUrl,i),i}transformGleamUrlToBlob(t,i){t&&(t===null||t===void 0?void 0:t.length)!=0&&n.Async.safeChain(`transformGleamUrlToBlob`,()=>ThresholdUtilities.createPromise(n=>{fetch(t).then(t=>{t.ok&&t.status===200?t===null||t===void 0?void 0:t.blob().then(t=>n(t)):n(null)}).catch(()=>{n(null)})}),r=>{if(r){const u=new FileReader;u.onload=r=>{var u,f;const e=(f=(u=r===null||r===void 0?void 0:r.target)===null||u===void 0?void 0:u.result)===null||f===void 0?void 0:f.toString();typeof e=="string"&&(i[t]=e,n.LightweightStorage.setItem(this.DSBGleamBlobCacheKey,JSON.stringify(i)))};u.readAsText(r)}})}instrumentDSBRequest(t,i){if(n.config.enableDSBCIRequestLogging){let r={RefreshStrategy:t.toString(),RefreshReason:i.toString()};n.InstrumentationHelper.logClientInstEvent("ClientInst","DSBRequest",n.SequenceNumberManager.getSequenceNumber(),r)}}instrumentShownToNonActWindows(t){if(n.config.enableNonActWindowsLogging&&t==2&&this.isWindowsActivationStateEnabled()){const t=this.loadWindowsActivationStateFromCache(),i=n.isNullOrUndefined(t)?"undefined":t===null||t===void 0?void 0:t.toString();n.InstrumentationHelper.logClientInstEvent("ClientInst","DSBWinActivationState",n.SequenceNumberManager.getSequenceNumber(),{WinActivationState:i})}}}n.DynamicSearchViewModel=t}(WSB||(WSB={})),function(n){var t;(function(n){var t;(function(n){class t extends React.Component{render(){return React.createElement("svg",{width:"57",height:"18",viewBox:"0 0 38 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{fill:"currentColor",d:"M34.7338 1.92317V1.3876H34.0674V0.561687L33.4063 0.761979V1.38737H32.4256V1.05142C32.4256 0.883437 32.4627 0.756708 32.5366 0.671229C32.6117 0.58575 32.7171 0.542667 32.8553 0.542667C32.9257 0.542667 32.9888 0.551604 33.0432 0.569708C33.0982 0.587812 33.1362 0.602937 33.1578 0.615542V0.0495C33.1109 0.0332292 33.0558 0.020625 32.9946 0.0126042C32.9331 0.00458333 32.862 0 32.7823 0C32.4825 0 32.2377 0.0935 32.0464 0.2805C31.8548 0.4675 31.7592 0.707437 31.7592 0.999396V1.38669H31.2916V1.92225H31.7592V4.169H32.4256V1.92225H33.4072V3.35385C33.4072 3.6504 33.4758 3.87154 33.6149 4.0189C33.7531 4.16533 33.9617 4.23912 34.2387 4.23912C34.3336 4.23912 34.4293 4.22927 34.5258 4.20933C34.6225 4.18962 34.6919 4.16785 34.7335 4.14471V3.60273C34.6937 3.62794 34.6467 3.64948 34.5935 3.66735C34.5403 3.68546 34.4943 3.6944 34.4563 3.6944C34.3218 3.6944 34.2233 3.65842 34.1611 3.58829C34.0987 3.51725 34.0671 3.39694 34.0671 3.22529V1.92317H34.7338ZM14.3435 7.5554V7.54462C14.5623 7.47679 14.7336 7.36267 14.8572 7.20202C14.9809 7.04137 15.0428 6.85231 15.0428 6.6346C15.0428 6.37404 14.9334 6.16252 14.7147 6.00027C14.4978 5.83802 14.2028 5.75667 13.8298 5.75667H12.6062V9.59521H13.8434C14.2397 9.59521 14.5678 9.49346 14.8277 9.29019C15.0877 9.08669 15.2178 8.82085 15.2178 8.49246C15.2178 8.22846 15.1379 8.01419 14.9783 7.8501C14.8206 7.68373 14.6088 7.58565 14.3435 7.5554V7.5554ZM13.2435 6.26794H13.7089C14.1501 6.26794 14.3704 6.43202 14.3704 6.76042C14.3704 6.95131 14.3069 7.09935 14.1796 7.20477C14.0541 7.30835 13.8802 7.35992 13.6578 7.35992H13.2435V6.26794ZM14.341 8.92306C14.2118 9.03192 14.028 9.08623 13.7895 9.08623H13.2435V7.87096H13.7061C14.2601 7.87096 14.5372 8.06987 14.5372 8.46771C14.5372 8.6609 14.4718 8.81237 14.341 8.92306V8.92306ZM17.885 0.958833C17.9969 0.958833 18.0926 0.921937 18.1702 0.850208C18.2488 0.77825 18.2877 0.688417 18.2877 0.582312C18.2877 0.477125 18.2488 0.387292 18.173 0.312583C18.0973 0.237875 18.0015 0.200292 17.885 0.200292C17.7758 0.200292 17.6819 0.237187 17.6031 0.309833C17.5246 0.383625 17.4848 0.473229 17.4848 0.582083C17.4848 0.686354 17.5237 0.775271 17.6003 0.849062C17.6782 0.922167 17.7728 0.958833 17.885 0.958833ZM20.0612 4.23729C20.221 4.23729 20.3672 4.22194 20.501 4.19146C20.6336 4.16075 20.7538 4.11515 20.8586 4.05579V3.44644C20.7584 3.52115 20.6499 3.58027 20.5316 3.62519C20.4142 3.6701 20.3057 3.69256 20.2083 3.69256C19.9447 3.69256 19.737 3.61442 19.5834 3.4579C19.43 3.30069 19.3531 3.08137 19.3531 2.79996C19.3531 2.5151 19.4325 2.28846 19.5926 2.12048C19.7524 1.9525 19.9619 1.86885 20.221 1.86885C20.331 1.86885 20.4404 1.88948 20.5461 1.93004C20.6527 1.9706 20.7556 2.0279 20.8576 2.10169V1.47377C20.7826 1.43229 20.6833 1.39562 20.5569 1.36423C20.4314 1.33283 20.3066 1.31656 20.183 1.31656C19.7008 1.31656 19.3278 1.46117 19.065 1.7506C18.8023 2.04096 18.6704 2.40946 18.6704 2.85702C18.6704 3.25967 18.7996 3.59035 19.057 3.84908C19.3153 4.10781 19.6492 4.23729 20.0612 4.23729V4.23729ZM15.6852 9.59498H16.3093V6.85415H15.6852V9.59498ZM27.3545 2.53962C27.1496 2.45873 27.017 2.39135 26.9573 2.33842C26.8977 2.28433 26.868 2.21077 26.868 2.11727C26.868 2.03179 26.9023 1.96556 26.9737 1.91515C27.0432 1.86656 27.1408 1.84227 27.2663 1.84227C27.381 1.84227 27.4957 1.8629 27.6122 1.90438C27.7278 1.94654 27.8298 1.99604 27.9166 2.05356V1.43069C27.8353 1.39654 27.7342 1.36858 27.6122 1.34704C27.4901 1.3255 27.3801 1.31473 27.2827 1.31473C26.964 1.31473 26.704 1.39562 26.5035 1.55742C26.3029 1.71829 26.2027 1.925 26.2027 2.17571C26.2027 2.37073 26.2541 2.53069 26.3554 2.65742C26.4565 2.78415 26.629 2.89827 26.8719 2.99887C27.0759 3.08069 27.2159 3.15242 27.2889 3.21452C27.3621 3.27754 27.399 3.35385 27.399 3.44369C27.399 3.54085 27.3637 3.61075 27.2933 3.65223C27.2219 3.69371 27.1127 3.71433 26.9638 3.71433C26.8509 3.71433 26.7264 3.69004 26.5882 3.64146C26.45 3.59287 26.3218 3.52642 26.2018 3.44369V4.0881C26.2995 4.13119 26.4185 4.16717 26.5594 4.19512C26.6994 4.22308 26.8277 4.23729 26.9442 4.23729C27.2882 4.23729 27.5618 4.15823 27.7639 3.99919C27.9663 3.84015 28.0674 3.62977 28.0674 3.36829C28.0674 3.18221 28.0151 3.02408 27.9085 2.89277C27.8024 2.7626 27.6172 2.64481 27.3545 2.53962V2.53962ZM17.5527 4.169H18.211V1.38577H17.5527V4.169ZM22.7322 1.33994C22.5616 1.33994 22.4161 1.38302 22.2952 1.4685C22.1743 1.55398 22.0829 1.67246 22.0232 1.8244H22.0124V1.38577H21.3541V4.169H22.0124V2.76352C22.0124 2.4821 22.0684 2.27379 22.1794 2.13812C22.2903 2.00246 22.4269 1.93508 22.5885 1.93508C22.6834 1.93508 22.7635 1.94677 22.8296 1.96923C22.8955 1.99169 22.9461 2.01598 22.9804 2.04119V1.37775C22.9507 1.36698 22.9164 1.35804 22.8738 1.35071C22.8315 1.3436 22.7845 1.33994 22.7322 1.33994V1.33994ZM21.865 7.2341H21.8542C21.6785 6.93802 21.4087 6.78975 21.0446 6.78975C20.6592 6.78975 20.3561 6.92725 20.1355 7.20202C19.9149 7.47679 19.8047 7.84712 19.8047 8.31279C19.8047 8.72323 19.9069 9.05071 20.1111 9.29523C20.3174 9.53792 20.588 9.65937 20.9235 9.65937C21.3377 9.65937 21.6479 9.48452 21.854 9.13481H21.8648V9.43456C21.8648 10.0753 21.5376 10.3955 20.883 10.3955C20.6122 10.3955 20.3264 10.3097 20.025 10.1386V10.706C20.2921 10.8256 20.605 10.8854 20.9638 10.8854C21.9804 10.8854 22.4888 10.3822 22.4888 9.37567V6.85415H21.8648V7.2341H21.865ZM21.8703 8.3396C21.8703 8.58046 21.8031 8.77869 21.6686 8.93383C21.5342 9.08737 21.3594 9.16392 21.1441 9.16392C20.9325 9.16392 20.7621 9.08371 20.6331 8.92306C20.5058 8.76058 20.4423 8.54471 20.4423 8.27521C20.4423 7.96285 20.5086 7.7204 20.6412 7.54715C20.7757 7.37229 20.9613 7.28475 21.1977 7.28475C21.3896 7.28475 21.5491 7.3535 21.6767 7.491C21.8059 7.62667 21.8703 7.79075 21.8703 7.98348V8.3396ZM24.4956 1.32115C24.0314 1.32115 23.6685 1.4559 23.4073 1.72471C23.1465 1.99352 23.0154 2.35835 23.0154 2.81852C23.0154 3.25715 23.1428 3.60296 23.3974 3.85642C23.6521 4.10987 23.9961 4.2366 24.4295 4.2366C24.8792 4.2366 25.2349 4.10277 25.4961 3.83579C25.757 3.56881 25.888 3.20948 25.888 2.75825C25.888 2.31779 25.7652 1.96831 25.5196 1.70958C25.2741 1.45062 24.9326 1.32115 24.4956 1.32115V1.32115ZM25.0157 3.46271C24.8902 3.61625 24.7079 3.69279 24.4686 3.69279C24.2211 3.69279 24.0325 3.61648 23.8999 3.46271C23.7673 3.30894 23.7012 3.0871 23.7012 2.79675C23.7012 2.50113 23.7679 2.27287 23.9026 2.11292C24.0362 1.95296 24.2232 1.87298 24.4643 1.87298C24.6982 1.87298 24.8797 1.94929 25.0097 2.10215C25.1389 2.255 25.2039 2.48142 25.2039 2.78071C25.2036 3.0816 25.1412 3.30894 25.0157 3.46271V3.46271ZM18.4765 6.78975C18.0874 6.78975 17.7899 6.963 17.5835 7.30904H17.5727V6.85392H16.9462V9.59498H17.5727V8.0316C17.5727 7.81573 17.6347 7.63721 17.7583 7.49627C17.882 7.3535 18.039 7.28223 18.229 7.28223C18.5928 7.28223 18.7749 7.53821 18.7749 8.0504V9.59475H19.3989V7.91908C19.3989 7.55333 19.32 7.27398 19.1622 7.08125C19.0045 6.88692 18.7761 6.78975 18.4765 6.78975V6.78975ZM14.8038 3.16433H14.7875L13.667 0.286687H12.6962V4.169H13.3221V1.12612H13.3301L14.5708 4.169H15.0196L16.2305 1.12612H16.2413V4.169H16.9185V0.286687H15.9867L14.8038 3.16433ZM29.8296 1.32115C29.3654 1.32115 29.0025 1.4559 28.7414 1.72471C28.4805 1.99352 28.3495 2.35835 28.3495 2.81852C28.3495 3.25715 28.4768 3.60296 28.7315 3.85642C28.9862 4.10987 29.3302 4.2366 29.7635 4.2366C30.2132 4.2366 30.569 4.10277 30.8299 3.83579C31.091 3.56881 31.2218 3.20948 31.2218 2.75825C31.2218 2.31779 31.0991 1.96831 30.8534 1.70958C30.6079 1.4504 30.2667 1.32115 29.8296 1.32115V1.32115ZM30.3507 3.46271C30.2252 3.61625 30.0428 3.69279 29.8036 3.69279C29.5561 3.69279 29.3675 3.61648 29.2348 3.46271C29.102 3.30917 29.0361 3.0871 29.0361 2.79675C29.0361 2.50113 29.102 2.27287 29.2374 2.11292C29.3709 1.95296 29.5579 1.87298 29.799 1.87298C30.0329 1.87298 30.2144 1.94929 30.3445 2.10215C30.4737 2.255 30.5386 2.48142 30.5386 2.78071C30.5384 3.0816 30.4762 3.30894 30.3507 3.46271V3.46271ZM16 5.57196C15.8978 5.57196 15.8101 5.60587 15.7364 5.67371C15.6648 5.74154 15.6288 5.82633 15.6288 5.92808C15.6288 6.02983 15.6648 6.11371 15.7364 6.17971C15.8101 6.24571 15.8978 6.27871 16 6.27871C16.1057 6.27871 16.1955 6.24479 16.269 6.17696C16.3426 6.10729 16.3793 6.02433 16.3793 5.92808C16.3793 5.82633 16.3426 5.74154 16.269 5.67371C16.1953 5.60565 16.1057 5.57196 16 5.57196Z"}),React.createElement("path",{d:"M0 0H4.60526V4.58333H0V0Z",fill:"#F26522"}),React.createElement("path",{d:"M5.06577 0H9.67103V4.58333H5.06577V0Z",fill:"#8DC63F"}),React.createElement("path",{d:"M0 5.04167H4.60526V9.62501H0V5.04167Z",fill:"#00AEEF"}),React.createElement("path",{d:"M5.06577 5.04167H9.67103V9.62501H5.06577V5.04167Z",fill:"#FFC20E"}))}}n.BingLogo=t;class i extends React.Component{render(){return React.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{fill:"currentColor",d:"M12 6.11133C12 5.55078 11.9286 5.01074 11.7857 4.49121C11.6429 3.97168 11.442 3.48405 11.183 3.02832C10.9241 2.57259 10.6094 2.16016 10.2389 1.79102C9.86834 1.42188 9.46433 1.10286 9.02683 0.833984C8.58934 0.565104 8.11167 0.360026 7.59382 0.21875C7.07597 0.077474 6.54473 0.00455729 6.0001 0C5.451 0 4.92199 0.0729167 4.41307 0.21875C3.90415 0.364583 3.42648 0.569661 2.98006 0.833984C2.53364 1.09831 2.12739 1.41732 1.76133 1.79102C1.39526 2.16471 1.08277 2.57715 0.823844 3.02832C0.564919 3.47949 0.361798 3.96484 0.214479 4.48438C0.0671597 5.00391 -0.00426769 5.54622 0.000196457 6.11133C0.000196457 6.52148 0.0403748 6.92708 0.12073 7.32812C0.201086 7.72917 0.317156 8.11654 0.468939 8.49023C0.620723 8.86393 0.808219 9.2194 1.03143 9.55664C1.25464 9.89388 1.51133 10.2083 1.80151 10.5L4.80146 13.501C4.96217 13.6605 5.1452 13.7835 5.35056 13.8701C5.55591 13.9567 5.77242 14 6.0001 14C6.22777 14 6.44429 13.9567 6.64964 13.8701C6.855 13.7835 7.03803 13.6605 7.19874 13.501L10.1987 10.5C10.4889 10.2129 10.7456 9.90072 10.9688 9.56348C11.192 9.22624 11.3795 8.86849 11.5313 8.49023C11.683 8.11198 11.7991 7.72461 11.8795 7.32812C11.9598 6.93164 12 6.52604 12 6.11133ZM3.42871 6.125V6.07031C3.42871 5.71484 3.49791 5.38216 3.6363 5.07227C3.77469 4.76237 3.96219 4.48893 4.19879 4.25195C4.43539 4.01497 4.70771 3.83268 5.01574 3.70508C5.32377 3.57747 5.65189 3.50911 6.0001 3.5C6.35724 3.5 6.69205 3.56836 7.00455 3.70508C7.31704 3.8418 7.58936 4.02865 7.8215 4.26562C8.05364 4.5026 8.23667 4.7806 8.3706 5.09961C8.50452 5.41862 8.57148 5.76042 8.57148 6.125C8.57148 6.48958 8.50452 6.83138 8.3706 7.15039C8.23667 7.4694 8.05364 7.7474 7.8215 7.98438C7.58936 8.22135 7.31704 8.4082 7.00455 8.54492C6.69205 8.68164 6.35724 8.75 6.0001 8.75C5.64296 8.75 5.30815 8.68164 4.99565 8.54492C4.68316 8.4082 4.41084 8.22135 4.1787 7.98438C3.94656 7.7474 3.76353 7.4694 3.6296 7.15039C3.49568 6.83138 3.42871 6.48958 3.42871 6.125Z"}))}}n.LocalHeroIcon=i;class r extends React.Component{render(){return React.createElement("svg",{height:"10",width:"10",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},React.createElement("path",{d:"M1792 1024L512 1920V128l1280 896z",fill:"currentColor"}))}}n.PlayIcon=r;class u extends React.Component{render(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},React.createElement("path",{d:"M1.72362 1.05279C1.55282 0.967387 1.34828 0.986734 1.19652 1.10265C1.04476 1.21857 0.972275 1.4108 1.00973 1.59806L2.4126 6.44777C2.46604 6.63249 2.62067 6.7702 2.81032 6.80196L8.50002 7.75485C8.76798 7.80844 8.76798 8.19155 8.50002 8.24514L2.81032 9.19803C2.62067 9.22979 2.46604 9.3675 2.4126 9.55222L1.00973 14.4019C0.972275 14.5892 1.04476 14.7814 1.19652 14.8974C1.34828 15.0133 1.55282 15.0326 1.72362 14.9472L14.7236 8.44721C14.893 8.36252 15 8.18939 15 8C15 7.81061 14.893 7.63748 14.7236 7.55279L1.72362 1.05279Z",fill:"currentColor"}))}}n.SendIcon=u;class f extends React.Component{render(){return React.createElement("div",{className:"play-video-icon-container"},React.createElement("div",{className:"play-video-icon"},React.createElement("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("g",{clipPath:"url(#clip0_544_81288)"},React.createElement("path",{opacity:"0.6",d:"M24 1C19.451 1 15.0042 2.34893 11.2219 4.8762C7.43956 7.40347 4.4916 10.9956 2.75078 15.1983C1.00997 19.401 0.554489 24.0255 1.44195 28.4871C2.32941 32.9486 4.51995 37.0468 7.73655 40.2635C10.9532 43.4801 15.0514 45.6706 19.5129 46.5581C23.9745 47.4455 28.599 46.99 32.8017 45.2492C37.0044 43.5084 40.5965 40.5604 43.1238 36.7781C45.6511 32.9958 47 28.549 47 24C47 17.9 44.5768 12.0499 40.2635 7.73654C35.9501 3.42321 30.1 1 24 1Z",fill:"black"}),React.createElement("path",{d:"M24 2C28.3512 2 32.6047 3.29028 36.2226 5.70767C39.8404 8.12506 42.6602 11.561 44.3254 15.581C45.9905 19.6009 46.4262 24.0244 45.5773 28.292C44.7284 32.5596 42.6331 36.4796 39.5564 39.5564C36.4796 42.6331 32.5596 44.7284 28.292 45.5773C24.0244 46.4261 19.6009 45.9905 15.581 44.3253C11.561 42.6602 8.12507 39.8404 5.70768 36.2225C3.29029 32.6047 2.00001 28.3512 2.00001 24C2.00663 18.1673 4.3266 12.5753 8.45097 8.45096C12.5753 4.32659 18.1673 2.00662 24 2ZM24 0C19.2533 0 14.6131 1.40758 10.6663 4.04473C6.71954 6.68188 3.64341 10.4302 1.8269 14.8156C0.0103989 19.201 -0.464881 24.0266 0.461164 28.6822C1.38721 33.3377 3.67299 37.6141 7.02945 40.9706C10.3859 44.327 14.6623 46.6128 19.3178 47.5388C23.9734 48.4649 28.799 47.9896 33.1844 46.1731C37.5698 44.3566 41.3181 41.2805 43.9553 37.3337C46.5924 33.3869 48 28.7468 48 24C48 17.6348 45.4714 11.5303 40.9706 7.02944C36.4697 2.52856 30.3652 0 24 0V0ZM33.686 25.077C33.5283 25.325 33.318 25.5353 33.07 25.693L21.083 33.321C20.7798 33.514 20.4303 33.6219 20.071 33.6336C19.7118 33.6452 19.356 33.5601 19.0409 33.3872C18.7258 33.2143 18.4629 32.9599 18.2798 32.6506C18.0967 32.3413 18.0001 31.9884 18 31.629V16.371C18.0001 16.0116 18.0967 15.6587 18.2798 15.3495C18.4629 15.0402 18.7258 14.7857 19.0409 14.6128C19.356 14.4399 19.7118 14.3548 20.071 14.3664C20.4303 14.3781 20.7798 14.486 21.083 14.679L33.071 22.308C33.5197 22.5937 33.8365 23.0459 33.9519 23.5652C34.0672 24.0844 33.9716 24.6282 33.686 25.077Z",fill:"white"})),React.createElement("defs",null,React.createElement("clipPath",{id:"clip0_544_81288"},React.createElement("rect",{width:"48",height:"48",fill:"white"}))))))}}n.PlayVideoIcon=f;class e extends React.Component{render(){return React.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 2048 2048",fill:"#fff",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M683 1621q0-35 25-60l537-537-537-537q-25-25-25-60t24-60 61-26q35 0 60 25l598 598q25 25 25 60t-25 60l-598 598q-25 25-60 25-36 0-60-25t-25-61z"}))}}n.RightChevronIcon=e;class o extends React.Component{render(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 32 32",fill:"none"},React.createElement("path",{d:"M11.625 16C11.625 15.8307 11.6868 15.6842 11.8105 15.5605L18.6855 8.68555C18.8092 8.56185 18.9557 8.5 19.125 8.5C19.2943 8.5 19.4408 8.56185 19.5645 8.68555C19.6882 8.80924 19.75 8.95573 19.75 9.125C19.75 9.29427 19.6882 9.44076 19.5645 9.56445L13.1387 16L19.5645 22.4355C19.6882 22.5592 19.75 22.7057 19.75 22.875C19.75 23.0443 19.6882 23.1908 19.5645 23.3145C19.4408 23.4382 19.2943 23.5 19.125 23.5C18.9557 23.5 18.8092 23.4382 18.6855 23.3145L11.8105 16.4395C11.6868 16.3158 11.625 16.1693 11.625 16Z",fill:"black",fillOpacity:"0.8956"}))}}n.LeftNavIcon=o;class s extends React.Component{render(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 32 32",fill:"none"},React.createElement("path",{d:"M12.25 22.875C12.25 22.7057 12.3118 22.5592 12.4355 22.4355L18.8613 16L12.4355 9.56445C12.3118 9.44076 12.25 9.29427 12.25 9.125C12.25 8.95573 12.3118 8.80924 12.4355 8.68555C12.5592 8.56185 12.7057 8.5 12.875 8.5C13.0443 8.5 13.1908 8.56185 13.3145 8.68555L20.1895 15.5605C20.3132 15.6842 20.375 15.8307 20.375 16C20.375 16.1693 20.3132 16.3158 20.1895 16.4395L13.3145 23.3145C13.1908 23.4382 13.0443 23.5 12.875 23.5C12.7057 23.5 12.5592 23.4382 12.4355 23.3145C12.3118 23.1908 12.25 23.0443 12.25 22.875Z",fill:"black",fillOpacity:"0.8956"}))}}n.RightNavIcon=s;class h extends React.Component{render(){return React.createElement("svg",{className:"left-nav-svg-win11",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",fill:"currentColor"},React.createElement("path",{d:"M11.625 16C11.625 15.8307 11.6868 15.6842 11.8105 15.5605L18.6855 8.68555C18.8092 8.56185 18.9557 8.5 19.125 8.5C19.2943 8.5 19.4408 8.56185 19.5645 8.68555C19.6882 8.80924 19.75 8.95573 19.75 9.125C19.75 9.29427 19.6882 9.44076 19.5645 9.56445L13.1387 16L19.5645 22.4355C19.6882 22.5592 19.75 22.7057 19.75 22.875C19.75 23.0443 19.6882 23.1908 19.5645 23.3145C19.4408 23.4382 19.2943 23.5 19.125 23.5C18.9557 23.5 18.8092 23.4382 18.6855 23.3145L11.8105 16.4395C11.6868 16.3158 11.625 16.1693 11.625 16Z",fill:"currentColor",fillOpacity:"0.8956"}))}}n.LeftNavIconWin11=h;class c extends React.Component{render(){return React.createElement("svg",{className:"right-nav-svg-win11",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",fill:"currentColor"},React.createElement("path",{d:"M12.25 22.875C12.25 22.7057 12.3118 22.5592 12.4355 22.4355L18.8613 16L12.4355 9.56445C12.3118 9.44076 12.25 9.29427 12.25 9.125C12.25 8.95573 12.3118 8.80924 12.4355 8.68555C12.5592 8.56185 12.7057 8.5 12.875 8.5C13.0443 8.5 13.1908 8.56185 13.3145 8.68555L20.1895 15.5605C20.3132 15.6842 20.375 15.8307 20.375 16C20.375 16.1693 20.3132 16.3158 20.1895 16.4395L13.3145 23.3145C13.1908 23.4382 13.0443 23.5 12.875 23.5C12.7057 23.5 12.5592 23.4382 12.4355 23.3145C12.3118 23.1908 12.25 23.0443 12.25 22.875Z",fill:"currentColor",fillOpacity:"0.8956"}))}}n.RightNavIconWin11=c;class l extends React.Component{render(){return React.createElement("svg",{width:"7",height:"12",viewBox:"0 0 7 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M0.528573 0.861886C0.268226 1.12224 0.268226 1.54435 0.528573 1.8047L4.72385 5.99996L0.528573 10.1952C0.268226 10.4556 0.268226 10.8777 0.528573 11.138C0.788926 11.3984 1.21103 11.3984 1.47139 11.138L6.13805 6.47136C6.39838 6.21103 6.39838 5.78889 6.13805 5.52856L1.47139 0.861886C1.21103 0.601539 0.788926 0.601539 0.528573 0.861886Z",fill:"black",fillOpacity:"0.8956"}))}}n.BubbleChevron=l;class a extends React.Component{render(){return React.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7H5.5C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6H10.5Z",fill:"#1A1A1A"}))}}n.ChatIcon=a;class v extends React.Component{render(){return React.createElement("svg",{height:"16",width:"16",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 20 20",xmlSpace:"preserve"},React.createElement("path",{fill:"currentColor",d:"M7.5,14.945c-4.105,0-7.445-3.34-7.445-7.445S3.395,0.055,7.5,0.055s7.445,3.34,7.445,7.445  S11.605,14.945,7.5,14.945z M7.5,1.945c-3.063,0-5.555,2.492-5.555,5.555s2.492,5.555,5.555,5.555s5.555-2.492,5.555-5.555  S10.563,1.945,7.5,1.945z"}),React.createElement("path",{fill:"currentColor",d:"M19,20c-0.256,0-0.512-0.098-0.707-0.293l-6.5-6.5c-0.391-0.391-0.391-1.023,0-1.414s1.023-0.391,1.414,0  l6.5,6.5c0.391,0.391,0.391,1.023,0,1.414C19.512,19.902,19.256,20,19,20z"}))}}n.SearchIcon=v;class y extends React.Component{render(){return React.createElement("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{fill:"currentColor",d:"M9.30887 10.516C8.53903 11.1318 7.56252 11.5 6.5 11.5C4.01472 11.5 2 9.48531 2 7.00002C2 4.51473 4.01472 2.5 6.5 2.5C8.98528 2.5 11 4.51473 11 7.00002C11 8.06252 10.6318 9.03901 10.016 9.80885L13.8536 13.6464C14.0488 13.8417 14.0488 14.1583 13.8536 14.3536C13.6583 14.5488 13.3417 14.5488 13.1464 14.3536L9.30887 10.516ZM10 7.00002C10 5.06701 8.433 3.5 6.5 3.5C4.567 3.5 3 5.06701 3 7.00002C3 8.93302 4.567 10.5 6.5 10.5C8.433 10.5 10 8.93302 10 7.00002Z"}))}}n.SearchIconV2=y;class p extends React.Component{render(){return React.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M32 16C32 7.16344 24.8366 0 16 0V0C7.16344 0 0 7.16344 0 16V16C0 24.8366 7.16344 32 16 32V32C24.8366 32 32 24.8366 32 16V16Z",fill:"white"}),React.createElement("path",{d:"M17.6667 8.0835C14.2149 8.0835 11.4167 10.8817 11.4167 14.3335C11.4167 15.7586 11.8937 17.0723 12.6967 18.1237L8.7441 22.0776C8.41866 22.403 8.41866 22.9306 8.7441 23.2561C9.0445 23.5565 9.51719 23.5796 9.8441 23.3254L9.92261 23.2561L13.8765 19.3035C14.9278 20.1065 16.2416 20.5835 17.6667 20.5835C21.1185 20.5835 23.9167 17.7853 23.9167 14.3335C23.9167 10.8817 21.1185 8.0835 17.6667 8.0835ZM17.6667 9.75016C20.198 9.75016 22.25 11.8022 22.25 14.3335C22.25 16.8648 20.198 18.9168 17.6667 18.9168C15.1354 18.9168 13.0834 16.8648 13.0834 14.3335C13.0834 11.8022 15.1354 9.75016 17.6667 9.75016Z",fill:"url(#paint0_linear_1935_18548)"}),React.createElement("defs",null,React.createElement("linearGradient",{id:"paint0_linear_1935_18548",x1:"23.9174",y1:"15.7913",x2:"8.50012",y2:"15.7913",gradientUnits:"userSpaceOnUse"},React.createElement("stop",{stopColor:"#39D2FF"}),React.createElement("stop",{offset:"0.1501",stopColor:"#38CEFE"}),React.createElement("stop",{offset:"0.2931",stopColor:"#35C3FA"}),React.createElement("stop",{offset:"0.4327",stopColor:"#2FB0F3"}),React.createElement("stop",{offset:"0.5468",stopColor:"#299AEB"}),React.createElement("stop",{offset:"0.5827",stopColor:"#2692EC"}),React.createElement("stop",{offset:"0.7635",stopColor:"#1A6CF1"}),React.createElement("stop",{offset:"0.909",stopColor:"#1355F4"}),React.createElement("stop",{offset:"1",stopColor:"#104CF5"}))))}}n.SearchIconV2_MRU=p;class w extends React.Component{render(){return React.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("rect",{width:"32",height:"32",rx:"16",fill:"white"}),React.createElement("path",{d:"M14 6.5C18.1421 6.5 21.5 9.85786 21.5 14C21.5 15.7101 20.9276 17.2866 19.964 18.5483L24.7071 23.2929C25.0976 23.6834 25.0976 24.3166 24.7071 24.7071C24.3466 25.0676 23.7794 25.0953 23.3871 24.7903L23.2929 24.7071L18.5483 19.964C17.2866 20.9276 15.7101 21.5 14 21.5C9.85786 21.5 6.5 18.1421 6.5 14C6.5 9.85786 9.85786 6.5 14 6.5ZM14 8.5C10.9624 8.5 8.5 10.9624 8.5 14C8.5 17.0376 10.9624 19.5 14 19.5C17.0376 19.5 19.5 17.0376 19.5 14C19.5 10.9624 17.0376 8.5 14 8.5Z",fill:"#174AE4"}))}}n.SolidBlueIconV2_MRU=w;class b extends React.Component{render(){return React.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("rect",{width:"32",height:"32",rx:"16",fill:"white"}),React.createElement("path",{d:"M14 6.5C18.1421 6.5 21.5 9.85786 21.5 14C21.5 15.7101 20.9276 17.2866 19.964 18.5483L24.7071 23.2929C25.0976 23.6834 25.0976 24.3166 24.7071 24.7071C24.3466 25.0676 23.7794 25.0953 23.3871 24.7903L23.2929 24.7071L18.5483 19.964C17.2866 20.9276 15.7101 21.5 14 21.5C9.85786 21.5 6.5 18.1421 6.5 14C6.5 9.85786 9.85786 6.5 14 6.5ZM14 8.5C10.9624 8.5 8.5 10.9624 8.5 14C8.5 17.0376 10.9624 19.5 14 19.5C17.0376 19.5 19.5 17.0376 19.5 14C19.5 10.9624 17.0376 8.5 14 8.5Z",fill:"url(#paint0_linear_2886_286814)"}),React.createElement("defs",null,React.createElement("linearGradient",{id:"paint0_linear_2886_286814",x1:"6.49918",y1:"15.7494",x2:"24.9999",y2:"15.7494",gradientUnits:"userSpaceOnUse"},React.createElement("stop",{stopColor:"#39D2FF"}),React.createElement("stop",{offset:"0.1501",stopColor:"#38CEFE"}),React.createElement("stop",{offset:"0.2931",stopColor:"#35C3FA"}),React.createElement("stop",{offset:"0.4327",stopColor:"#2FB0F3"}),React.createElement("stop",{offset:"0.5468",stopColor:"#299AEB"}),React.createElement("stop",{offset:"0.5827",stopColor:"#2692EC"}),React.createElement("stop",{offset:"0.7635",stopColor:"#1A6CF1"}),React.createElement("stop",{offset:"0.909",stopColor:"#1355F4"}),React.createElement("stop",{offset:"1",stopColor:"#104CF5"}))))}}n.GradientIconV2_MRU=b;class k extends React.Component{render(){return React.createElement("svg",{id:"exploreV2",width:"16",height:"16",viewBox:"0 -1 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{fill:"currentColor",d:"M12.7999 4.21445C13.2781 4.4911 13.5999 5.00817 13.5999 5.6004V10.4004C13.5999 12.1677 12.1672 13.6004 10.3999 13.6004H5.5999C5.00768 13.6004 4.4906 13.2786 4.21395 12.8004H10.3999C11.7254 12.8004 12.7999 11.7259 12.7999 10.4004V4.21445ZM11.9999 4.00039C11.9999 3.11673 11.2836 2.40039 10.3999 2.40039L3.9999 2.40039C3.11625 2.40039 2.3999 3.11673 2.3999 4.00039L2.3999 10.4004C2.3999 11.284 3.11625 12.0004 3.9999 12.0004H10.3999C11.2836 12.0004 11.9999 11.284 11.9999 10.4004V4.00039ZM9.5999 7.20039C9.5999 7.4213 9.42082 7.60039 9.1999 7.60039L7.5999 7.60039V9.20038C7.5999 9.4213 7.42082 9.60038 7.1999 9.60038C6.97899 9.60038 6.7999 9.4213 6.7999 9.20038V7.60039H5.1999C4.97899 7.60039 4.7999 7.4213 4.7999 7.20039C4.7999 6.97947 4.97899 6.80039 5.1999 6.80039H6.7999L6.7999 5.20039C6.7999 4.97947 6.97899 4.80039 7.1999 4.80039C7.42082 4.80039 7.5999 4.97947 7.5999 5.20039L7.5999 6.80039L9.1999 6.80039C9.42082 6.80039 9.5999 6.97947 9.5999 7.20039Z"}))}}n.ExploreMoreV2=k;class d extends React.Component{render(){return React.createElement("svg",{width:"11",height:"12",viewBox:"0 0 11 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{fill:"white",d:"M2.23541 0.229987C1.2355 -0.332478 0 0.39009 0 1.53734V10.5376C0 11.6848 1.23546 12.4074 2.23537 11.845L10.2356 7.34501C11.2551 6.77157 11.2551 5.30375 10.2357 4.73028L2.23541 0.229987Z"}))}}n.PlayIconV2=d;class g extends React.Component{render(){return React.createElement("svg",{width:"12",height:"12",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{fill:"currentColor",d:"M14.2185 14.9998C14.0185 14.9998 13.8185 14.9235 13.666 14.771L7.49987 8.60485L1.33372 14.771C1.02872 15.076 0.534357 15.076 0.228737 14.771C-0.0768835 14.466 -0.0762585 13.9716 0.228737 13.666L6.39489 7.49987L0.228737 1.33372C-0.0762585 1.02872 -0.0762585 0.534357 0.228737 0.228737C0.533732 -0.0768835 1.0281 -0.0762585 1.33372 0.228737L7.49987 6.39489L13.666 0.228737C13.971 -0.0762585 14.4654 -0.0762585 14.771 0.228737C15.0766 0.533732 15.076 1.0281 14.771 1.33372L8.60486 7.49987L14.771 13.666C15.076 13.971 15.076 14.4654 14.771 14.771C14.6185 14.9235 14.4185 14.9998 14.2185 14.9998Z"}))}}n.DismssIcon=g})(t=n.DSB||(n.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){class i extends React.Component{getMonthAndDay(t,i){let r=n.getCurrentLanguage();n.config.disableDSBPastMoments&&(r=r===null||r===void 0?void 0:r.substring(0,2));return t.toLocaleDateString(r,{month:i,day:"numeric"})}getDayOfWeek(t){let i=n.getCurrentLanguage();n.config.disableDSBPastMoments&&(i=i===null||i===void 0?void 0:i.substring(0,2));let r=t.toLocaleDateString(i,{weekday:"long"});return r?r.charAt(0).toUpperCase()+r.slice(1):""}render(){const{monthFormat:r,showDayOfWeek:t,classNames:u}=this.props,i=n.getCurrentDateDSB(),f=u+" dsb-date-card";return React.createElement("h1",{className:f},!t&&React.createElement("span",null,n.Host.getLocString("DSBIotdDate")),t&&React.createElement("span",null,this.getDayOfWeek(i)),React.createElement("span",{className:"dsb-date-dot"},"â€¢"),React.createElement("span",null,this.getMonthAndDay(i,r)))}}t.DateCard=i})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(r){const u=({isLeft:r,isRtl:u,momentDate:f,onFlipHandler:o,previousDateInFlipper:s,nextDateInFlipper:e})=>{const h=r?"left":"right",v=n.config.useCobaltCSS?`dsb-nav-${h}-w11 itemTooltip`:`dsb-nav-${h} itemTooltip`,c=`DSBFlipperChevron${h}`,y=`AutoSuggest.${c}`,l=n.config.useCobaltCSS?React.createElement(i.LeftNavIconWin11,null):React.createElement(i.LeftNavIcon,null),a=n.config.useCobaltCSS?React.createElement(i.RightNavIconWin11,null):React.createElement(i.RightNavIcon,null),p=()=>{let t,i;return s?(t=s,i="DSBLeftChevronAnnouncement"):e&&(t=e,i="DSBRightChevronAnnouncement"),t?n.formatString(n.Host.getLocString(i),[n.convertMomentDateForRender(t)]):""};return React.createElement("div",{className:v,"data-partnertag":t.whenTestHooks(y),tabIndex:-1,"data-title":r?n.Host.getLocString("DSBLeftChevron"):n.Host.getLocString("DSBRightChevron"),title:r?n.Host.getLocString("DSBLeftChevron"):n.Host.getLocString("DSBRightChevron"),"aria-label":p(),onClick:n=>{var t;n.stopPropagation();o&&o(f,r?-1:1);n.screenX!==0&&n.screenY!==0&&((t=document.getElementById(c))===null||t===void 0?void 0:t.blur())},id:c,role:"button"},r?u?a:l:u?l:a)},f=({moment:t,shouldShowDSBFlipper:e,previousDateInFlipper:f,nextDateInFlipper:r})=>{const o=n.isRtl(),s=n.convertMomentDateForRender(t.date),h=t===null||t===void 0?void 0:t.onFlipHandler;return e?React.createElement("div",{className:"dsb-header"},React.createElement(u,{isLeft:!0,isRtl:o,momentDate:t.date,onFlipHandler:h,previousDateInFlipper:f}),!n.config.useCobaltCSS&&React.createElement("h1",{className:"dsb-date-card","aria-live":"polite"},React.createElement("span",{className:"accessible-label"},n.Host.getLocString("FlipperDateUpdated")),React.createElement("span",null,s)),React.createElement(u,{isLeft:!1,isRtl:o,momentDate:t.date,onFlipHandler:h,nextDateInFlipper:r}),n.config.useCobaltCSS&&React.createElement("h1",{className:"dsb-date-card","aria-live":"polite"},React.createElement("span",{className:"accessible-label"},n.Host.getLocString("FlipperDateUpdated")),React.createElement("span",null,s))):React.createElement(i.DateCard,{monthFormat:"long",showDayOfWeek:!1})};class e extends React.Component{render(){var i,u;const{moment:t,hideHeader:e,shouldShowDSBFlipper:o,isPastMoment:s,previousDateInFlipper:h,nextDateInFlipper:c}=this.props,l=((i=t===null||t===void 0?void 0:t.sectionGroups)===null||i===void 0?void 0:i.length)>0;t===null||t===void 0?void 0:t.sectionGroups.sort((n,t)=>n.UXOrder-t.UXOrder);const a=n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.isInBlendedMode(),v=a?"dsb-sections-blended":"dsb-sections";return l?React.createElement("div",{className:"dsb-moment-container"},!e&&React.createElement(f,{moment:t,shouldShowDSBFlipper:o,previousDateInFlipper:h,nextDateInFlipper:c}),React.createElement("div",{className:"dsb-moment-content"},React.createElement("div",{className:v,id:"dsb-sections"},(u=t===null||t===void 0?void 0:t.sectionGroups)===null||u===void 0?void 0:u.map(n=>{var i;if(n.cardType==="CallToAction")return n&&((i=n===null||n===void 0?void 0:n.sections)===null||i===void 0?void 0:i.map(n=>{n.props.isFullWidthDSB=!1})),React.createElement(r.ErrorBoundary,{key:n.id,fromArea:`${t.date}-CallToAction`,data:n},React.createElement(r.CTACarousel,{key:`${t.date}-${n.id}`,sections:n.sections,isPastMoment:s,date:t.date}));else{let i=n.sections[0];return i&&(i.props.isFullWidthDSB=!1),i&&React.createElement(r.ErrorBoundary,{key:n.id,fromArea:`${t.date}-${i.props.Scenario}`,data:n},React.createElement(i.sectionView,Object.assign(Object.assign({},i.props),{key:i.props.id})))}})))):React.createElement("div",null)}}r.DynamicSearchBoxTemplateContainer=e})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(r){class u extends React.Component{render(){const{cardAriaLabel:s,clickThroughUrl:h,cropNeeded:c,id:f,imageHostName:l,imageUrl:a,instrumentedItem:e,scenario:v,tagCard:y,wholePageTabsData:u,IsVideoArticle:o,onDismissHandler:p,showDismissIcon:w,isFullText:b,isFullWidthDSB:k}=this.props,d=a,g="DSB."+v,nt=o&&o==="true"?React.createElement(i.PlayVideoIcon,null):null,tt=k?n.config.enableHero190FullWidth?"hero-190-fw":"":n.config.enableHero201?"hero-201":n.config.enableHero170?"hero-170":n.config.enableHero190?"hero-190":"";return React.createElement("div",{id:f,className:t.classNames("dsb-hero"+`${c?" dsb-hero--cropped":""}`,b&&"fullText",tt),onClick:t=>n.clickDSBHandler(t.nativeEvent,h,e),tabIndex:-1,role:"link","aria-label":s,"data-partnertag":t.whenTestHooks(g),"data-h":e.getHValue()},w&&React.createElement("div",{className:"dsb-hero__dismiss-icon",tabIndex:-1,id:f+"_dissmiss",role:"button","aria-label":n.Host.getLocString("DimissHeroCard"),onClick:n=>{n.stopPropagation(),p()},"data-partnertag":t.whenTestHooks("AutoSuggest.DismissIcon")},React.createElement(i.DismssIcon,null)),React.createElement("div",{className:`dsb-hero__img-container ${r.getWholePageTabsClassName(u===null||u===void 0?void 0:u.Items)}`},React.createElement("div",{className:"dsb-hero__img"+`${y?" dsb-hero__img--shading":""}`,style:d},nt)),React.createElement("div",{id:`${f}_card`,className:`dsb-hero__content-container focusable ${r.getWholePageTabsClassName(u===null||u===void 0?void 0:u.Items)}`},this.props.children),r.hasWholePageTabs(u===null||u===void 0?void 0:u.Items)&&!n.config.useCobaltCSS&&React.createElement(r.WholePageTabs,{scenario:null,Items:u===null||u===void 0?void 0:u.Items,id:`${f}_wholepagetabs`,imageHostName:l}))}}r.HeroContainer=u})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(i){const r=55;class u extends React.Component{render(){const{id:u,Text:e,ClickThroughUrl:s,Icon:o,InstrumentedItem:f}=this.props;return React.createElement("div",{id:u,key:u,className:"dsb-hero__description focusable selectable","data-partnertag":t.whenTestHooks("DSB.HeroDescription"),"data-h":f===null||f===void 0?void 0:f.getHValue(),tabIndex:-1,role:"link",onClick:t=>{var i;s&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,s,f))},"aria-label":e,style:{minWidth:e.length<r?450:undefined}},React.createElement(React.Fragment,null,o&&React.createElement("div",{id:`${u}_icon`,key:`${u}_icon`,className:"dsb-hero__description_icon"},n.View.DSB[o]&&React.createElement(i.DynamicIcons,{id:u,Icon:o}))),React.createElement("div",{id:`${u}_text`,key:`${u}_text`,className:"dsb-hero__description_text"},e))}}i.HeroDescription=u})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){const i=4;class r extends React.Component{render(){var s,h,c;const{id:v,FieldsStore:u,Scenario:e,onLeft:o,isFullWidthDSB:r,date:y,imageHostName:p}=this.props;let l=((s=u===null||u===void 0?void 0:u.Items)===null||s===void 0?void 0:s.length)?r?12:6:0;const f=(h=u===null||u===void 0?void 0:u.Items)===null||h===void 0?void 0:h.map((i,f)=>{var o,s;const h=r?`mega_${e}_${f}-full-pane`:`mega_${e}_${f}${y?"_"+y:""}`,c=`dsb-mega__images-container focusable`,a={id:h,key:h,dsbScenario:n.DSBScenario.ExploreMore,index:f,imageHostName:p,isFullWidthDSB:r,item:i,itemsLength:(s=(o=u===null||u===void 0?void 0:u.Items)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0,megaClassName:c,Scenario:e,padding:l};return React.createElement(t.MegaImageItem,Object.assign({},a))}),w=n.RuntimeConfiguration.TextScaleFactor;let a=0;if(r&&o){const{width:t}=n.generateThumbnailDimension({dsbSection:2,dsbScenario:n.DSBScenario[e],isWindows11:n.config.useCobaltCSS,isTwoCta:!1,isFullWidthDSB:r});a=t}let b;b=n.config.disbaleWideForLargeTextScale?r?o?4:3:3:r?(o?4:3)/w:4/w;let k=a>0?n.getTilesToShowCount(2,n.DSBScenario[e],!1,r,a,o,l):b;const d={dsbScenario:e,tilesToShow:k,showAriaMessage:!1,tileSpacing:l,containerID:v,moveSlides:Math.floor(k),noPaddingCarousel:!0};return React.createElement(t.MegaContent,{id:`${v}${r?"_full_width":""}`,isFullWidthDSB:r,containerClassName:`dsb-mega mega ${n.config.expandMegaClickTarget?"exp-mega-click":""}`,headerClassName:`${n.config.expandMegaClickTarget?"exp-mega-click":""}`,scenario:e,FieldsStore:u,instrumentedItem:(c=this===null||this===void 0?void 0:this.props)===null||c===void 0?void 0:c.instrumentedItem,imageHostName:p},React.createElement("div",{className:"dsb-mega__container"},(r||(f===null||f===void 0?void 0:f.length)>i)&&React.createElement("div",{className:"dsb-mega__carousel__container"},React.createElement(t.MegaCarouselComponent,Object.assign({},d),f)),!r&&(f===null||f===void 0?void 0:f.length)<=i&&(f===null||f===void 0?void 0:f.slice(0,i))))}}t.MegaCard=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(i){const r=n.config.useCobaltCSS&&n.config.newTvDesignWin11,u=15;class f extends React.Component{constructor(){super(...arguments);this.setIsHovered=(n,t)=>{t&&this.setState(t=>{const i=t.items.map(t=>t.id===n?Object.assign(Object.assign({},t),{isHovered:!t.isHovered}):t);return{items:i}})};this.getItems=()=>{const n=[];for(let t=0;t<u;t++)n.push({id:t,isHovered:!1});return n};this.state={items:this.getItems()};this.isItemHovered=n=>{var t;return((t=this.state.items.find(t=>t.id===n))===null||t===void 0?void 0:t.isHovered)||!1}}formatLength(n){const t=Math.floor(n/1e3),i=Math.floor(t/60);return`${i}:${String(t%60).padStart(2,"0")}`}render(){var a;const{id:v,FieldsStore:e,Scenario:h,isFullWidthDSB:f,imageHostName:p,onLeft:c}=this.props,y=n.config.useCobaltCSS&&!f?n.config.newTvDesignWin11?2:3:2,w=y,b=u>2?r?"dsb-mega__container_newtv addit dsb-mega__container--many":"dsb-mega__container dsb-mega__container--many":"dsb-mega__container";let l=[],o=0,s=!1;if((e===null||e===void 0?void 0:e.Items)&&e.Items.length>=y){l=e.Items.slice(0,u).map((l,a)=>{var k,d,g,nt,tt;const{ClickThroughUrl:it,Title:ot,Thumbnail:v,MotionThumbnail:w,TimeLength:rt,PublisherName:ut,ChannelName:st,ViewCount:ht,LikeCount:ct,PublishedDateTime:lt,date:at}=l;let y=v===null||v===void 0?void 0:v.ThumbnailId,p=f||r?v===null||v===void 0?void 0:v.ThumbnailHeightV2:v===null||v===void 0?void 0:v.ThumbnailHeight;if(o=f||r?v===null||v===void 0?void 0:v.ThumbnailWidthV2:v===null||v===void 0?void 0:v.ThumbnailWidth,f&&!c&&!(p>0&&o>0)){const{width:t,height:i}=n.generateThumbnailDimension({dsbSection:2,dsbScenario:n.DSBScenario.TrendingVideo,isWindows11:n.config.useCobaltCSS,isTwoCta:!1,isFullWidthDSB:f,isOnLeftColumn:c});o=t;p=i}s=p>0&&o>0;const ft=s?{width:`${o}px`,height:`${p}px`}:{};let b=!1;const et=w===null||w===void 0?void 0:w.ThumbnailId;w&&(b=!0);const vt=()=>React.createElement(React.Fragment,null,React.createElement("div",{style:ft,className:"dsb-mega__thumbnail motion"},React.createElement("video",{muted:!0,loop:!0,autoPlay:!0,src:`${s?n.generateBingThumbnailUrlFromId(et,this.props.imageHostName,o,p,1):n.generateBingThumbnailUrlFromIdByScenario(et,{dsbSection:2,dsbScenario:n.DSBScenario.TrendingVideo,isWindows11:n.config.useCobaltCSS,isTwoCta:!1,isFullWidthDSB:f||r,isOnLeftColumn:c},this.props.imageHostName,1)}`})),React.createElement("div",{className:"dsb-mega-videos__preview"},"Preview"),React.createElement("div",{className:"dsb-mega__length__motion"},this.formatLength(rt)),f&&React.createElement("div",{className:"dsb-mega-videos__play__motion"},React.createElement(t.PlayIconV2,null))||!(f||r)&&React.createElement("div",{className:"dsb-mega-videos__play__tvcarousel__motion"},React.createElement(t.PlayIcon,null))),yt=()=>React.createElement("div",{className:"dsb-mega__thumbnail",style:Object.assign(Object.assign({},n.getImageStyle(y,2,n.DSBScenario.TrendingVideo,this.props.imageHostName,!1,!1,f||r,o,p,c)),ft)},React.createElement("div",{className:"dsb-mega__length"},this.formatLength(rt)),(f||r)&&React.createElement("div",{className:"dsb-mega-videos__play"},React.createElement(t.PlayIconV2,null)),!(f||r)&&React.createElement("div",{className:"dsb-mega-videos__play__tvcarousel"},React.createElement(t.PlayIcon,null)));return(this.props.isFullWidthDSB||r)&&((k=y===null||y===void 0?void 0:y.toLowerCase())===null||k===void 0?void 0:k.indexOf("/th?"))>=0&&(y=n.extractThumbnailIdFromUrl(y)),React.createElement(i.MegaVideoItem,{index:a,itemsLength:(nt=((d=e===null||e===void 0?void 0:e.Items)===null||d===void 0?void 0:d.length)>u?u:(g=e===null||e===void 0?void 0:e.Items)===null||g===void 0?void 0:g.length)!==null&&nt!==void 0?nt:0,key:a,date:at,PublishedDateTime:lt,ViewCount:ht,LikeCount:ct,scenario:h,instrumentedItem:l.instrumentedItem,className:"dsb-mega__images-container focusable",isFullWidthDSB:f||r,showMetadata:!!e.ShowMetadata,clickEvent:t=>{var i;it&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,it,l.instrumentedItem))},onMouseEnterEvent:()=>this.setIsHovered(a,b),onMouseLeaveEvent:()=>this.setIsHovered(a,b),Title:ot,PublisherName:ut,ChannelName:st,widthOverride:s?o:null,imageHostName:this.props.imageHostName,sourceIconId:(tt=e.IconThumbnailIds)===null||tt===void 0?void 0:tt[ut]},b&&this.isItemHovered(a)?React.createElement(vt,null):React.createElement(yt,null))});let y=l?s?12:f||r?12:5:0,k=s?n.getTilesToShowCount(2,n.DSBScenario[h],!1,f||r,o,c,y):w;const g=f?n.config.useCobaltCSS&&n.config.enableDSBWin11FullWidth?"8px":"16px":"0px",d={dsbScenario:h,tilesToShow:k,showAriaMessage:!1,tileSpacing:y,containerID:v,verticalSpacing:g,moveSlides:Math.floor(k)};return React.createElement(i.MegaContent,{id:`${v}${f?"_full_width":""}`,isFullWidthDSB:f,containerClassName:"dsb-mega mega-video",FieldsStore:e,scenario:h,showVideoIconV2:!0,instrumentedItem:(a=this===null||this===void 0?void 0:this.props)===null||a===void 0?void 0:a.instrumentedItem,imageHostName:p},React.createElement("div",{className:`${b} ${h}`},f&&React.createElement("div",{className:"dsb-mega__carousel__container"},React.createElement(i.MegaCarouselComponent,Object.assign({},d),l)),!f&&React.createElement(i.MegaCarouselComponent,Object.assign({},d),l)))}return null}}i.MegaCardVideo=f})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{render(){const{Icon:t,id:i}=this.props;return React.createElement(React.Fragment,null,t&&[t].map((t,r)=>React.createElement(n.View.DSB[t],{key:i+"_"+r})))}}t.DynamicIcons=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{render(){var u;const{id:s,index:h,itemsLength:c,ClickThroughUrl:l,imageHostName:f,FieldsStore:i,isTwoCta:e,instrumentedItem:a,isFullWidthDSB:r,momentMetadata:v}=this.props,y=n.getImageStyleNew(i.Thumbnail,1,n.DSBScenario.ImageSimpleCTA,f,e,!1,r),o=(u=i.Title)!==null&&u!==void 0?u:n.Host.getLocString(i.CaptionResourceKey);let p=n.config.enableWin10CTA&&!r?"dsb-cta__title dsb-cta-full-size":"dsb-cta__title",w=n.config.enableWin10CTA&&!r?"dsb-cta-full-size":"",b=n.config.enableWin10CTA&&!r?"dsb-cta__img dsbFullCta":"dsb-cta__img";return React.createElement(t.CTAContainer,{id:`${s}${r?"_full_width":""}`,className:"dsb-imgsimple",ariaLabel:o,HValue:this.props.instrumentedItem.getHValue(),tooltips:i.Title,clickThroughUrl:l,scenario:"ImageSimpleCTA",imageHostName:f,clickHandler:t=>n.clickDSBHandler(t.nativeEvent,i===null||i===void 0?void 0:i.ClickThroughUrl,a),momentMetadata:v,isTwoCta:e,isVideoArticle:i.IsVideoArticle,index:h,itemsLength:c,isFullWidthDSB:r},React.createElement("div",{className:b,style:y}),React.createElement("div",{className:"dsb-cta__body"},i.Description&&React.createElement("div",{className:"dsb-cta__main"},i.Description),React.createElement("div",{className:p},React.createElement("span",{className:w},o))))}}t.ImageSimpleCTA=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{render(){function p(){return n.Host.getLocString(i.CaptionResourceKey).replace("{0}","")}var u,f;const{id:h,index:c,itemsLength:l,imageHostName:o,FieldsStore:i,isTwoCta:s,instrumentedItem:a,isFullWidthDSB:r,momentMetadata:v}=this.props,y=n.getImageStyle((u=i.Thumbnail)===null||u===void 0?void 0:u.ThumbnailId,1,n.DSBScenario.OnThisDay,o,s,!1,r);const e=i.CaptionResourceKey?p():i.Title,w=`${e}, ${i.Subtitle}}`;let b=n.config.enableWin10CTA&&!r?"dsb-cta__title dsb-cta-full-size":"dsb-cta__title",k=n.config.enableWin10CTA&&!r?"dsb-cta__img dsbFullCta":"dsb-cta__img",d=n.config.enableWin10CTA&&!r?"dsb-cta__title_secondary dsb-cta-full-size":"dsb-cta__title_secondary";return React.createElement(t.CTAContainer,{id:`${h}${r?"_full_width":""}`,className:"dsb-imgsubtitle",thumbnailId:(f=i===null||i===void 0?void 0:i.Thumbnail)===null||f===void 0?void 0:f.ThumbnailId,ariaLabel:w,HValue:this.props.instrumentedItem.getHValue(),tooltips:`${e}
${i.Subtitle}`,clickThroughUrl:i.ClickThroughUrl,scenario:"OnThisDay",imageHostName:o,clickHandler:t=>n.clickDSBHandler(t,i.ClickThroughUrl,a),momentMetadata:v,isTwoCta:s,isVideoArticle:i.IsVideoArticle,index:c,itemsLength:l,isFullWidthDSB:r},React.createElement("div",{className:k,style:y}),React.createElement("div",{className:"dsb-cta__body"},React.createElement("div",{className:b},React.createElement("div",{className:"dsb-cta__title_primary"},e),React.createElement("div",{className:d},i.Subtitle))))}}t.ImageSubtitleCTA=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{addQuotes(t){return n.Host.getLocString("Quotes").replace("{0}",t)}render(){const{id:f,index:e,itemsLength:o,imageHostName:s,FieldsStore:i,instrumentedItem:h,momentMetadata:c,isTwoCta:l,isFullWidthDSB:r}=this.props,u=i.CaptionResourceKey?n.Host.getLocString(i.CaptionResourceKey):i.Title,a=`${u}, ${i.QuoteText}, ${i.AuthorName}`;let v=n.config.enableWin10CTA&&!r?"dsb-cta__title dsb-cta-full-size":"dsb-cta__title",y=n.config.enableWin10CTA&&!r?"dsb-cta__title_secondary dsb-cta-full-size":"dsb-cta__title_secondary",p=n.config.enableWin10CTA&&!r?"dsb-cta__img dsbFullCta":"dsb-cta__img";return React.createElement(t.CTAContainer,{id:`${f}${r?"_full_width":""}`,className:"dsb-bgsubtitle",ariaLabel:a,HValue:this.props.instrumentedItem.getHValue(),tooltips:`${u}:
${i.AuthorName}
${this.addQuotes(i.QuoteText)}`,clickThroughUrl:i.ClickThroughUrl,scenario:"QuoteOfTheDay",imageHostName:s,clickHandler:t=>n.clickDSBHandler(t.nativeEvent,i.ClickThroughUrl,h),momentMetadata:c,isTwoCta:l,isVideoArticle:i.IsVideoArticle,index:e,itemsLength:o,isFullWidthDSB:r},React.createElement("div",{className:p}),React.createElement("div",{className:"dsb-cta__body"},i.QuoteText&&React.createElement("div",{className:"dsb-cta__main"},this.addQuotes(i.QuoteText)),React.createElement("div",{className:v},React.createElement("div",{className:"dsb-cta__title_primary"},u),React.createElement("div",{className:y},i.AuthorName))))}}t.SolidBackgroundSubtitleCTA=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{render(){const{id:f,index:e,itemsLength:o,imageHostName:s,FieldsStore:i,instrumentedItem:h,momentMetadata:c,isTwoCta:l,isFullWidthDSB:r}=this.props,u=i.CaptionResourceKey?n.Host.getLocString(i.CaptionResourceKey):i.Title,a=`${u}, ${i.HeadWord}, ${i.WordFormType}`,v=n.getTooltips(u,i.HeadWord,i.Pronunciation,i.WordFormType),y=React.createElement(React.Fragment,null,React.createElement("div",{className:"dsb-cta__header"},i.HeadWord),i.Pronunciation&&React.createElement("div",{className:"dsb-bgsimple__pronunciation"},"[",i.Pronunciation,"]"),React.createElement("div",{className:"dsb-bgsimple__form"},i.WordFormType),React.createElement("div",{className:"dsb-bgsimple__definition"},i.Definition));let p=n.config.enableWin10CTA&&!r?"dsb-cta__title dsb-cta-full-size":"dsb-cta__title",w=n.config.enableWin10CTA&&!r?"dsb-cta__img dsbFullCta":"dsb-cta__img";return React.createElement(t.CTAContainer,{id:`${f}${r?"_full_width":""}`,className:"dsb-bgsimple",ariaLabel:a,HValue:this.props.instrumentedItem.getHValue(),tooltips:v,clickThroughUrl:i.ClickThroughUrl,scenario:i.Scenario,imageHostName:s,clickHandler:t=>n.clickDSBHandler(t.nativeEvent,i.ClickThroughUrl,h),momentMetadata:c,isTwoCta:l,isVideoArticle:i.IsVideoArticle,index:e,itemsLength:o,isFullWidthDSB:r},React.createElement("div",{className:w}),React.createElement("div",{className:"dsb-cta__body"},React.createElement("div",{className:"dsb-cta__main"},y),React.createElement("div",{className:p},React.createElement("div",{className:"dsb-cta__title_primary"},u))))}}t.SolidBackgroundSimpleCTA=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(r){r.DSBLinkButton=r=>{const{btnId:s,btnTitle:h,btnClickThroughUrl:e,btnInstrumentedItem:u,btnClassName:c,clickHandler:o,heroOverlay:l,imageHostName:a,thumbnail:f}=r;return e?React.createElement("div",{id:s,className:c,"data-partnertag":t.whenTestHooks("DSB.DSBLinkButton"),"data-h":u===null||u===void 0?void 0:u.getHValue(),tabIndex:-1,role:"link",onClick:t=>{var i;(i=t.persist)===null||i===void 0?void 0:i.call(t);t.stopPropagation();const r=async()=>await n.clickDSBHandler(t.nativeEvent,e,u);typeof o=="function"?o(r,t.nativeEvent):r()}},f&&React.createElement("div",{className:"logo-image",style:{backgroundImage:`url('${n.generateBingThumbnailUrlFromId(f.ThumbnailId,a,f.ThumbnailWidth,f.ThumbnailHeight)}')`,backgroundSize:n.config.limitScaleRange&&SearchAppWrapper.CortanaApp.textScaleFactor>n.MaxTextScaleThres?"cover":undefined}}," "),h,l&&React.createElement("span",{className:"hero-icon-padding"+(n.isRtl()?" isrtl":"")},React.createElement(i.BubbleChevron,null))):null};class u extends React.Component{render(){var e,o,s,h,c,l,a,v,y;const{className:it,megaTitle:rt,ariaLabel:ut,FieldsStore:t,iconId:ft,iconName:d,megaLinkId:g,imageHostName:p,imageSrc:et,instrumentedItem:nt,carouselPaginationEnabled:ot,currentCarouselPage:tt,sponsorImageId:w}=this.props,i=t===null||t===void 0?void 0:t.MegaLink,st=((e=t===null||t===void 0?void 0:t.MegaLink)===null||e===void 0?void 0:e.CaptionResourceKey)?(s=n.Host.getLocString((o=t===null||t===void 0?void 0:t.MegaLink)===null||o===void 0?void 0:o.CaptionResourceKey))!==null&&s!==void 0?s:"":(c=(h=t===null||t===void 0?void 0:t.MegaLink)===null||h===void 0?void 0:h.Title)!==null&&c!==void 0?c:"",b=t.IconId!=undefined;let u=(i===null||i===void 0?void 0:i.ClickThroughUrl)?(l=i===null||i===void 0?void 0:i.ClickThroughUrl)!==null&&l!==void 0?l:"":(a=t===null||t===void 0?void 0:t.ClickThroughUrl)!==null&&a!==void 0?a:"";const ht=i===null||i===void 0?void 0:i.instrumentedItem;let ct=n.config.enableSeeMoreNewColor?"dsb-carousel__megalink focusable selectable dsb-new-see-more-color":"dsb-carousel__megalink focusable selectable";const f=(t===null||t===void 0?void 0:t.UXTemplateName)=="MegaBubble"?24:16,lt=n.generateBingThumbnailUrlFromId(t===null||t===void 0?void 0:t.IconId,p,f,f),at=n.generateBingThumbnailUrlFromId(w,p,f,f),k=ot===!0&&tt>=0,vt=k?(v=t===null||t===void 0?void 0:t.Items)===null||v===void 0?void 0:v.map((n,t)=>{var i,r;return{isCompleted:((r=(i=n.IsCompleted)===null||i===void 0?void 0:i.toLowerCase)===null||r===void 0?void 0:r.call(i))==="true",isActive:t===tt}}):null;return React.createElement("div",{className:`${it} ${!(b||d)?" no-icon":""}`,"aria-label":ut,onClick:t=>{var i;u&&nt&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,u,nt))}},b&&React.createElement("img",{src:lt}),!et&&!b&&React.createElement(r.DynamicIcons,{id:ft,Icon:d}),React.createElement("span",null,rt),i&&!k&&!w&&React.createElement(r.DSBLinkButton,{btnId:g,key:g,btnTitle:st,btnClickThroughUrl:u!==null&&u!==void 0?u:(y=t===null||t===void 0?void 0:t.MegaLink)===null||y===void 0?void 0:y.ClickThroughUrl,btnInstrumentedItem:ht,btnClassName:ct}),k&&React.createElement(r.MegaCarouselPagination,{paginationItems:vt,imageHostName:p}),w&&React.createElement("img",{className:"right-icon disable_darktheme_invert",role:"link",tabIndex:-1,src:at}))}}r.MegaHeader=u;class f extends React.Component{render(){var s,h,c,l,a,v,y,p;const{FieldsStore:i,showVideoIconV2:tt,id:e,containerClassName:it,scenario:o,instrumentedItem:f,headerClassName:g,children:rt,imageSrc:ut,withNewsIconV2:ft,isFullWidthDSB:nt,iconId:w,iconName:b,megaTitle:r,imageHostName:et,disableClick:ot,carouselPaginationEnabled:st,currentCarouselPage:ht}=this.props,k=(i===null||i===void 0?void 0:i.CaptionResourceKey)?(s=n.Host.getLocString(i===null||i===void 0?void 0:i.CaptionResourceKey))!==null&&s!==void 0?s:"":(h=i===null||i===void 0?void 0:i.Title)!==null&&h!==void 0?h:"";let d=((c=i===null||i===void 0?void 0:i.MegaLink)===null||c===void 0?void 0:c.ClickThroughUrl)?(a=(l=i===null||i===void 0?void 0:i.MegaLink)===null||l===void 0?void 0:l.ClickThroughUrl)!==null&&a!==void 0?a:"":(v=i===null||i===void 0?void 0:i.ClickThroughUrl)!==null&&v!==void 0?v:"";const ct=`${e}_container`+((y=i===null||i===void 0?void 0:i.MegaLink)===null||y===void 0?void 0:y.Id),lt=(p=i===null||i===void 0?void 0:i.Icon)!==null&&p!==void 0?p:"";return React.createElement("div",{id:`${e}_container`+o,key:`${e}_container`+o,"aria-label":r!==null&&r!==void 0?r:k,className:it,"data-region":o,"data-partnertag":t.whenTestHooks(`DSB.${o}`),"data-h":f===null||f===void 0?void 0:f.getHValue(),onClick:async t=>{d&&!ot&&n.clickDSBHandler(t.nativeEvent,d,f)},role:"link"},React.createElement(u,{className:`${g?`${g} dsb-mega__header`:"dsb-mega__header"}${d?" dsb-clickable-containers":""}`,ariaLabel:r!==null&&r!==void 0?r:k,iconId:w!==null&&w!==void 0?w:`${e}_mega_header`,megaTitle:r!==null&&r!==void 0?r:k,iconName:b!==null&&b!==void 0?b:lt,showVideoIconV2:!!tt,imageSrc:ut,withNewsIconV2:ft,isFullWidthDSB:nt,megaLinkId:`${ct}${nt?"_full_width":""}`,FieldsStore:i,imageHostName:et,instrumentedItem:f,carouselPaginationEnabled:st,currentCarouselPage:ht}),rt)}}r.MegaContent=f;r.MegaImageItem=t=>{var o,s,h;const{id:a,isFullWidthDSB:u,imageHostName:d,index:g,itemsLength:nt,megaClassName:tt,dsbScenario:v,item:{Title:y,Thumbnail:i,Publisher:it,PublisherLogo:rt,instrumentedItem:f,ClickThroughUrl:c},padding:p}=t;let r=i===null||i===void 0?void 0:i.ThumbnailId,w=u?i===null||i===void 0?void 0:i.ThumbnailWidthV2:i===null||i===void 0?void 0:i.ThumbnailWidth,b=u?i===null||i===void 0?void 0:i.ThumbnailHeightV2:i===null||i===void 0?void 0:i.ThumbnailHeight;u&&((o=r===null||r===void 0?void 0:r.toLowerCase())===null||o===void 0?void 0:o.indexOf("/th?"))>=0&&(r=n.extractThumbnailIdFromUrl(r));r||(r=i===null||i===void 0?void 0:i.ThumbnailUrl);const ut={Publisher:it,PublisherLogo:rt};let l="dsb-mega__tile",k;if(n.config.megaCardImageZoomClassNames!=null&&n.config.megaCardImageZoomClassNames.length>0){l=`${l} ${n.config.megaCardImageZoomClassNames.join(" ")}`;const{finalWidth:t,finalHeight:i}=n.getThumbnailSize(Number(w),Number(b),2,v,!1,u!==null&&u!==void 0?u:!1);k={maxWidth:`${t}px`,height:`${i}px`}}return React.createElement("div",{id:a,key:a,className:tt,"data-h":f===null||f===void 0?void 0:f.getHValue(),"data-clkurl":c,onClick:t=>{var i;c&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,c,f))},role:"link","aria-label":y,tabIndex:-1,"aria-posinset":g+1,"aria-setsize":nt,style:p?{padding:`0 ${p/2}px`}:{}},React.createElement("div",{className:l},React.createElement("div",{className:"dsb-mega__thumbnail-wrapper",style:k},React.createElement("div",{className:"dsb-mega__thumbnail",style:n.getImageStyleMegaExt(r,2,v,d,!1,!1,u,Number(w),Number(b))})),((s=t.item)===null||s===void 0?void 0:s.Publisher)&&((h=t.item)===null||h===void 0?void 0:h.PublisherLogo)&&React.createElement(e,Object.assign({},ut)),React.createElement("div",{className:"dsb-mega__image-title"},y)))};r.MegaRewardsDailyItems=t=>{const{id:e,isFullWidthDSB:u,index:c,itemsLength:l,megaClassName:a,dsbScenario:v,item:{Title:o,Thumbnail:i,instrumentedItem:r,ClickThroughUrl:f,Description:s,RewardsPoints:h}}=t;let y=i===null||i===void 0?void 0:i.ThumbnailUrl,p=u?i===null||i===void 0?void 0:i.ThumbnailWidthV2:i===null||i===void 0?void 0:i.ThumbnailWidth,w=u?i===null||i===void 0?void 0:i.ThumbnailHeightV2:i===null||i===void 0?void 0:i.ThumbnailHeight;return React.createElement("div",{id:e,key:e,className:a,"data-h":r===null||r===void 0?void 0:r.getHValue(),"data-clkurl":f,onClick:t=>{var i;f&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,f,r))},role:"link","aria-label":`${o} +${h}, ${s}`,tabIndex:-1,"aria-posinset":c+1,"aria-setsize":l},React.createElement("div",{className:"dsb-rewards-daily-set__tile"},React.createElement("div",{className:"dsb-mega__thumbnail",style:n.getImageStyleMegaRewards(y,2,v,!1,u,Number(p),Number(w))}),React.createElement("div",{className:"dsb-rewards-daily-set__content"},React.createElement("div",{className:"dsb-rewards-daily-set__content-title"},React.createElement("div",null,o),React.createElement("div",{className:"points-mark"},"+"),React.createElement("div",null,h)),React.createElement("div",{className:"dsb-rewards-daily-set__content-description"},s))))};r.MegaNewsList=t=>{var r,u,f,e,o,s,h,c,l,a,v,y,p;const i=n.getImageStyle((u=(r=t.item)===null||r===void 0?void 0:r.Thumbnail)===null||u===void 0?void 0:u.ThumbnailId,2,n.DSBScenario.NewsAnswer,t.imageHostName,!1,!1,t.isFullWidthDSB),w=n.getAnswerIconStyle((e=(f=t.item)===null||f===void 0?void 0:f.PublisherThumbnail)===null||e===void 0?void 0:e.ThumbnailId,t.imageHostName),b=((o=t.item)===null||o===void 0?void 0:o.Publisher)&&((h=(s=t.item)===null||s===void 0?void 0:s.Publisher)===null||h===void 0?void 0:h.length)>15?((l=(c=t.item)===null||c===void 0?void 0:c.Publisher)===null||l===void 0?void 0:l.slice(0,15))+"...":(a=t.item)===null||a===void 0?void 0:a.Publisher,k=n.getCurrentDateDSB();return React.createElement("div",{id:t.id,key:t.id,className:`${t.megaClassName} focusable`,"data-h":(v=t.item.instrumentedItem)===null||v===void 0?void 0:v.getHValue(),"data-clkurl":t.item.ClickThroughUrl,onClick:i=>{var r;t.item.ClickThroughUrl&&((r=i.persist)===null||r===void 0?void 0:r.call(i),i.stopPropagation(),n.clickDSBHandler(i.nativeEvent,t.item.ClickThroughUrl,t.item.instrumentedItem))},role:"link","aria-label":(y=t.item)===null||y===void 0?void 0:y.Title,tabIndex:-1,"aria-posinset":t.index+1,"aria-setsize":t.itemsLength},React.createElement("div",{className:i?"dsb-news-item-container__content":"dsb-news-item-container__content--noThumbnail"},React.createElement("div",{className:i?"dsb-news-item-container__content__info":"dsb-news-item-container__content__info--noThumbnail"},w&&React.createElement("div",{className:i?"dsb-news-item-container__icon":"dsb-news-item-container__icon--noThumbnail",style:w}),React.createElement("span",{title:(p=t.item)===null||p===void 0?void 0:p.Publisher},b),React.createElement("span",{className:"dsb-news-item-container__dot"}),React.createElement("span",null,n.localizedTimeAgo(t.item.PublishTimestamp,k))),React.createElement("span",{className:i?"dsb-news-item-container__content__title":"dsb-news-item-container__content__title--noThumbnail",title:t.item.Title},t.item.Title)),i&&React.createElement("div",{className:"dsb-news-item-container__img",style:i}))};const e=n=>React.createElement("div",{className:"dsb-mega__publisher"},React.createElement("div",{className:"dsb-mega-publisher__icon"},React.createElement("img",{src:n.PublisherLogo,alt:n.Publisher})),React.createElement("div",{className:"dsb-mega-publisher__name"},n.Publisher));r.MegaVideoItem=t=>{const{scenario:c,className:k,clickEvent:d,instrumentedItem:u,onMouseEnterEvent:g,onMouseLeaveEvent:nt,isFullWidthDSB:f,Title:r,PublisherName:e,ChannelName:l,children:tt,index:o,itemsLength:it,date:a,PublishedDateTime:s,ViewCount:h,LikeCount:i,widthOverride:v,showMetadata:y,imageHostName:rt,sourceIconId:ut}=t,p=f?`$mega_${c}_${o}-full-pane`:`$mega_${c}_${o}${a?"_"+a:""}`,ft=n.getCurrentDateDSB();let et=n.Host.getLocString("Views")+" â€¢";const ot=`${n.formatNumbers(h!==null&&h!==void 0?h:-1,et)} ${n.localizedTimeAgo(s!==null&&s!==void 0?s:-1,ft)}`,st=n.formatNumbers(i!==null&&i!==void 0?i:-1,n.Host.getLocString("LikeCountSuffix")),w=v>0?{width:`${v}px`}:{},b=n.getAnswerIconStyle(ut,rt);return React.createElement("div",{id:p,key:p,className:k,"data-h":u===null||u===void 0?void 0:u.getHValue(),onClick:d,role:"link","aria-label":r,tabIndex:-1,style:w,"aria-posinset":o+1,"aria-setsize":it},React.createElement("div",{onMouseEnter:g,onMouseLeave:nt,className:"dsb-mega-video-item"},tt,!i&&(y||f)&&React.createElement("div",{className:"dsb-mega__image-title-container",style:w},React.createElement("div",{className:"dsb-mega__image-title"},r),React.createElement("div",{className:"dsb-mega__image-details"},ot),React.createElement("div",{className:"dsb-mega__image-source"},e,l?` â€º ${l}`:""))," ",i&&React.createElement("div",{className:"dsb-mega__image-title-containe flat-container"},React.createElement("div",{className:"dsb-mega__image-title meta-title"},r),React.createElement("div",{className:`meta-likes`},b?React.createElement("div",{className:"icon",style:b,"aria-label":e}):`${e} `,st)),!f&&!y&&!i&&React.createElement("div",{className:"dsb-mega__image-title"},r)))};class o extends React.Component{render(){const{id:s,className:u,ariaLabel:h,HValue:c,tooltips:l,clickHandler:a,scenario:v,isTwoCta:y,isVideoArticle:f,momentMetadata:r,index:e,itemsLength:p,isFullWidthDSB:o}=this.props,w="DSB."+v,b=(r===null||r===void 0?void 0:r.IsBirthday)?` birthdayMomentCTA`:"",k=f&&f==="true"?React.createElement(i.PlayVideoIcon,null):null;return React.createElement("div",{id:s,className:`dsb-cta selectable focusable ${y?"dsb-sections-two-ctas":""}`+`${u?" "+u:""}`+b+(n.config.enableSqaureCTA&&!o?" square-cta":"")+(n.config.enableSqaureCTAFullWidth&&o?" square-cta-fw":"")+(n.config.contrastFocusVisible?" contrastFocusVisible":""),tabIndex:-1,"aria-label":h,role:"link",onClick:a,"data-h":c,"data-partnertag":t.whenTestHooks(w),title:l,"aria-posinset":e!==undefined&&e+1||0,"aria-setsize":p},k,this.props.children)}}r.CTAContainer=o;const s=[[],[],[!0,!0],[!1,!1,!1],[!0,!0,!0,!0],[!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1],[!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],];r.CTASections=n=>{const{sections:t}=n,i=s[t.length];return React.createElement(React.Fragment,null,t.map((n,t)=>React.createElement(n.sectionView,Object.assign(Object.assign({},n.props),{isTwoCta:i[t],key:n.props.id+"_"+t}))))};r.CTASectionsCarousel=n=>{const{containerID:t,ctaCarouselComponentProps:u,sections:i,isFullWidthDSB:f}=n;return React.createElement("div",{className:"dsb-cta-carousel",id:t},React.createElement(r.MegaCarouselComponent,Object.assign({},Object.assign(Object.assign({},u),{containerID:t})),i.map((n,t)=>React.createElement(n.sectionView,Object.assign(Object.assign({},n.props),{index:t,itemsLength:i.length,key:n.props.id+"_"+t,isFullWidthDSB:f})))))};r.CTASectionsBlock=n=>{const{containerID:o,ctaCarouselComponentProps:s,sections:t,splitPointIndex:i,isFullWidthDSB:h}=n;let u=t.length;if(i>u)return React.createElement(React.Fragment,null);let f=t.slice(0,i),e=t.slice(i,u);return React.createElement(React.Fragment,null,f&&React.createElement(r.CTASections,{sections:f}),e&&React.createElement(r.CTASectionsCarousel,{containerID:o,ctaCarouselComponentProps:s,sections:e,isFullWidthDSB:h}))}})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{constructor(t){super(t);this.tsBaseUrl=n.config.enableOfflineWithWeb&&n.config.webHost&&n.isBrowserOnline()?n.config.webHost:location.origin}click(t,i,r){let u=`${this.tsBaseUrl}/search?q=${encodeURIComponent(r)}`;n.config.enableSearchHomeSuggToBingChat&&(u+="&showconv=1&sendquery=1");n.Host.launchDSBUriAsync(n.generateBingUrlWithLanguageAndRegion(u),i,t)}maxSuggestions(t){if(this.canvas=this.canvas||document.createElement("canvas"),this.props.isFullWidthDSB)return 7;let i;return(i=n.config.useCobaltCSS?n.numberOfItemsToDisplay(t.map(n=>n.Title),5,this.canvas,{extraWidthPerItem:36,lineWidth:390}):n.numberOfItemsToDisplay(t.map(n=>n.Title),5,this.canvas,{extraWidthPerItem:33,lineWidth:368,font:`normal 13px "Segoe UI"`}),n.config.trendingSearchEvenItems&&i%2==1)?i-1:n.config.trendingSearch10Items&&t.length>=10?10:i}imgSyle(t){return{backgroundImage:`url(${n.generateBingThumbnailUrlFromIdByScenario(t,{dsbSection:2,dsbScenario:n.DSBScenario.TrendingSearch,isWindows11:n.config.useCobaltCSS},this.props.imageHostName)})`}}render(){var u,f;const{FieldsStore:i,id:h,imageHostName:a,date:e,isFullWidthDSB:c,instrumentedItem:v}=this.props;var r="",o="",s=!1;i.Scenario=="RelatedSearch"&&(s=!0);this.props.isFullWidthDSB&&(r=n.config.enableLBSHSolidBlueIcon?"SolidBlueIconV2_MRU":n.config.enableLBSHGradientIcon?"GradientIconV2_MRU":"SearchIconV2_MRU",o=r);let l;i.ClickThroughUrl&&n.config.expandMegaClickTarget&&(l=i.ClickThroughUrl+n.Host.getLocString("TrendingOnBing"));const y=this.props.isFullWidthDSB?"":"two-column-ts",p=this.props.isFullWidthDSB?"":"icon-pill",w=n.config.contrastFocusVisible?"contrastFocusVisible":"",b=React.createElement("ul",null,(u=i.Items)===null||u===void 0?void 0:u.slice(0,this.maxSuggestions(i.Items)).map(i=>{var f;let u=i.Title,s=`${h}_${u}${e?"_"+e:""}${c?"_full_width":""}`;return React.createElement("li",{className:(this.props.isFullWidthDSB?"mru-trending selectable focusable":"mru-trending focusable")+` ${y}`+` ${w}`,"data-h":(f=i.instrumentedItem)===null||f===void 0?void 0:f.getHValue(),id:s,key:s,onClick:n=>this.click(n.nativeEvent,i.instrumentedItem,u),title:u,tabIndex:-1},r&&o&&React.createElement("span",{className:"icon-padding"},React.createElement("div",{className:"icon"},React.createElement(t.DynamicIcons,{id:r,Icon:o}))),!this.props.isFullWidthDSB&&n.config.trendingSearchIcon&&React.createElement("img",{className:"dsb-trending-search__thumbnail",src:n.generateBingThumbnailUrlFromIdByScenario(n.config.trendingSearchIcon,{dsbSection:2,dsbScenario:n.DSBScenario.TrendingSearch},this.props.imageHostName)}),React.createElement("span",{className:"truncate-text"},u))}));return React.createElement(t.MegaContent,{containerClassName:"dsb-trending focusable"+` ${p}`,children:b,FieldsStore:Object.assign(Object.assign({},i),{ClickThroughUrl:l}),instrumentedItem:v,headerClassName:"dsb-trending__header",id:(f=`${h}${c?"_full_width":""}`+e)!==null&&f!==void 0?f:"current",imageHostName:a,scenario:i===null||i===void 0?void 0:i.Scenario,iconId:s?"RelatedSearchesIcon":"TrendingIcon",iconName:s?"RelatedSearchesIcon":"TrendingIcon"})}}t.TrendingSearchItems=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(i){class r extends React.Component{render(){var e,o;const{FieldsStore:r,id:f,imageHostName:s,instrumentedItem:h,Scenario:c,isFullWidthDSB:u,onDismissHandler:l,showDismissIcon:a}=this.props,v=n.getImageStyle((e=r===null||r===void 0?void 0:r.Thumbnail)===null||e===void 0?void 0:e.ThumbnailId,0,null,s,!1,!0,u);return React.createElement(i.HeroContainer,{cardAriaLabel:r.Title,clickThroughUrl:r.ClickThroughUrl,cropNeeded:!0,id:`${f}${u?"_full_width":""}`,key:`${f}${u?"_full_width":""}`,imageUrl:v,imageHostName:s,instrumentedItem:h,scenario:c,tagCard:!1,wholePageTabsData:r.WholePageTabs,IsVideoArticle:r.IsVideoArticle,onDismissHandler:l,showDismissIcon:a,isFullText:r.HeroDescription?!0:!1,isFullWidthDSB:u},React.createElement("div",{className:"simple-card"},React.createElement("div",{className:"simple-card__title"},React.createElement("div",{className:"title-text"},r.Title),(n.config.enableHero170&&!u||n.config.enableHero190&&!u||n.config.enableHero190FullWidth&&u)&&React.createElement(t.RightChevronIcon,null)),!(n.config.enableHero170&&!u||n.config.enableHero190&&!u||n.config.enableHero190FullWidth&&u)&&((o=r.OverlayButtons)===null||o===void 0?void 0:o.slice().map(t=>{var r,e;let h=t.CaptionResourceKey?n.getBtnTitle(t.CaptionResourceKey):t.Title;const o=`${f}_${(e=(r=t===null||t===void 0?void 0:t.Title)===null||r===void 0?void 0:r.replace(" ",""))!==null&&e!==void 0?e:t===null||t===void 0?void 0:t.CaptionResourceKey}${u?"_full_width":""}`,c={btnId:o,key:o,btnTitle:h,btnClickThroughUrl:t===null||t===void 0?void 0:t.ClickThroughUrl,btnInstrumentedItem:t===null||t===void 0?void 0:t.instrumentedItem,btnClassName:"dsb-hero__overlay-button dsb-hero-overlay-active focusable selectable",heroOverlay:!0,imageHostName:s,thumbnail:t.Thumbnail};return React.createElement(i.DSBLinkButton,Object.assign({},c))})),(r===null||r===void 0?void 0:r.HeroDescription)&&React.createElement(i.HeroDescription,Object.assign({},r===null||r===void 0?void 0:r.HeroDescription,{id:`$hero_desctiption_${f}`}))))}}i.SimpleCard=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(i){class r extends React.Component{render(){var u;const{FieldsStore:r,id:f,imageHostName:e,instrumentedItem:c,Scenario:l,isFullWidthDSB:o,onDismissHandler:a,showDismissIcon:v}=this.props,y=n.getImageStyle((u=r===null||r===void 0?void 0:r.Thumbnail)===null||u===void 0?void 0:u.ThumbnailId,0,null,e,!1,!1,o);let s;s=r.CaptionResourceKey?n.Host.getLocString(r.CaptionResourceKey):r.Caption;const h=(r===null||r===void 0?void 0:r.UXTemplateName)=="MegaBubble"?24:20,p=n.generateBingThumbnailUrlFromId("ODSWG."+(r===null||r===void 0?void 0:r.Icon),e,h,h);return React.createElement(i.HeroContainer,{cardAriaLabel:r.Title,clickThroughUrl:r.ClickThroughUrl,cropNeeded:!1,id:`${f}${o?"_full_width":""}`,imageUrl:y,imageHostName:e,instrumentedItem:c,scenario:l,tagCard:!0,wholePageTabsData:null,IsVideoArticle:r.IsVideoArticle,onDismissHandler:a,showDismissIcon:v,isFullText:r.HeroDescription?!0:!1,isFullWidthDSB:o},React.createElement("div",{className:"tagged-card"},React.createElement("div",{className:"tagged-card__tag"},React.createElement("div",{className:"tagged-card__icon"},React.createElement("img",{src:p,id:f})),React.createElement("div",{className:"tagged-card__text"},s)),React.createElement("div",{className:"tagged-card__title-container"},React.createElement("div",{className:"tagged-card__title"},r.Title),React.createElement(t.RightChevronIcon,null)),(r===null||r===void 0?void 0:r.HeroDescription)&&React.createElement(i.HeroDescription,Object.assign({},r===null||r===void 0?void 0:r.HeroDescription,{id:`$hero_desctiption_${f}`}))))}}i.TaggedCard=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(i){class r extends React.Component{render(){var o,s;const{FieldsStore:r,id:f,imageHostName:e,instrumentedItem:c,Scenario:l,isFullWidthDSB:u,onDismissHandler:a,showDismissIcon:v}=this.props,y=n.getImageStyle((o=r===null||r===void 0?void 0:r.Thumbnail)===null||o===void 0?void 0:o.ThumbnailId,0,null,e,!1,!1,u),h=16,p=n.generateBingThumbnailUrlFromId("ODSWG.IotdLocalIcon",e,h,h);return React.createElement(i.HeroContainer,{cardAriaLabel:r.Title,clickThroughUrl:r.ClickThroughUrl,cropNeeded:!1,id:`${f}${u?"_full_width":""}`,imageUrl:y,imageHostName:e,instrumentedItem:c,scenario:l,tagCard:!1,wholePageTabsData:r.WholePageTabs,IsVideoArticle:r.IsVideoArticle,onDismissHandler:a,showDismissIcon:v,isFullText:r.HeroDescription?!0:!1,isFullWidthDSB:u},React.createElement("div",{className:"descriptive-hover-card"},React.createElement("div",{className:"descriptive-hover-card__title-caption-content"},React.createElement("div",{className:"descriptive-hover-card__title-content"},r.Title&&React.createElement("div",{className:"descriptive-hover-card__title-text"},r.Title),React.createElement("div",{className:"descriptive-hover-card__title-copyright"},r.Copyright)),React.createElement("div",{className:"descriptive-hover-card__caption focusable selectable"},React.createElement("div",{className:"descriptive-hover-card__caption-icon"},React.createElement("img",{src:p,id:f})),React.createElement("div",{className:"descriptive-hover-card__caption-text"},r.Caption))),!(n.config.enableHero170&&!u||n.config.enableHero190&&!u||n.config.enableHero190FullWidth&&u)&&((s=r.OverlayButtons)===null||s===void 0?void 0:s.slice().map((t,r)=>{let o;o=t.CaptionResourceKey?n.getBtnTitle(t.CaptionResourceKey):t.Title;const s=`${f}_${r}_${o}${u?"_full_width":""}`,h={btnId:s,key:s,btnTitle:o,btnClickThroughUrl:t===null||t===void 0?void 0:t.ClickThroughUrl,btnInstrumentedItem:t===null||t===void 0?void 0:t.instrumentedItem,btnClassName:"dsb-hero__overlay-button dsb-hero-overlay-active focusable selectable",heroOverlay:!0,imageHostName:e,thumbnail:t.Thumbnail};return React.createElement(i.DSBLinkButton,Object.assign({},h))})),(r===null||r===void 0?void 0:r.HeroDescription)&&React.createElement(i.HeroDescription,Object.assign({},r===null||r===void 0?void 0:r.HeroDescription,{id:`$heroDesctiption_${f}`}))),React.createElement("div",{className:"descriptive-hover-card__bing-logo",style:(r===null||r===void 0?void 0:r.HeroDescription)&&{display:"none"}},React.createElement(t.BingLogo,null)))}}i.DescriptiveHoverCard=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(i){function r(n){return n&&n.length>0}function u(t){return r(t)&&!n.config.useCobaltCSS?"wholepagetabs__container":""}i.hasWholePageTabs=r;i.getWholePageTabsClassName=u;class f extends React.Component{hasThumbnail(){return!!this.props.Items.find(n=>!!n.ThumbnailId)}maxSuggestions(){var t;return this.canvas=this.canvas=this.canvas||document.createElement("canvas"),n.numberOfItemsToDisplay((t=this.props)===null||t===void 0?void 0:t.Items.map(n=>{var t;return(t=n.TabName)!==null&&t!==void 0?t:n.Title}),1,this.canvas,{extraWidthPerItem:34,lineWidth:368-(this.hasThumbnail()?15:0)})}getThumbnailUrl(n){return`${this.props.imageHostName}/th?id=${n}`}render(){const{id:i,Items:r}=this.props;return React.createElement("div",{id:i,className:"dsb-wholepagetabs focusable","data-region":"WholePageTabs","data-partnertag":t.whenTestHooks("DSB.WholePageTabs")},React.createElement("ul",null,r.slice(0,this.maxSuggestions()).map(t=>{var r,u,f,e,o;let s=`${i}_${(r=t.TabName)!==null&&r!==void 0?r:t.Title}`;return React.createElement("li",{id:s,key:s,className:"dsb-wholepagetabs__suggestion selectable focusable",tabIndex:-1,"aria-label":(u=t.TabName)!==null&&u!==void 0?u:t.Title,role:"link",onClick:i=>{i.stopPropagation(),n.clickDSBHandler(i.nativeEvent,t.ClickThroughUrl,t.instrumentedItem)},"data-h":(f=t.instrumentedItem)===null||f===void 0?void 0:f.getHValue()},t.ThumbnailId&&t.ThumbnailId.length>0&&React.createElement("div",{className:"dsb-wholepagetabs__thumbnail"},React.createElement("img",{src:this.getThumbnailUrl(t.ThumbnailId)})),((e=t.TabName)!==null&&e!==void 0?e:t.Title)&&React.createElement("div",{className:"dsb-wholepagetabs__tabname"},(o=t.TabName)!==null&&o!==void 0?o:t.Title))})))}}i.WholePageTabs=f})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(i){i.BirthdayCard=({FieldsStore:r,id:f,imageHostName:e,instrumentedItem:o,Scenario:u,user:s})=>{var l,a,v;const[h,y]=React.useState(null),p=React.useCallback(async()=>{const t=n.getAccessTokenManager(),{accountUserName:u}=(t===null||t===void 0?void 0:t.getSelectedAccountInfo())||{},i=await(t===null||t===void 0?void 0:t.getAccountByUserNamePromise(!1,0,u,!1,!0));let r={};(i===null||i===void 0?void 0:i.Token)&&(r=await n.MsRewardsApi.getUserInfoAsyncPromise(i.Token));y({user:i,rewards:r})},[]),w=React.useCallback(async t=>{var i,r,u,f;if(n.config.DSBBirthdayCardCampaignId&&((i=h.user)===null||i===void 0?void 0:i.Token)){const e={Creative:"ML25SG",Program:"DSB",PartnerId:"BingRewards",Publisher:"RewardsDO"};((r=h.rewards)===null||r===void 0?void 0:r.RewardsUser)||await n.MsRewardsApi.createUserAsyncPromise((u=h.user)===null||u===void 0?void 0:u.Token,e);await n.MsRewardsApi.reportActivityAsyncPromise((f=h.user)===null||f===void 0?void 0:f.Token,Object.assign({ActivityType:11,OfferId:n.config.DSBBirthdayCardCampaignId},e));t()}},[h]);React.useLayoutEffect(()=>{p()},[]);const b=r.Title,k=`${e}/th?id=${(l=r===null||r===void 0?void 0:r.Thumbnail)===null||l===void 0?void 0:l.ThumbnailId}`,c=r.WholePageTabs,d="DSB."+u;return React.createElement("div",{id:f,className:"dsb-hero dsb-birthday-card-hero"+`${" dsb-hero--cropped"}`,tabIndex:-1,role:"link","aria-label":b,"data-partnertag":t.whenTestHooks(d),"data-h":o.getHValue()},React.createElement("div",{className:`dsb-hero__img-container ${i.getWholePageTabsClassName(c===null||c===void 0?void 0:c.Items)}`},React.createElement("div",{className:"dsb-hero__img"+`${""}`,style:{backgroundImage:`url("${k}")`}})),React.createElement("div",{id:`${f}_card`,className:`dsb-hero__content-container ${i.getWholePageTabsClassName(c===null||c===void 0?void 0:c.Items)}`},React.createElement("div",{className:"simple-card"},React.createElement("div",{className:"simple-card__title"},React.createElement("div",{className:"simple-card__inner-title"},(s===null||s===void 0?void 0:s.FirstName)?n.Host.getLocString("BirthdayCardTitle",s.FirstName):n.Host.getLocString("BirthdayCardGenericTitle"))),React.createElement("div",{className:"simple-card__button"},React.createElement(i.DSBLinkButton,{btnId:"birthday-card-hero-claim-button",key:"birthday-card-hero-claim-button",btnTitle:n.Host.getLocString("BirthdayCardButtonText"),btnClassName:`dsb-hero__overlay-button birthday-card-hero-claim-button focusable selectable ${h?"reveal-hero-button":""}`,btnInstrumentedItem:o,clickHandler:w,btnClickThroughUrl:n.config.DSBBirthdayCardRedirectUrl,heroOverlay:!0}))),React.createElement("div",{className:`birthday-card-footer ${((a=h===null||h===void 0?void 0:h.rewards)===null||a===void 0?void 0:a.RewardsUser)?"is-rewards-user":""}`},h&&React.createElement("div",{className:"birthday-card-footer-contents"},!((v=h.rewards)===null||v===void 0?void 0:v.RewardsUser)&&React.createElement("span",{className:"birthday-footer-legal-disclaimer"},n.Host.getLocString("BirthdayCardDisclaimer"))," ",React.createElement("span",{className:`birthday-footer-legal-links ${n.config.DSBBirthdayCardDismissUrl?"":"hidden-separator"}`},React.createElement("a",{href:n.config.DSBMsftTermsUrl,target:"_blank"},n.Host.getLocString("BirthdayCardTerms")),React.createElement("a",{href:n.config.DSBMsftPrivacyUrl,target:"_blank"},n.Host.getLocString("BirthdayCardPrivacy"))),n.config.DSBBirthdayCardDismissUrl&&React.createElement("a",{href:n.config.DSBBirthdayCardDismissUrl,target:"_blank"},n.Host.getLocString("BirthdayCardDismiss"))))))}})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(i){const u=(t,i,r)=>{const f=0,e=i-r;t>e&&(t=e);t<f&&(t=f);let u=-100*t/i;return n.isRtl()&&(u=-1*u),`translate3d(${u}%, 0, 0)`},f=(n,t,i,r,u)=>n<t-(r?1:i)?n+(r?1:i):u?0:n,e=(n,t,i,r,u)=>n>0?n-(r?1:i):u?t-(r?1:i):n,o=(n,t)=>{n=n<1?1:n;t=t<1?1:t;const i=n/t;return`${i*100}%`},s=n=>{n=n<1?1:n;const t=1/n;return`${t*100}%`},h=(n,t,i,r)=>{let u=Math.floor(t/r),f=Math.floor(i/r);u!==f&&n(u,f)},c=n=>{const{message:t}=n;return React.createElement("div",{className:"dsb-carousel__aria-message","aria-live":"polite","aria-atomic":"true"},t)},l=i=>React.createElement("button",{className:"dsb-carousel__button",style:{visibility:i.disable?"hidden":"visible",right:n.isRtl()&&n.config.rtlMegaBtn?"0":{}},disabled:i.disable,onClick:n=>{var t;(t=n.persist)===null||t===void 0?void 0:t.call(n);n.stopPropagation();n.preventDefault();i.prevTile(!1)},"aria-label":"previous",type:"button"},n.config.useCobaltCSS?n.isRtl()?React.createElement("svg",{width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M0 7.00781L0 0.992188C0 0.854167 0.0260417 0.72526 0.078125 0.605469C0.132812 0.485677 0.204427 0.38151 0.292969 0.292969C0.384115 0.201823 0.489583 0.130208 0.609375 0.078125C0.731771 0.0260417 0.861979 0 1 0C1.20573 0 1.39583 0.0598958 1.57031 0.179688L5.35547 2.78125C5.55859 2.92188 5.71615 3.09896 5.82812 3.3125C5.94271 3.52604 6 3.75521 6 4C6 4.24479 5.94271 4.47396 5.82812 4.6875C5.71615 4.90104 5.55859 5.07812 5.35547 5.21875L1.57031 7.82031C1.39583 7.9401 1.20573 8 1 8C0.861979 8 0.731771 7.97396 0.609375 7.92188C0.489583 7.86979 0.384115 7.79948 0.292969 7.71094C0.204427 7.61979 0.132812 7.51432 0.078125 7.39453C0.0260417 7.27474 0 7.14583 0 7.00781Z"})):React.createElement("svg",{width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M0 4C0 3.75521 0.0572917 3.52604 0.171875 3.3125C0.286458 3.09635 0.44401 2.91927 0.644531 2.78125L4.42969 0.179687C4.51823 0.119792 4.60807 0.0755208 4.69922 0.046875C4.79036 0.015625 4.89062 0 5 0C5.13542 0 5.26432 0.0260417 5.38672 0.078125C5.50911 0.130208 5.61458 0.201823 5.70312 0.292969C5.79427 0.38151 5.86589 0.485677 5.91797 0.605469C5.97266 0.72526 6 0.854167 6 0.992187L6 7.00781C6 7.14583 5.97266 7.27474 5.91797 7.39453C5.86589 7.51432 5.79427 7.61979 5.70313 7.71094C5.61458 7.79948 5.50911 7.86979 5.38672 7.92187C5.26432 7.97396 5.13542 8 5 8C4.79427 8 4.60417 7.9401 4.42969 7.82031L0.644531 5.21875C0.44401 5.08073 0.286458 4.90495 0.171875 4.69141C0.0572917 4.47526 0 4.24479 0 4Z"})):React.createElement("div",{className:"dsb-carousel__prev-arrow","data-partnertag":t.whenTestHooks("AutoSuggest.CarouselPrevBtn")})),a=i=>React.createElement("button",{className:"dsb-carousel__button",style:{visibility:i.disable?"hidden":"visible",left:n.isRtl()&&n.config.rtlMegaBtn?"0":{}},disabled:i.disable,onClick:n=>{var t;(t=n.persist)===null||t===void 0?void 0:t.call(n);n.stopPropagation();n.preventDefault();i.nextTile(!1)},"aria-label":"next",type:"button"},n.config.useCobaltCSS?n.isRtl()?React.createElement("svg",{width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M0 4C0 3.75521 0.0572917 3.52604 0.171875 3.3125C0.286458 3.09635 0.44401 2.91927 0.644531 2.78125L4.42969 0.179687C4.51823 0.119792 4.60807 0.0755208 4.69922 0.046875C4.79036 0.015625 4.89062 0 5 0C5.13542 0 5.26432 0.0260417 5.38672 0.078125C5.50911 0.130208 5.61458 0.201823 5.70312 0.292969C5.79427 0.38151 5.86589 0.485677 5.91797 0.605469C5.97266 0.72526 6 0.854167 6 0.992187L6 7.00781C6 7.14583 5.97266 7.27474 5.91797 7.39453C5.86589 7.51432 5.79427 7.61979 5.70313 7.71094C5.61458 7.79948 5.50911 7.86979 5.38672 7.92187C5.26432 7.97396 5.13542 8 5 8C4.79427 8 4.60417 7.9401 4.42969 7.82031L0.644531 5.21875C0.44401 5.08073 0.286458 4.90495 0.171875 4.69141C0.0572917 4.47526 0 4.24479 0 4Z"})):React.createElement("svg",{width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M0 7.00781L0 0.992188C0 0.854167 0.0260417 0.72526 0.078125 0.605469C0.132812 0.485677 0.204427 0.38151 0.292969 0.292969C0.384115 0.201823 0.489583 0.130208 0.609375 0.078125C0.731771 0.0260417 0.861979 0 1 0C1.20573 0 1.39583 0.0598958 1.57031 0.179688L5.35547 2.78125C5.55859 2.92188 5.71615 3.09896 5.82812 3.3125C5.94271 3.52604 6 3.75521 6 4C6 4.24479 5.94271 4.47396 5.82812 4.6875C5.71615 4.90104 5.55859 5.07812 5.35547 5.21875L1.57031 7.82031C1.39583 7.9401 1.20573 8 1 8C0.861979 8 0.731771 7.97396 0.609375 7.92188C0.489583 7.86979 0.384115 7.79948 0.292969 7.71094C0.204427 7.61979 0.132812 7.51432 0.078125 7.39453C0.0260417 7.27474 0 7.14583 0 7.00781Z"})):React.createElement("div",{className:"dsb-carousel__next-arrow","data-partnertag":t.whenTestHooks("AutoSuggest.CarouselNextBtn")})),v=n=>React.createElement("div",{className:"dsb-carousel__controls-container"},React.createElement(l,Object.assign({},n.prevButtonProps)),React.createElement(a,Object.assign({},n.nextButtonProps)));let r;(function(n){n[n.Enter=13]="Enter";n[n.LeftArrow=37]="LeftArrow";n[n.Tab=9]="Tab";n[n.UpArrow=38]="UpArrow";n[n.RightArrow=39]="RightArrow";n[n.DownArrow=40]="DownArrow"})(r||(r={}));const y=t=>{const{children:u,totalCount:f,tileSpacing:r,showCurrentTileStyle:e,noPadding:o}=t,h=s(f),c=e?"dsb-carousel__tile-current":undefined,i=r?r/2:0,l={position:"relative",width:h,padding:`0 ${o?0:i}px`},a=n.config.useCobaltCSS?"8px":"6px",v={position:"absolute",pointerEvents:"none",top:"0",bottom:"0",left:`${i}px`,right:`${i}px`,zIndex:"1",borderRadius:a};return React.createElement("div",{style:l},React.createElement("div",{className:c,style:v}),u)},p=(n,t,i,r,u)=>{const f=React.Children.count(n),e=React.Children.map(n,(n,e)=>{const o=t&&e==i,s={tileSpacing:r,totalCount:f,showCurrentTileStyle:o,noPadding:u};return React.createElement(y,Object.assign({},s),n)});return React.createElement(React.Fragment,null,e)};i.MegaCarouselComponent=i=>{const dt=i,{children:w,dsbScenario:rt,tilesToShow:a,tileSpacing:y,initIdx:ut,tileConfirmCallback:ft,showAriaMessage:gt,verticalSpacing:g,TileListWidth:et,containerID:b,moveSlides:ot,supportLRNav:ni,supportWraparound:lt,instrumentDirection:ti,textSize:ii,pageChangedCallback:at,noPaddingCarousel:ri}=dt,[s,nt]=React.useState(ut),[vt,yt]=React.useState(!1),[st,ui]=React.useState(0),[ht,fi]=React.useState(0),l=React.Children.count(w),tt=React.useCallback((t,i)=>{if(t!=s){ti?n.InstrumentationHelper.instrumentDSBChevronDirection(rt,i):n.InstrumentationHelper.instrumentDSBChevronSelect(rt);const r=s,u=t;nt(t);at?h(at,r,u,ot):undefined}},[s,nt]),k=React.useCallback(n=>{const t=f(s,l,ot,n,lt);tt(t,"next")},[s,l,tt]),d=React.useCallback(n=>{const t=e(s===l-a+1?s-1:s,l,ot,n,lt);tt(t,"prev")},[s,l,tt,a]),ei={nextTile:k,prevTile:d,disable:s<1},oi={nextTile:k,prevTile:d,disable:s>l-a-(a%1==0?1:0)},si={prevButtonProps:ei,nextButtonProps:oi},pt=React.useMemo(()=>o(l,a,y),[l,a,y,ii]),wt=React.useMemo(()=>u(s,l,a),[s,l,a]),hi=React.useMemo(()=>({width:et!==null&&et!==void 0?et:pt,display:"flex",transition:"500ms ease 0s",transform:wt}),[pt,wt]),ci=React.useMemo(()=>{var n;const i=React.Children.toArray(w);let t=`tile ${s} of ${l} tiles`;if(i[s]){const u=i[s],r=(n=u.props)===null||n===void 0?void 0:n.title;t=r?r:t}return t},[s,w,l]),it=React.useRef(!1),ct=React.useCallback(t=>{if(it.current&&t.keyCode){const i=t.keyCode;if(!ni&&n.isLeftOrRightKey(i))return;switch(i){case r.LeftArrow:case r.UpArrow:n.isRtl()?k(!0):d(!0);break;case r.RightArrow:case r.DownArrow:n.isRtl()?d(!0):k(!0);break;case r.Tab:nt(ut);break;case r.Enter:ft?ft(t,s):undefined}}},[k,d,ft]);React.useEffect(()=>{var n;return it.current=!0,b&&((n=_ge(`${b}_carousel`))===null||n===void 0?void 0:n.addEventListener("keydown",ct,!1)),()=>{var n;b&&((n=_ge(`${b}_carousel`))===null||n===void 0?void 0:n.removeEventListener("keydown",ct,!1))}},[ct]);React.useEffect(()=>{n.Host.bindDismissed(()=>ui(n.getCurrentTime())),n.Host.bindShown(()=>fi(n.getCurrentTime()))},[]);React.useEffect(()=>{st&&ht&&(ht-st)/1e3>n.DSB_RESET_SECONDS&&nt(ut)},[st,ht]);const li=React.useMemo(()=>p(w,vt,s,y,ri),[w,vt,s,y]);var bt=React.useMemo(()=>`${y?y/-2:0}px`,[y]),kt=bt;return rt==="NewsTrendingTopics"&&(kt="0px"),React.createElement("div",{className:t.classNames("carousel-container",{contrastFocusVisible:n.config.contrastFocusVisible}),style:{position:"relative"}},gt&&React.createElement(c,{message:ci}),React.createElement("div",{className:"dsb-carousel__focus group_focusable",id:"dsb-carousel__focus"+Math.random().toString(16).substring(2),onFocus:()=>{it.current=!0,yt(!0)},onBlur:()=>{it.current=!1,yt(!1)}}),React.createElement(v,Object.assign({},si)),React.createElement("div",{className:"carousel-frame",id:`${b}_carousel`,style:{overflow:"hidden",outline:"none",marginLeft:bt,marginRight:kt,paddingTop:g?g:"0px",paddingBottom:g?g:"0px"}},React.createElement("div",{className:"tiles-list",style:hi},li)))};const w={dsbScenario:"UnKnown",tilesToShow:1,tileSpacing:0,initIdx:0,showAriaMessage:!0,tileConfirmCallback:()=>{},moveSlides:1,children:React.createElement(React.Fragment,null)};i.MegaCarouselComponent.defaultProps=w;i.MegaCarouselPagination=t=>{const{paginationItems:i,imageHostName:r}=t,u=i===null||i===void 0?void 0:i.map((t,i)=>{const f=t.isCompleted?"dsb-carousel-pagination__bubble completed":t.isActive?"dsb-carousel-pagination__bubble active":"dsb-carousel-pagination__bubble",e=t.isCompleted?"ODSWG.CarouselPaginationBubbleCompleted":"ODSWG.CarouselPaginationBubble",u=n.generateBingThumbnailUrlFromId(e,r,16,16),o={WebkitMaskImage:`url(${u})`,maskImage:`url(${u})`};return React.createElement("div",{id:`pagination_item_${i}`,key:`pagination_item_${i}`,className:f,style:o})});return React.createElement("div",{className:"dsb-carousel-pagination"},u)}})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(i){class r extends React.Component{click(t,i,r){n.Host.launchDSBUriAsync(i,r,t)}render(){const{id:e,FieldsStore:r,Scenario:f,instrumentedItem:h}=this.props;if(!r)return React.createElement(React.Fragment,null);const{CaptionResourceKey:o,Title:c,SeeMoreUrl:l,Items:a}=r,s=o?n.Host.getLocString(o):c,u=a;if(!u||u.length<3||!l)return React.createElement(React.Fragment,null);const v=(n,i,r)=>{const u=n&&i;return React.createElement("div",{className:t.classNames("dsb-carousel-slide__content",!u&&"dsb-carousel-slide__content--newsTrendingTopics")},u&&React.createElement("div",{className:"dsb-carousel-slide__publisher"},React.createElement("div",{className:"dsb-carousel-slide-publisher__icon"},React.createElement("img",{src:n,alt:i,style:{width:"100%",height:"100%"}})),React.createElement("div",{className:"dsb-carousel-slide-publisher__name"},i)),React.createElement("div",{className:t.classNames("dsb-carousel-slide__title",!u&&"dsb-carousel-slide__title--newsTrendingTopics")},r))},y=t=>{const u={dsbSection:1,isWindows11:n.config.useCobaltCSS},{width:i,height:r}=n.generateThumbnailDimension(u),f=i?i+1:135,e=r?r:124;return`${t}?w=${f}&h=${e}&m=5`},p=t=>`url('${n.generateBingThumbnailUrlFromIdByScenario(t,{dsbSection:1,dsbScenario:n.DSBScenario.NewsTrendingTopics,isWindows11:n.config.useCobaltCSS,isTwoCta:this.props.isTwoCta,isFullWidthDSB:this.props.isFullWidthDSB},this.props.imageHostName)}')`,w=u.slice(0,u.length).map((i,r)=>{var u,f;const e=i.PublisherLogo&&i.Publisher,o={backgroundImage:e?`url(${y(i.Thumbnail.ThumbnailUrl)})`:p((u=i===null||i===void 0?void 0:i.Thumbnail)===null||u===void 0?void 0:u.ThumbnailId),width:"100%"};return React.createElement("div",{key:r,id:`dsb-carousel__tile-${r}`,className:t.classNames("dsb-carousel__slide",!e&&"dsb-carousel__slide--newsTrendingTopics"),style:n.config.useCobaltCSS?{width:"100%"}:o,title:i.Title,"aria-label":i.Title,role:"link","data-h":(f=i.instrumentedItem)===null||f===void 0?void 0:f.getHValue(),onClick:n=>this.click(n.nativeEvent,i.ClickThroughUrl,i.instrumentedItem),"data-partnertag":t.whenTestHooks("AutoSuggest.slideNewsTrendingTopics")},n.config.useCobaltCSS&&React.createElement("div",{className:"dsb-carousel-slide__win11",style:o}),v(i.PublisherLogo,i.Publisher,i.Title))}),b=(n,t)=>{t<0||t>=u.length||this.click(n,u[t].ClickThroughUrl,u[t].instrumentedItem)},k={dsbScenario:f,tilesToShow:3,tileSpacing:10,tileConfirmCallback:b};return React.createElement("div",{id:e,className:t.classNames("dsb-carousel",f==="NewsTrendingTopics"&&"dsb-carousel--newsTrendingTopics"),"aria-label":s,"data-h":h.getHValue(),"data-region":f,"data-partnertag":t.whenTestHooks(`DSB.${f}`),role:"region"},React.createElement("div",{className:"dsb-carousel__header"},(r===null||r===void 0?void 0:r.Icon)&&React.createElement(i.DynamicIcons,{id:`${e}_newsTrendingTopics`,Icon:r===null||r===void 0?void 0:r.Icon}),React.createElement("div",{className:t.classNames("dsb-carousel__title",(r===null||r===void 0?void 0:r.Icon)&&"dsb-carousel__title__newsTrendingTopics")},s)),React.createElement("div",{className:"dsb-carousel__body"},React.createElement(i.MegaCarouselComponent,Object.assign({},k),w)))}}i.MegaCarousel=r})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){let i;(function(n){n[n.Left=0]="Left";n[n.Right=1]="Right"})(i=t.FullWidthContainerSide||(t.FullWidthContainerSide={}));t.DSBFullWidthContainer=({moment:r,side:u})=>{function o(){l(n.RuntimeConfiguration.TextScaleFactor)}function a(n){var t;const i={};return(t=n===null||n===void 0?void 0:n.sectionGroups)===null||t===void 0?void 0:t.forEach(n=>{var t,r,u;if(n.cardType){let f=(t=n.placement)===null||t===void 0?void 0:t.UXOrder;i[n.id]={position:(u=(r=n.placement)===null||r===void 0?void 0:r.Position)===null||u===void 0?void 0:u.toLowerCase(),order:f}}}),i}var f;const[c,l]=React.useState(n.RuntimeConfiguration.TextScaleFactor);React.useEffect(()=>(window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}),[]);const e=a(r);let s=[],h=[];return(f=r===null||r===void 0?void 0:r.sectionGroups)===null||f===void 0?void 0:f.sort((n,t)=>e[n.id].order-e[t.id].order).forEach(n=>{var t;((t=n.placement)===null||t===void 0?void 0:t.Position)==="Left"?s.push(n):h.push(n)}),u==i.Left?React.createElement("div",{className:"dsb-sections"},s.map(n=>{let i=n.sections[0];return i.props.isFullWidthDSB=!0,i.props.textSize=c,n.cardType==="CallToAction"?React.createElement(t.ErrorBoundary,{key:n.id,fromArea:`DSBV2-${n.cardType}`,data:n},React.createElement(t.CTACarousel,{key:`CTAV2Carousel-${n.id}`,sections:n.sections,isFullWidthDSB:!0})):(i.props.onLeft=e[n.id].position=="left",i&&React.createElement(t.ErrorBoundary,{key:n.id,fromArea:`DSBV2-${n.cardType}`,data:n},React.createElement(i.sectionView,Object.assign(Object.assign({},i.props),{key:i.props.id}))))})):React.createElement(React.Fragment,null,h.map(n=>{let i=n.sections[0];return i.props.isFullWidthDSB=!0,i&&React.createElement(t.ErrorBoundary,{key:n.id,fromArea:`DSBV2-${n.cardType}`,data:n},React.createElement(i.sectionView,Object.assign(Object.assign({},i.props),{key:i.props.id})))}))}})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){var r;const i={dsbScenario:"CallToAction",tilesToShow:3,showAriaMessage:!1,tileSpacing:12,verticalSpacing:"1px",moveSlides:3},u=(r=n.config.maxCtaCardCount)!==null&&r!==void 0?r:14;class f extends React.Component{render(){var o;const{sections:r,isFullWidthDSB:f,isPastMoment:h,date:s}=this.props,c=r.length===2;let e=f?"dsb-cta-carousel-full-pane":`dsb-cta-carousel${s?"_"+s:""}`;if(h){let n=r.length;return n>u?React.createElement(t.CTASectionsBlock,{containerID:e,ctaCarouselComponentProps:i,sections:r,splitPointIndex:12,isFullWidthDSB:f}):n===4?React.createElement(t.CTASectionsCarousel,{containerID:e,ctaCarouselComponentProps:i,sections:r,isFullWidthDSB:f}):n%3==1?React.createElement(t.CTASectionsBlock,{containerID:e,ctaCarouselComponentProps:i,sections:r,splitPointIndex:n-4,isFullWidthDSB:f}):r&&React.createElement(t.CTASections,{sections:r})}return n.config.enable2LineCTA?r.length<5?React.createElement(t.CTASectionsCarousel,{containerID:e,ctaCarouselComponentProps:i,sections:r,isFullWidthDSB:f}):r.length===5?React.createElement(t.CTASections,{sections:r}):React.createElement(t.CTASectionsBlock,{containerID:e,ctaCarouselComponentProps:i,sections:r,splitPointIndex:3,isFullWidthDSB:f}):r.length>3?r&&React.createElement(t.CTASectionsCarousel,{containerID:e,ctaCarouselComponentProps:i,sections:r,isFullWidthDSB:f}):(o=r===null||r===void 0?void 0:r.slice(0,3))===null||o===void 0?void 0:o.map((n,t)=>React.createElement(n.sectionView,Object.assign(Object.assign({},n.props),{index:t,itemsLength:r.length,isTwoCta:c,key:n.props.id+"_"+t,isFullWidthDSB:f})))}}t.CTACarousel=f})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){const i=3;class r extends React.Component{render(){var u,f,e;const{FieldsStore:r,imageHostName:h,Scenario:o,isFullWidthDSB:s,id:c}=this.props;return React.createElement(t.MegaContent,{id:`${c}${s?"_full_width":""}`,isFullWidthDSB:s,containerClassName:"dsb-news-list-container",headerClassName:"dsb-news-list-container__title",scenario:o,FieldsStore:r,instrumentedItem:(u=this===null||this===void 0?void 0:this.props)===null||u===void 0?void 0:u.instrumentedItem,withNewsIconV2:!0,megaTitle:n.Host.getLocString("NewsAnswersTitle"),imageHostName:h},(e=(f=r===null||r===void 0?void 0:r.Items)===null||f===void 0?void 0:f.slice(0,i))===null||e===void 0?void 0:e.map((u,f)=>{var e,c,l;const a=`$mega_${o}_${f}`,v={id:a,key:a,dsbScenario:n.DSBScenario.NewsAnswer,index:f,imageHostName:h,item:u,itemsLength:(l=((e=r===null||r===void 0?void 0:r.Items)===null||e===void 0?void 0:e.length)>i?i:(c=r===null||r===void 0?void 0:r.Items)===null||c===void 0?void 0:c.length)!==null&&l!==void 0?l:0,isFullWidthDSB:s,megaClassName:"dsb-news-item-container",Scenario:o,uxTemplateName:r===null||r===void 0?void 0:r.UXTemplateName};return React.createElement(t.MegaNewsList,Object.assign({},v))}))}}t.NewsListAnswer=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){class t extends React.Component{constructor(){super(...arguments);this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,t){SharedLogHelper.LogError("DSBReactRenderError",`From: ${this.props.fromArea}. ${n.message} ${t.componentStack}`)}render(){return this.state.hasError?null:this.props.children}}n.ErrorBoundary=t})(t=n.Templates||(n.Templates={}))})(t=n.DSB||(n.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){const i=15,r=3;class u extends React.Component{render(){var s,h,c,l;const{id:v,FieldsStore:u,Scenario:e,isFullWidthDSB:f,onLeft:g,imageHostName:y,textSize:nt}=this.props;if(!(u===null||u===void 0?void 0:u.Items)||u.Items.length<r)return null;const tt=i>2?"dsb-mega__container dsb-mega__container--many":"dsb-mega__container",p=e?n.DSBScenario[e]:undefined,o=((s=u===null||u===void 0?void 0:u.Items)===null||s===void 0?void 0:s.length)>i?i:(h=u===null||u===void 0?void 0:u.Items)===null||h===void 0?void 0:h.length;let w=0;const a=o?f?12:n.config.useCobaltCSS?3:8:0,b=(c=u===null||u===void 0?void 0:u.Items)===null||c===void 0?void 0:c.slice(0,i).map((n,i)=>{var r,u;w=f?Number((r=n.Thumbnail)===null||r===void 0?void 0:r.ThumbnailWidthV2):Number((u=n.Thumbnail)===null||u===void 0?void 0:u.ThumbnailWidth);const s=f?`mega_${e}_${i}-full-pane`:`mega_${e}_${i}`,h=`dsb-mega__images-container focusable`,c={id:s,key:s,dsbScenario:p,imageHostName:y,index:i,isFullWidthDSB:f,item:n,itemsLength:o!==null&&o!==void 0?o:0,megaClassName:h,Scenario:e,padding:a};return React.createElement(t.MegaImageItem,Object.assign({},c))}),k=n.getTilesToShowCount(2,p,!1,f,w,g,a),d={dsbScenario:e,tilesToShow:k,showAriaMessage:!1,tileSpacing:a,containerID:v,noPaddingCarousel:!0,moveSlides:Math.floor(k),textSize:nt};return React.createElement(t.MegaContent,{id:`${v}${f?"_full_width":""}`,isFullWidthDSB:f,containerClassName:`dsb-mega mega-ext ${n.config.expandMegaClickTarget?"exp-mega-click":""}`,headerClassName:`${n.config.expandMegaClickTarget?"exp-mega-click":""}`,scenario:e,FieldsStore:u,instrumentedItem:(l=this===null||this===void 0?void 0:this.props)===null||l===void 0?void 0:l.instrumentedItem,imageHostName:y},React.createElement("div",{className:tt},f&&React.createElement("div",{className:"dsb-mega__carousel__container"},React.createElement(t.MegaCarouselComponent,Object.assign({},d),b)),!f&&React.createElement(t.MegaCarouselComponent,Object.assign({},d),b)))}}t.MegaExt=u})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(i){class r extends React.Component{render(){var f;const{id:o,imageHostName:s,FieldsStore:u,Scenario:h,instrumentedItem:c,isFullWidthDSB:e}=this.props,r=(f=u===null||u===void 0?void 0:u.Items)===null||f===void 0?void 0:f.map((i,r)=>{const{ClickThroughUrl:f,Title:h,instrumentedItem:u}=i;let s=`${o}${e?"_full_width":""}_item${r}`;return React.createElement("li",{className:"dsb-mega-bubble__suggestion focusable selectable","data-h":u===null||u===void 0?void 0:u.getHValue(),id:s,key:s,onClick:t=>{var i;f&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,f,u,!0))},tabIndex:-1},React.createElement("div",{className:"dsb-mega-bubble__suggestion__text"},h),React.createElement("div",{className:"dsb-mega-bubble__suggestion__chevron"+(n.isRtl()?" isrtl":"")},React.createElement(t.BubbleChevron,null)))});return(r===null||r===void 0?void 0:r.length)&&(r===null||r===void 0?void 0:r.length)>0?React.createElement(i.MegaContent,{id:`${o}${e?"_full_width":""}`,isFullWidthDSB:e,containerClassName:"dsb-mega mega-bubble",headerClassName:"dsb-mega-bubble__header",FieldsStore:u,scenario:h,instrumentedItem:c,imageHostName:s},React.createElement("ul",{className:"dsb-mega-bubble__list"},r)):React.createElement("div",null)}}i.MegaBubble=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(r){const u=4;class f extends React.Component{render(){var c,l;const{id:h,FieldsStore:o,Scenario:s,isFullWidthDSB:e,date:a,imageHostName:w,onDismissHandler:b,showDismissIcon:k,onLeft:v}=this.props,f=(c=o===null||o===void 0?void 0:o.Items)===null||c===void 0?void 0:c.map((t,i)=>{var u,f;const h=e?`mega_${s}_${i}-full-pane`:`mega_${s}_${i}${a?"_"+a:""}`,c={id:h,key:h,dsbScenario:n.DSBScenario.ExploreMore,index:i,imageHostName:w,isFullWidthDSB:e,item:t,itemsLength:(f=(u=o===null||o===void 0?void 0:o.Items)===null||u===void 0?void 0:u.length)!==null&&f!==void 0?f:0,megaClassName:"dsb-mega__images-container focusable",Scenario:s};return React.createElement(r.MegaImageItem,Object.assign({},c))}),y=n.RuntimeConfiguration.TextScaleFactor,d={dsbScenario:s,tilesToShow:e?(v?4:3)/y:4,showAriaMessage:!1,tileSpacing:f?e?12:6:0,containerID:h,moveSlides:Math.floor(e?(v?4:3)/y:4)};let p={};return p.background="url(https://th.bing.com/th?id=ODSWG.HeroMegaCardDefaultBackground) no-repeat",React.createElement("div",{id:h,className:"dsb-hero hero-mega-card",style:p},k&&React.createElement("div",{className:"dsb-hero__dismiss-icon",tabIndex:-1,id:h+"_dissmiss",onClick:n=>{n.stopPropagation(),b()},"data-partnertag":t.whenTestHooks("AutoSuggest.DismissIcon")},React.createElement(i.DismssIcon,null)),React.createElement(r.MegaContent,{id:`${h}${e?"_full_width":""}`,isFullWidthDSB:e,containerClassName:"dsb-mega mega",scenario:s,FieldsStore:o,instrumentedItem:(l=this===null||this===void 0?void 0:this.props)===null||l===void 0?void 0:l.instrumentedItem},React.createElement("div",{className:"dsb-mega__container"},(e||(f===null||f===void 0?void 0:f.length)>u)&&React.createElement("div",{className:"dsb-mega__carousel__container"},React.createElement(r.MegaCarouselComponent,Object.assign({},d),f)),!e&&(f===null||f===void 0?void 0:f.length)<=u&&(f===null||f===void 0?void 0:f.slice(0,u)))))}}r.HeroMegaCard=f})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){const i=1;class r extends React.Component{constructor(){super(...arguments);this.state={currentPage:0};this.changeCurrentPage=n=>{this.setState({currentPage:n})}}render(){var o,s,h;const{id:a,FieldsStore:r,Scenario:e,isFullWidthDSB:f,date:c,imageHostName:v}=this.props,u=(o=r===null||r===void 0?void 0:r.Items)===null||o===void 0?void 0:o.map((i,u)=>{var o,s;const h=f?`mega_${e}_${u}-full-pane`:`mega_${e}_${u}${c?"_"+c:""}`,l={id:h,dsbScenario:n.DSBScenario.RewardsDailySet,index:u,isFullWidthDSB:f,item:i,itemsLength:(s=(o=r===null||r===void 0?void 0:r.Items)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0,megaClassName:"dsb-rewards-daily-set__container focusable",Scenario:e};return React.createElement(t.MegaRewardsDailyItems,Object.assign({},l))}),y=(r===null||r===void 0?void 0:r.CaptionResourceKey)?(s=n.Host.getLocString(r===null||r===void 0?void 0:r.CaptionResourceKey))!==null&&s!==void 0?s:"":"",l=`${a}${f?"_full_width":""}`,p=(n,t)=>{this.changeCurrentPage(t)},w={dsbScenario:e,tilesToShow:1,showAriaMessage:!1,tileSpacing:16,containerID:l,moveSlides:Math.floor(1),verticalSpacing:"8px",pageChangedCallback:n.config.enableDSBCarouselPagination?p:null};return React.createElement(t.MegaContent,{id:l,isFullWidthDSB:f,containerClassName:"dsb-mega mega dsb-rewards-daily-set",scenario:e,FieldsStore:r,instrumentedItem:(h=this===null||this===void 0?void 0:this.props)===null||h===void 0?void 0:h.instrumentedItem,imageHostName:v,carouselPaginationEnabled:n.config.enableDSBCarouselPagination?!0:!1,currentCarouselPage:this.state.currentPage},React.createElement("div",{className:"dsb-mega__container"},(f||(u===null||u===void 0?void 0:u.length)>i)&&React.createElement("div",{"aria-label":y,className:"dsb-mega__carousel__container"},React.createElement(t.MegaCarouselComponent,Object.assign({},w),u)),!f&&(u===null||u===void 0?void 0:u.length)<=i&&(u===null||u===void 0?void 0:u.slice(0,i))))}}t.MegaRewardsDaily=r})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){var r;(function(i){class r extends React.Component{render(){var s,h,c,l,a,v,y;const{id:f,FieldsStore:r,isFullWidthDSB:u,imageHostName:b,instrumentedItem:e,scenario:o}=this.props,p=(r===null||r===void 0?void 0:r.CaptionResourceKey)?(s=n.Host.getLocString(r===null||r===void 0?void 0:r.CaptionResourceKey))!==null&&s!==void 0?s:"":(h=r===null||r===void 0?void 0:r.Title)!==null&&h!==void 0?h:"",k=`${f}_container`+((c=r===null||r===void 0?void 0:r.MegaLink)===null||c===void 0?void 0:c.Id),d=r===null||r===void 0?void 0:r.SponsorImageId;let w=((l=r===null||r===void 0?void 0:r.MegaLink)===null||l===void 0?void 0:l.ClickThroughUrl)?(v=(a=r===null||r===void 0?void 0:r.MegaLink)===null||a===void 0?void 0:a.ClickThroughUrl)!==null&&v!==void 0?v:"":(y=r===null||r===void 0?void 0:r.ClickThroughUrl)!==null&&y!==void 0?y:"";const g={dsbScenario:o,tilesToShow:3,showAriaMessage:!1,tileSpacing:0,containerID:f,moveSlides:3,noPaddingCarousel:!0};return React.createElement("div",{id:`${f}${u?"_full_width":""}_container`+o,key:`${f}${u?"_full_width":""}_container`+o,"aria-label":p,className:"mega dsb-mega mega-cashback","data-region":o,"data-partnertag":t.whenTestHooks(`DSB.${o}`),"data-h":e===null||e===void 0?void 0:e.getHValue(),onClick:t=>{var i;w&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,w,e))},role:"link"},React.createElement(i.MegaHeader,{className:`dsb-mega__header ${w?" dsb-clickable-containers":""}`,isFullWidthDSB:u,FieldsStore:r,imageHostName:b,instrumentedItem:e,megaTitle:p,megaLinkId:`${k}${u?"_full_width":""}`,sponsorImageId:d,ariaLabel:p}),React.createElement("div",{className:"cashback-items"},React.createElement(i.MegaCarouselComponent,Object.assign({},g),r.Items.map((t,i)=>{var s;const{Publisher:h,Title:c,Description:o,Thumbnail:e,instrumentedItem:l,ClickThroughUrl:a}=t;let v=`${f}${u?"_full_width":""}_item${i}`;const p=u?e===null||e===void 0?void 0:e.ThumbnailHeightV2:e===null||e===void 0?void 0:e.ThumbnailHeight,w=u?e===null||e===void 0?void 0:e.ThumbnailWidthV2:e===null||e===void 0?void 0:e.ThumbnailWidth,k=n.getImageStyleMegaExt((s=t.Thumbnail)===null||s===void 0?void 0:s.ThumbnailId,2,n.DSBScenario.CashbackAds,b,!1,!1,u,w,p,!0),y=t.CaptionResourceKey?n.Host.getLocString(t.CaptionResourceKey,t.Caption,t.ItemMetadata):c;return React.createElement("div",{id:v,key:v,className:"item focusable",tabIndex:-1,"data-h":l.getHValue(),role:"link","aria-label":`${h} ${y}`+(o&&` ${o}`),"aria-posinset":i+1,"aria-setsize":r.Items.length,onClick:t=>{var i;a&&((i=t.persist)===null||i===void 0?void 0:i.call(t),t.stopPropagation(),n.clickDSBHandler(t.nativeEvent,a,l))}},React.createElement("div",{className:"ad-img",style:k}),React.createElement("div",{className:"ad-text",title:`${c}`},React.createElement("span",{className:"ad-publisher"},h),React.createElement("span",{className:"ad-description"},y),o&&React.createElement("span",{className:"ad-sub-description"},o)))}))))}}i.MegaCashback=r})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){var i;(function(t){class i extends React.Component{click(t,i,r,u){var f,e;n.Host.launchDSBUriAsync((e=(f=r.ClickThroughUrl)!==null&&f!==void 0?f:u.ClickThroughUrl)!==null&&e!==void 0?e:"",i,t)}render(){var i,r;const{FieldsStore:n,imageHostName:f,id:e,isFullWidthDSB:u}=this.props,o=React.createElement("div",null,React.createElement("div",{className:"question"},React.createElement("div",null,n===null||n===void 0?void 0:n.Title)),React.createElement("ul",null,(i=n===null||n===void 0?void 0:n.Items)===null||i===void 0?void 0:i.sort((n,t)=>{var i,r;return((i=n.Index)!==null&&i!==void 0?i:0)-((r=t.Index)!==null&&r!==void 0?r:0)}).map((t,i)=>{var r;let f=t.Title,e=(r=t.Index)!==null&&r!==void 0?r:i;const u=`$mega_${n.Scenario}_${i}`;return React.createElement("li",{className:"mru-poll",id:u,key:u,onClick:i=>{this.click(i.nativeEvent,t.instrumentedItem,t,n),i.stopPropagation()},tabIndex:-1},React.createElement("div",{className:"initial"},String.fromCharCode(65+e)+".","Â "),React.createElement("div",{className:"pillans"},f))})));return React.createElement(t.MegaContent,{containerClassName:"dsb-poll",isFullWidthDSB:u,children:o,FieldsStore:n,instrumentedItem:(r=this===null||this===void 0?void 0:this.props)===null||r===void 0?void 0:r.instrumentedItem,headerClassName:"dsb-poll__header",id:`${e}${u?"_full_width":""}`,scenario:n===null||n===void 0?void 0:n.Scenario,imageHostName:f})}}t.UgcPoll=i})(i=t.Templates||(t.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))}(WSB||(WSB={}));const MobileAppUpsellDismissedKey="MobileAppUpsellDismissed",MobileAppUpsellLaunchedKey="MobileAppUpsellLaunched";(function(n){var t;(function(t){var i;(function(i){var r;(function(r){const u=r=>{const{id:u,CaptionResourceKey:o,UpsellQRCodeIcon:h,UpsellHeadingResourceKey:c,UpsellSubheadingResourceKey:l,SeeMoreResourceKey:a,onDismissHandler:s}=r;return React.createElement(React.Fragment,null,s&&React.createElement("div",{className:"dsb-mobile-app-upsell__dismiss-icon selectable focusable",tabIndex:-1,id:u+"_dismiss",role:"button","aria-label":"Dismiss "+n.Host.getLocString(o),onClick:n=>{n.stopPropagation(),s(),e()},"data-partnertag":t.whenTestHooks("MobileAppUpsellCard.Dismiss")},React.createElement(i.DismssIcon,null)),React.createElement("div",{className:"dsb-mobile-app-upsell__container",key:u,id:u},React.createElement("img",{className:"dsb-mobile-app-upsell__qr-code",src:h}),React.createElement("div",{className:"dsb-mobile-app-upsell__details"},React.createElement("span",{className:"dsb-mobile-app-upsell__heading"},n.Host.getLocString(c)),React.createElement("span",{className:"dsb-mobile-app-upsell__subheading"},n.Host.getLocString(l)),React.createElement("button",{className:"dsb-mobile-app-upsell__see-more selectable focusable",tabIndex:-1,id:u+"_action",role:"button","aria-label":n.Host.getLocString(o),onClick:()=>f()},n.Host.getLocString(a)))))},f=()=>{if(_w.localStorage){const n=parseInt(localStorage.getItem(MobileAppUpsellLaunchedKey))+1||1;_w.localStorage.setItem(MobileAppUpsellLaunchedKey,n.toString())}n.InstrumentationHelper.logClientInstEvent("Select",MobileAppUpsellLaunchedKey,n.SequenceNumberManager.getSequenceNumber())},e=()=>{if(_w.localStorage){const n=parseInt(localStorage.getItem(MobileAppUpsellDismissedKey))+1||1;_w.localStorage.setItem(MobileAppUpsellDismissedKey,n.toString())}n.InstrumentationHelper.logClientInstEvent("Select",MobileAppUpsellDismissedKey,null)};class o extends React.Component{render(){var i;const{id:o,FieldsStore:t,Scenario:s,isFullWidthDSB:f,imageHostName:e,onDismissHandler:h}=this.props;if(t){const c=`${o}${f?"_full_width":""}`,l={id:c,CaptionResourceKey:t.CaptionResourceKey,UpsellQRCodeIcon:n.generateBingThumbnailUrlFromId(t.Thumbnail.ThumbnailId,e,t.Thumbnail.ThumbnailWidth,t.Thumbnail.ThumbnailHeight),UpsellHeadingResourceKey:t.UpsellHeadingResourceKey,UpsellSubheadingResourceKey:t.UpsellSubheadingResourceKey,SeeMoreResourceKey:t.SeeMoreResourceKey,onDismissHandler:h};return React.createElement(r.MegaContent,{id:c,isFullWidthDSB:f,containerClassName:"dsb-mega mega dsb-mobile-app-upsell-card",scenario:s,FieldsStore:t,instrumentedItem:(i=this===null||this===void 0?void 0:this.props)===null||i===void 0?void 0:i.instrumentedItem,imageHostName:e},React.createElement(u,Object.assign({},l)))}return null}}r.MobileAppUpsellCard=o})(r=i.Templates||(i.Templates={}))})(i=t.DSB||(t.DSB={}))})(t=n.View||(n.View={}))})(WSB||(WSB={}))